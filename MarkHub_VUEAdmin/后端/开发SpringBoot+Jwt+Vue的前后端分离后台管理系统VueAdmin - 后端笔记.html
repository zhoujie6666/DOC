<!DOCTYPE html>
<!-- saved from url=(0043)https://shimo.im/docs/OnZDwoxFFL8bnP1c/read -->
<html lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <meta name="robots" content="noindex">
        
        <meta http-equiv="X-UA-Compatible" content="IE=Edge">
        <meta name="viewport" content="width=device-width,initial-scale=1,shrink-to-fit=no,user-scalable=no">
        <meta name="theme-color" content="#000000">
        <meta name="version" content="1.4.6">
        <link rel="shortcut icon" href="https://as.smvm.cn/from_qbox/doc_favicon.ico">
        <meta name="description" content="石墨文档是一款轻便、简洁的在线协作文档工具，PC端和移动端全覆盖，支持多人同时对文档编辑和评论，让你与他人轻松完成协作撰稿、方案讨论、会议记录和资料共享等工作。">
        <meta name="keywords" content="在线协作文档,在线文档编辑,在线协作编辑,协同编辑,多人编辑,团队协作工具,文档管理工具,文档协作,文件存储,文件共享,协作办公,SAAS,云协作,google docs,在线office">
        <meta name="google" content="notranslate">
        <style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-4201804011 */
.randomClass-keafdv{position:fixed;overflow:auto;top:0;right:0;bottom:0;left:0;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;z-index:999;-webkit-overflow-scrolling:touch;outline:0;}.sm-modal-mask-hidden{display:none;}
</style><style type="text/css" data-styled-components="sfCUt inYJrZ" data-styled-components-is-local="true">/* sc-component-id: sc-1n784rm-0 */

.sfCUt{box-sizing:border-box;display:inline-block;border-radius:2px;border-width:1px;border-style:solid;background-color:#fff;text-align:center;-webkit-text-decoration:none;text-decoration:none;cursor:pointer;-webkit-transition:opacity 0.3s,border-color 0.3s;transition:opacity 0.3s,border-color 0.3s;color:#666;border-width:0;background-image:linear-gradient(#fdfdfd,#f8f8f8);box-shadow:0 1px 1px 0 rgba(0,0,0,0.11);position:relative;font-size:12px;font-weight:bold;line-height:1.4;min-width:90px;height:30px;line-height:28px;padding:0 15px;}.sfCUt:focus{outline:none;}.sfCUt:active{opacity:0.9;}.sfCUt:hover{background-image:none;}.sfCUt::before{content:'';display:block;position:absolute;top:-1px;left:-1px;z-index:-1;width:100%;height:100%;border:1px solid rgba(65,70,75,0.05);border-radius:2px;-webkit-transition:opacity 0.3s ease-out;transition:opacity 0.3s ease-out;opacity:0;}.sfCUt:hover{border-radius:1px;}.sfCUt:hover::before{opacity:1;}.sfCUt[disabled]{border-radius:1px;}.sfCUt[disabled]::before{opacity:1;}.sfCUt:hover{background-image:linear-gradient(#fdfdfd,#f8f8f8);}.sfCUt:active{box-shadow:0 1px 1px 0 rgba(0,0,0,0.1);background-image:linear-gradient(#f0f0f0,#f7f7f7);}.sfCUt[disabled]{color:#ccc;background-color:#f7f7f7;}.sfCUt[disabled]::before{border-color:rgba(0,0,0,0.05);}.sfCUt[disabled]{cursor:not-allowed;background-image:none;}

.inYJrZ{box-sizing:border-box;display:inline-block;border-radius:2px;border-width:1px;border-style:solid;background-color:#fff;text-align:center;-webkit-text-decoration:none;text-decoration:none;cursor:pointer;-webkit-transition:opacity 0.3s,border-color 0.3s;transition:opacity 0.3s,border-color 0.3s;color:#666;border-width:0;background-image:linear-gradient(#fdfdfd,#f8f8f8);box-shadow:0 1px 1px 0 rgba(0,0,0,0.11);position:relative;font-size:14px;font-weight:bold;line-height:1.4;min-width:100px;height:34px;line-height:32px;padding:0 15px;}.inYJrZ:focus{outline:none;}.inYJrZ:active{opacity:0.9;}.inYJrZ:hover{background-image:none;}.inYJrZ::before{content:'';display:block;position:absolute;top:-1px;left:-1px;z-index:-1;width:100%;height:100%;border:1px solid rgba(65,70,75,0.05);border-radius:2px;-webkit-transition:opacity 0.3s ease-out;transition:opacity 0.3s ease-out;opacity:0;}.inYJrZ:hover{border-radius:1px;}.inYJrZ:hover::before{opacity:1;}.inYJrZ[disabled]{border-radius:1px;}.inYJrZ[disabled]::before{opacity:1;}.inYJrZ:hover{background-image:linear-gradient(#fdfdfd,#f8f8f8);}.inYJrZ:active{box-shadow:0 1px 1px 0 rgba(0,0,0,0.1);background-image:linear-gradient(#f0f0f0,#f7f7f7);}.inYJrZ[disabled]{color:#ccc;background-color:#f7f7f7;}.inYJrZ[disabled]::before{border-color:rgba(0,0,0,0.05);}.inYJrZ[disabled]{cursor:not-allowed;background-image:none;}
</style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-1274816861 */
#ToastsContainer_ShimoUI .Toastify__toast-container{width:100%;text-align:center;height:0;padding:0;margin:0;margin-top:30px;right:0;}#ToastsContainer_ShimoUI .Toastify__toast{box-shadow:none;background:none;cursor:auto;overflow:visible;margin:0;padding:0;display:inline;}#ToastsContainer_ShimoUI .Toastify__toast:after{content:'\a';white-space:pre;}#ToastsContainer_ShimoUI .Toastify__toast-body{display:inline;}#ToastsContainer_ShimoUI .Toast_mask{position:fixed;top:0;left:0;right:0;bottom:0;width:100%;background:transparent;z-index:999999;}
</style><style type="text/css" data-styled-components="gLVbAR kqIoIJ liDUmU" data-styled-components-is-local="true">/* sc-component-id: sc-chPdSV */

.gLVbAR{clear:both;width:816px;margin:0 auto;padding-top:25px;padding-bottom:25px;text-align:center;width:100%;}
/* sc-component-id: sc-kgoBCf */

.kqIoIJ{font-size:12px;color:#a5a5a5;-webkit-font-smoothing:antialiased;}
/* sc-component-id: sc-kGXeez */

.liDUmU{text-align:center;position:fixed;right:20px;bottom:48px;width:60px;height:60px;-webkit-text-decoration:none;text-decoration:none;box-shadow:0px 6px 10px rgba(0,0,0,0.1),0px 4px 16px rgba(0,0,0,0.06), 0px 1px 24px rgba(0,0,0,0.06);line-height:60px;border-radius:30px;font-size:20px;color:#41464b;-webkit-transform:scale(0.5);-ms-transform:scale(0.5);transform:scale(0.5);}
</style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-1193784920 */
.randomClass-dhpOWU.sm-dropdown{position:absolute;left:-9999px;top:-9999px;display:block;z-index:1050;}.randomClass-dhpOWU.sm-dropdown .sm-dropdown-menu{box-shadow:0 2px 8px 0 rgba(0,0,0,0.15);}.randomClass-dhpOWU.sm-dropdown-tip::before{content:'';position:absolute;z-index:-1;display:block;width:10px;height:10px;background-color:#fff;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);box-shadow:0 0 6px 0 rgba(0,0,0,0.15);}.randomClass-dhpOWU.sm-dropdown-tip::after{content:'';display:block;position:absolute;border-color:transparent;border-width:6px;border-style:solid;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomLeft::before{left:20px;top:-4px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomLeft::after{left:19px;top:-12px;border-bottom-color:#fff;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomRight::before{right:20px;top:-4px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomRight::after{right:19px;top:-12px;border-bottom-color:#fff;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomCenter::before{left:50%;top:-4px;margin-left:-6px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-bottomCenter::after{left:50%;top:-12px;margin-left:-6px;border-bottom-color:#fff;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topLeft::before{left:20px;bottom:-4px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topLeft::after{left:19px;bottom:-12px;border-top-color:#fff;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topRight::before{right:20px;bottom:-4px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topRight::after{right:19px;bottom:-12px;border-top-color:#fff;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topCenter::before{left:50%;bottom:-4px;margin-left:-6px;}.randomClass-dhpOWU.sm-dropdown-tip.sm-dropdown-placement-topCenter::after{left:50%;bottom:-12px;margin-left:-6px;border-top-color:#fff;}.randomClass-dhpOWU.sm-dropdown-hidden{display:none;}.randomClass-dhpOWU.sm-dropdown-mask{z-index:1050;position:absolute;top:0;bottom:0;left:0;right:0;}.randomClass-dhpOWU.sm-dropdown-mask-hidden{display:none;}
</style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-2145721762 */
.randomClass-mvIob{display:block;position:absolute;font-size:12px;-webkit-font-smoothing:auto;line-height:1.375;opacity:1;z-index:1060;}.randomClass-mvIob .sm-tooltip-inner{color:#fff;text-align:center;padding:6px 10px;background:#41464b;border-radius:2px;box-shadow:0 1px 3px 0 rgba(0,0,0,0.1);height:auto;line-height:1.375;white-space:normal;}.randomClass-mvIob.sm-tooltip-hidden{display:none;}.randomClass-mvIob .sm-tooltip-arrow{position:absolute;width:0;height:0;border-color:#41464b;border-style:solid;}.randomClass-mvIob .sm-tooltip-arrow::after{content:'';position:absolute;width:5px;height:5px;-webkit-transform:rotate(45deg);-ms-transform:rotate(45deg);transform:rotate(45deg);box-shadow:0 0 8px 0 rgba(0,0,0,0.4);z-index:-1;}.randomClass-mvIob.sm-tooltip-theme-blue .sm-tooltip-inner{background:#8ab3e9;}.randomClass-mvIob.sm-tooltip-theme-blue .sm-tooltip-inner{background:#8ab3e9;}.randomClass-mvIob.sm-tooltip-theme-blue .sm-tooltip-arrow{border-color:#8ab3e9;}.randomClass-mvIob.sm-tooltip-theme-white{opacity:1;}.randomClass-mvIob.sm-tooltip-theme-white .sm-tooltip-inner{color:#333;background:#fff;}.randomClass-mvIob.sm-tooltip-theme-white .sm-tooltip-inner{background:#fff;box-shadow:0 2px 8px 0 rgba(0,0,0,0.2);}.randomClass-mvIob.sm-tooltip-theme-white .sm-tooltip-arrow{border-color:#fff;}.randomClass-mvIob.sm-tooltip-theme-white .sm-tooltip-arrow::after{box-shadow:0 0 6px 0 rgba(0,0,0,0.2);}.randomClass-mvIob.sm-tooltip-placement-top,.randomClass-mvIob.sm-tooltip-placement-topLeft,.randomClass-mvIob.sm-tooltip-placement-topRight{padding-bottom:7px;}.randomClass-mvIob.sm-tooltip-placement-top .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-topLeft .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-topRight .sm-tooltip-arrow{bottom:3px;border-width:4px 4px 0;border-bottom-color:transparent;border-left-color:transparent;border-right-color:transparent;}.randomClass-mvIob.sm-tooltip-placement-top .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-topLeft .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-topRight .sm-tooltip-arrow::after{left:-2.5px;top:-6.5px;}.randomClass-mvIob.sm-tooltip-placement-bottom,.randomClass-mvIob.sm-tooltip-placement-bottomLeft,.randomClass-mvIob.sm-tooltip-placement-bottomRight{padding-top:7px;}.randomClass-mvIob.sm-tooltip-placement-bottom .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-bottomLeft .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-bottomRight .sm-tooltip-arrow{top:3px;border-width:0 4px 4px;border-top-color:transparent;border-left-color:transparent;border-right-color:transparent;}.randomClass-mvIob.sm-tooltip-placement-bottom .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-bottomLeft .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-bottomRight .sm-tooltip-arrow::after{left:-2.5px;top:1.5px;box-shadow:0 0 10px 0 rgba(0,0,0,0.2);}.randomClass-mvIob.sm-tooltip-placement-left,.randomClass-mvIob.sm-tooltip-placement-leftTop,.randomClass-mvIob.sm-tooltip-placement-leftBottom{padding-right:7px;}.randomClass-mvIob.sm-tooltip-placement-left .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-leftTop .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-leftBottom .sm-tooltip-arrow{right:3px;border-width:4px 0 4px 4px;border-top-color:transparent;border-bottom-color:transparent;border-right-color:transparent;}.randomClass-mvIob.sm-tooltip-placement-left .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-leftTop .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-leftBottom .sm-tooltip-arrow::after{left:-6.5px;top:-2.5px;}.randomClass-mvIob.sm-tooltip-placement-right,.randomClass-mvIob.sm-tooltip-placement-rightTop,.randomClass-mvIob.sm-tooltip-placement-rightBottom{padding-left:7px;}.randomClass-mvIob.sm-tooltip-placement-right .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-rightTop .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-rightBottom .sm-tooltip-arrow{left:3px;border-width:4px 4px 4px 0;border-top-color:transparent;border-left-color:transparent;border-bottom-color:transparent;}.randomClass-mvIob.sm-tooltip-placement-right .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-rightTop .sm-tooltip-arrow::after,.randomClass-mvIob.sm-tooltip-placement-rightBottom .sm-tooltip-arrow::after{left:1.5px;top:-2.5px;}.randomClass-mvIob.sm-tooltip-placement-top .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-bottom .sm-tooltip-arrow{left:50%;margin-left:-4px;}.randomClass-mvIob.sm-tooltip-placement-topLeft .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-bottomLeft .sm-tooltip-arrow{left:16px;}.randomClass-mvIob.sm-tooltip-placement-topRight .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-bottomRight .sm-tooltip-arrow{right:16px;}.randomClass-mvIob.sm-tooltip-placement-left .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-right .sm-tooltip-arrow{top:50%;margin-top:-4px;}.randomClass-mvIob.sm-tooltip-placement-leftTop .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-rightTop .sm-tooltip-arrow{top:8px;}.randomClass-mvIob.sm-tooltip-placement-leftBottom .sm-tooltip-arrow,.randomClass-mvIob.sm-tooltip-placement-rightBottom .sm-tooltip-arrow{bottom:8px;}
/* sc-component-id: sc-global-3280337108 */
.sm-tooltip.no-touch{pointer-events:none !important;}.sm-tooltip{pointer-events:auto !important;}.sm-tooltip *{pointer-events:auto !important;}
</style><style type="text/css" data-styled-components="bBZnOa cbYHdA iaSppr kOTtUa fWfGDr iAQwBy cuKFxh cZZyrb iObLYz cUDKsr jVcKXm dStWqN" data-styled-components-is-local="true">/* sc-component-id: sc-hzDkRC */

.iObLYz{position:relative;width:38px;min-width:38px;height:28px;margin:11px 15px 11px 0;}.iObLYz path{fill:rgba(65,70,75,0.3);}
/* sc-component-id: sc-jhAzac */

.cUDKsr{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);}
/* sc-component-id: sc-fMiknA */

.fWfGDr{pointer-events:none;height:20px;line-height:24px;margin-left:20px;box-shadow:none;background:inherit;max-width:656px;padding-bottom:4px;font-size:14px;font-weight:700;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;}
/* sc-component-id: sc-fAjcbJ */

.kOTtUa{display:block;height:18px;margin:16px 0;}.kOTtUa > path{fill:#41464b;}
/* sc-component-id: sc-caSCKo */

.iaSppr{float:left;-webkit-text-decoration:none;text-decoration:none;}
/* sc-component-id: sc-gisBJw */

.cbYHdA{margin-left:20px;}
/* sc-component-id: sc-kvZOFW */

.dStWqN{position:relative;width:38px;min-width:38px;height:28px;margin:11px 18px 11px 0px;}.dStWqN svg{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);}
/* sc-component-id: sc-keyframes-bBZnOa */
@-webkit-keyframes bBZnOa{0%{-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}50%{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg);}100%{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}@keyframes bBZnOa{0%{-webkit-transform:rotate(0);-ms-transform:rotate(0);transform:rotate(0);}50%{-webkit-transform:rotate(180deg);-ms-transform:rotate(180deg);transform:rotate(180deg);}100%{-webkit-transform:rotate(360deg);-ms-transform:rotate(360deg);transform:rotate(360deg);}}
/* sc-component-id: sc-btzYZH */

.jVcKXm{position:relative;width:72px;height:28px;box-sizing:border-box;margin-top:11px;text-align:center;font-size:14px;font-family:serif;font-weight:bold;border-radius:2px;cursor:pointer;}.jVcKXm.register{background:linear-gradient(180deg,#41464b 0%,#2c3033 100%);color:white;margin-right:10px;border:0;}.jVcKXm.login{background:linear-gradient(180deg,#ffffff 0%,#fafafa 98.11%);border:1px solid rgba(65,70,75,0.5);color:rgba(65,70,75,0.9);}.jVcKXm:hover{opacity:0.9;}
/* sc-component-id: sc-lhVmIH */

.iAQwBy{position:relative;width:8px;height:30px;padding:0;margin:10px 0 10px 15px;cursor:pointer;background-color:#fff;border:none;}.iAQwBy svg{position:absolute;top:calc(50% - 1px);left:50%;-webkit-transform:translate(-50%,-50%);-ms-transform:translate(-50%,-50%);transform:translate(-50%,-50%);}
/* sc-component-id: sc-bYSBpT */

.cZZyrb{vertical-align:bottom;margin-right:5px;}
/* sc-component-id: sc-elJkPf */

.cuKFxh{position:relative;height:12px;line-height:12px;margin:19px 0 19px 20px;font-size:12px;color:#a5a5a5;}
</style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-3361459923 */
.header-download-app .sm-modal-close{top:12px;right:12px;}
</style><style type="text/css" data-styled-components="doEjVX jqmOiT hAHnBB" data-styled-components-is-local="true">/* sc-component-id: sc-exAgwC */

.doEjVX{white-space:nowrap;width:100%;position:relative;background:linear-gradient(180deg,#fdfdfd,#fff);z-index:110;height:50px;box-shadow:0 2px 3px 0 rgba(100,100,100,0.15);-webkit-user-select:none;-moz-user-select:none;-ms-user-select:none;user-select:none;overflow:hidden;border-bottom:1px solid #fff;}.doEjVX::after{clear:both;content:'';display:table;}
/* sc-component-id: sc-cQFLBn */

.jqmOiT{position:relative;float:left;padding-left:0px;}.jqmOiT > a,.jqmOiT > div,.jqmOiT > button{display:inline-block;vertical-align:middle;}
/* sc-component-id: sc-gojNiO */

.hAHnBB{position:absolute;right:0;background-color:white;}.hAHnBB > a,.hAHnBB > div,.hAHnBB > button,.hAHnBB > span{float:left;vertical-align:middle;margin-right:10px;}
</style><style type="text/css" data-styled-components="" data-styled-components-is-local="false">/* sc-component-id: sc-global-2858897182 */
html{line-height:1.15;-webkit-text-size-adjust:100%;}body{margin:0;}main{display:block;}h1{font-size:2em;margin:0.67em 0;}hr{box-sizing:content-box;height:0;overflow:visible;}pre{font-family:monospace,monospace;font-size:1em;}a{background-color:transparent;}abbr[title]{border-bottom:none;-webkit-text-decoration:underline;text-decoration:underline;-webkit-text-decoration:underline dotted;text-decoration:underline dotted;}b,strong{font-weight:bolder;}code,kbd,samp{font-family:monospace,monospace;font-size:1em;}small{font-size:80%;}sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline;}sub{bottom:-0.25em;}sup{top:-0.5em;}img{border-style:none;}button,input,optgroup,select,textarea{font-family:inherit;font-size:100%;line-height:1.15;margin:0;}button,input{overflow:visible;}button,select{text-transform:none;}button,[type="button"],[type="reset"],[type="submit"]{-webkit-appearance:button;}button::-moz-focus-inner,[type="button"]::-moz-focus-inner,[type="reset"]::-moz-focus-inner,[type="submit"]::-moz-focus-inner{border-style:none;padding:0;}button:-moz-focusring,[type="button"]:-moz-focusring,[type="reset"]:-moz-focusring,[type="submit"]:-moz-focusring{outline:1px dotted ButtonText;}fieldset{padding:0.35em 0.75em 0.625em;}legend{box-sizing:border-box;color:inherit;display:table;max-width:100%;padding:0;white-space:normal;}progress{vertical-align:baseline;}textarea{overflow:auto;}[type="checkbox"],[type="radio"]{box-sizing:border-box;padding:0;}[type="number"]::-webkit-inner-spin-button,[type="number"]::-webkit-outer-spin-button{height:auto;}[type="search"]{-webkit-appearance:textfield;outline-offset:-2px;}[type="search"]::-webkit-search-decoration{-webkit-appearance:none;}::-webkit-file-upload-button{-webkit-appearance:button;font:inherit;}details{display:block;}summary{display:list-item;}template{display:none;}[hidden]{display:none;}body{font-family:-apple-system,BlinkMacSystemFont,"PingFang SC",Helvetica,Tahoma,Arial,"Microsoft YaHei",微软雅黑,黑体,Heiti,sans-serif,SimSun,宋体,serif;background-color:#F7F7F7;}*{margin:0;padding:0;outline:none;}button,input,optgroup,select,textarea{font-family:inherit;}.hide{display:none;}@media screen and (-webkit-min-device-pixel-ratio:2),screen and (min-resolution:2dppx){body{-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;}}
</style>
<link href="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/doc-d21fc311b8.css" rel="stylesheet"><style>.ql-snow [ql-global]{}</style>
        <title>开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记</title>
    <style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css">.Toastify__toast-container {
  z-index: 9999;
  position: fixed;
  padding: 4px;
  width: 320px;
  box-sizing: border-box;
  color: #fff; }
  .Toastify__toast-container--top-left {
    top: 1em;
    left: 1em; }
  .Toastify__toast-container--top-center {
    top: 1em;
    left: 50%;
    margin-left: -160px; }
  .Toastify__toast-container--top-right {
    top: 1em;
    right: 1em; }
  .Toastify__toast-container--bottom-left {
    bottom: 1em;
    left: 1em; }
  .Toastify__toast-container--bottom-center {
    bottom: 1em;
    left: 50%;
    margin-left: -160px; }
  .Toastify__toast-container--bottom-right {
    bottom: 1em;
    right: 1em; }

@media only screen and (max-width: 480px) {
  .Toastify__toast-container {
    width: 100vw;
    padding: 0;
    left: 0;
    margin: 0; }
    .Toastify__toast-container--top-left, .Toastify__toast-container--top-center, .Toastify__toast-container--top-right {
      top: 0; }
    .Toastify__toast-container--bottom-left, .Toastify__toast-container--bottom-center, .Toastify__toast-container--bottom-right {
      bottom: 0; }
    .Toastify__toast-container--rtl {
      right: 0;
      left: initial; } }

.Toastify__toast {
  position: relative;
  min-height: 64px;
  box-sizing: border-box;
  margin-bottom: 1rem;
  padding: 8px;
  border-radius: 1px;
  box-shadow: 0 1px 10px 0 rgba(0, 0, 0, 0.1), 0 2px 15px 0 rgba(0, 0, 0, 0.05);
  display: flex;
  justify-content: space-between;
  max-height: 800px;
  overflow: hidden;
  font-family: sans-serif;
  cursor: pointer;
  direction: ltr; }
  .Toastify__toast--rtl {
    direction: rtl; }
  .Toastify__toast--default {
    background: #fff;
    color: #aaa; }
  .Toastify__toast--info {
    background: #3498db; }
  .Toastify__toast--success {
    background: #07bc0c; }
  .Toastify__toast--warning {
    background: #f1c40f; }
  .Toastify__toast--error {
    background: #e74c3c; }
  .Toastify__toast-body {
    margin: auto 0;
    flex: 1; }

@media only screen and (max-width: 480px) {
  .Toastify__toast {
    margin-bottom: 0; } }

.Toastify__close-button {
  color: #fff;
  font-weight: bold;
  font-size: 14px;
  background: transparent;
  outline: none;
  border: none;
  padding: 0;
  cursor: pointer;
  opacity: 0.7;
  transition: 0.3s ease;
  align-self: flex-start; }
  .Toastify__close-button--default {
    color: #000;
    opacity: 0.3; }
  .Toastify__close-button:hover, .Toastify__close-button:focus {
    opacity: 1; }

@-webkit-keyframes Toastify__trackProgress {
  0% {
    width: 100%; }
  100% {
    width: 0; } }

@keyframes Toastify__trackProgress {
  0% {
    width: 100%; }
  100% {
    width: 0; } }

.Toastify__progress-bar {
  position: absolute;
  bottom: 0;
  left: 0;
  width: 0;
  height: 5px;
  z-index: 9999;
  opacity: 0.7;
  -webkit-animation: Toastify__trackProgress linear 1;
          animation: Toastify__trackProgress linear 1;
  background-color: rgba(255, 255, 255, 0.7); }
  .Toastify__progress-bar--rtl {
    right: 0;
    left: initial; }
  .Toastify__progress-bar--default {
    background: linear-gradient(to right, #4cd964, #5ac8fa, #007aff, #34aadc, #5856d6, #ff2d55); }

@-webkit-keyframes Toastify__bounceInRight {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  from {
    opacity: 0;
    -webkit-transform: translate3d(3000px, 0, 0);
            transform: translate3d(3000px, 0, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(-25px, 0, 0);
            transform: translate3d(-25px, 0, 0); }
  75% {
    -webkit-transform: translate3d(10px, 0, 0);
            transform: translate3d(10px, 0, 0); }
  90% {
    -webkit-transform: translate3d(-5px, 0, 0);
            transform: translate3d(-5px, 0, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@keyframes Toastify__bounceInRight {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  from {
    opacity: 0;
    -webkit-transform: translate3d(3000px, 0, 0);
            transform: translate3d(3000px, 0, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(-25px, 0, 0);
            transform: translate3d(-25px, 0, 0); }
  75% {
    -webkit-transform: translate3d(10px, 0, 0);
            transform: translate3d(10px, 0, 0); }
  90% {
    -webkit-transform: translate3d(-5px, 0, 0);
            transform: translate3d(-5px, 0, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@-webkit-keyframes Toastify__bounceOutRight {
  20% {
    opacity: 1;
    -webkit-transform: translate3d(-20px, 0, 0);
            transform: translate3d(-20px, 0, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(2000px, 0, 0);
            transform: translate3d(2000px, 0, 0); } }

@keyframes Toastify__bounceOutRight {
  20% {
    opacity: 1;
    -webkit-transform: translate3d(-20px, 0, 0);
            transform: translate3d(-20px, 0, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(2000px, 0, 0);
            transform: translate3d(2000px, 0, 0); } }

@-webkit-keyframes Toastify__bounceInLeft {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  0% {
    opacity: 0;
    -webkit-transform: translate3d(-3000px, 0, 0);
            transform: translate3d(-3000px, 0, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(25px, 0, 0);
            transform: translate3d(25px, 0, 0); }
  75% {
    -webkit-transform: translate3d(-10px, 0, 0);
            transform: translate3d(-10px, 0, 0); }
  90% {
    -webkit-transform: translate3d(5px, 0, 0);
            transform: translate3d(5px, 0, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@keyframes Toastify__bounceInLeft {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  0% {
    opacity: 0;
    -webkit-transform: translate3d(-3000px, 0, 0);
            transform: translate3d(-3000px, 0, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(25px, 0, 0);
            transform: translate3d(25px, 0, 0); }
  75% {
    -webkit-transform: translate3d(-10px, 0, 0);
            transform: translate3d(-10px, 0, 0); }
  90% {
    -webkit-transform: translate3d(5px, 0, 0);
            transform: translate3d(5px, 0, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@-webkit-keyframes Toastify__bounceOutLeft {
  20% {
    opacity: 1;
    -webkit-transform: translate3d(20px, 0, 0);
            transform: translate3d(20px, 0, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(-2000px, 0, 0);
            transform: translate3d(-2000px, 0, 0); } }

@keyframes Toastify__bounceOutLeft {
  20% {
    opacity: 1;
    -webkit-transform: translate3d(20px, 0, 0);
            transform: translate3d(20px, 0, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(-2000px, 0, 0);
            transform: translate3d(-2000px, 0, 0); } }

@-webkit-keyframes Toastify__bounceInUp {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  from {
    opacity: 0;
    -webkit-transform: translate3d(0, 3000px, 0);
            transform: translate3d(0, 3000px, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(0, -20px, 0);
            transform: translate3d(0, -20px, 0); }
  75% {
    -webkit-transform: translate3d(0, 10px, 0);
            transform: translate3d(0, 10px, 0); }
  90% {
    -webkit-transform: translate3d(0, -5px, 0);
            transform: translate3d(0, -5px, 0); }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@keyframes Toastify__bounceInUp {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  from {
    opacity: 0;
    -webkit-transform: translate3d(0, 3000px, 0);
            transform: translate3d(0, 3000px, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(0, -20px, 0);
            transform: translate3d(0, -20px, 0); }
  75% {
    -webkit-transform: translate3d(0, 10px, 0);
            transform: translate3d(0, 10px, 0); }
  90% {
    -webkit-transform: translate3d(0, -5px, 0);
            transform: translate3d(0, -5px, 0); }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@-webkit-keyframes Toastify__bounceOutUp {
  20% {
    -webkit-transform: translate3d(0, -10px, 0);
            transform: translate3d(0, -10px, 0); }
  40%,
  45% {
    opacity: 1;
    -webkit-transform: translate3d(0, 20px, 0);
            transform: translate3d(0, 20px, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(0, -2000px, 0);
            transform: translate3d(0, -2000px, 0); } }

@keyframes Toastify__bounceOutUp {
  20% {
    -webkit-transform: translate3d(0, -10px, 0);
            transform: translate3d(0, -10px, 0); }
  40%,
  45% {
    opacity: 1;
    -webkit-transform: translate3d(0, 20px, 0);
            transform: translate3d(0, 20px, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(0, -2000px, 0);
            transform: translate3d(0, -2000px, 0); } }

@-webkit-keyframes Toastify__bounceInDown {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  0% {
    opacity: 0;
    -webkit-transform: translate3d(0, -3000px, 0);
            transform: translate3d(0, -3000px, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(0, 25px, 0);
            transform: translate3d(0, 25px, 0); }
  75% {
    -webkit-transform: translate3d(0, -10px, 0);
            transform: translate3d(0, -10px, 0); }
  90% {
    -webkit-transform: translate3d(0, 5px, 0);
            transform: translate3d(0, 5px, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@keyframes Toastify__bounceInDown {
  from,
  60%,
  75%,
  90%,
  to {
    -webkit-animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1);
            animation-timing-function: cubic-bezier(0.215, 0.61, 0.355, 1); }
  0% {
    opacity: 0;
    -webkit-transform: translate3d(0, -3000px, 0);
            transform: translate3d(0, -3000px, 0); }
  60% {
    opacity: 1;
    -webkit-transform: translate3d(0, 25px, 0);
            transform: translate3d(0, 25px, 0); }
  75% {
    -webkit-transform: translate3d(0, -10px, 0);
            transform: translate3d(0, -10px, 0); }
  90% {
    -webkit-transform: translate3d(0, 5px, 0);
            transform: translate3d(0, 5px, 0); }
  to {
    -webkit-transform: none;
            transform: none; } }

@-webkit-keyframes Toastify__bounceOutDown {
  20% {
    -webkit-transform: translate3d(0, 10px, 0);
            transform: translate3d(0, 10px, 0); }
  40%,
  45% {
    opacity: 1;
    -webkit-transform: translate3d(0, -20px, 0);
            transform: translate3d(0, -20px, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(0, 2000px, 0);
            transform: translate3d(0, 2000px, 0); } }

@keyframes Toastify__bounceOutDown {
  20% {
    -webkit-transform: translate3d(0, 10px, 0);
            transform: translate3d(0, 10px, 0); }
  40%,
  45% {
    opacity: 1;
    -webkit-transform: translate3d(0, -20px, 0);
            transform: translate3d(0, -20px, 0); }
  to {
    opacity: 0;
    -webkit-transform: translate3d(0, 2000px, 0);
            transform: translate3d(0, 2000px, 0); } }

.Toastify__bounce-enter--top-left, .Toastify__bounce-enter--bottom-left {
  -webkit-animation-name: Toastify__bounceInLeft;
          animation-name: Toastify__bounceInLeft; }

.Toastify__bounce-enter--top-right, .Toastify__bounce-enter--bottom-right {
  -webkit-animation-name: Toastify__bounceInRight;
          animation-name: Toastify__bounceInRight; }

.Toastify__bounce-enter--top-center {
  -webkit-animation-name: Toastify__bounceInDown;
          animation-name: Toastify__bounceInDown; }

.Toastify__bounce-enter--bottom-center {
  -webkit-animation-name: Toastify__bounceInUp;
          animation-name: Toastify__bounceInUp; }

.Toastify__bounce-exit--top-left, .Toastify__bounce-exit--bottom-left {
  -webkit-animation-name: Toastify__bounceOutLeft;
          animation-name: Toastify__bounceOutLeft; }

.Toastify__bounce-exit--top-right, .Toastify__bounce-exit--bottom-right {
  -webkit-animation-name: Toastify__bounceOutRight;
          animation-name: Toastify__bounceOutRight; }

.Toastify__bounce-exit--top-center {
  -webkit-animation-name: Toastify__bounceOutUp;
          animation-name: Toastify__bounceOutUp; }

.Toastify__bounce-exit--bottom-center {
  -webkit-animation-name: Toastify__bounceOutDown;
          animation-name: Toastify__bounceOutDown; }

@-webkit-keyframes Toastify__zoomIn {
  from {
    opacity: 0;
    -webkit-transform: scale3d(0.3, 0.3, 0.3);
            transform: scale3d(0.3, 0.3, 0.3); }
  50% {
    opacity: 1; } }

@keyframes Toastify__zoomIn {
  from {
    opacity: 0;
    -webkit-transform: scale3d(0.3, 0.3, 0.3);
            transform: scale3d(0.3, 0.3, 0.3); }
  50% {
    opacity: 1; } }

@-webkit-keyframes Toastify__zoomOut {
  from {
    opacity: 1; }
  50% {
    opacity: 0;
    -webkit-transform: scale3d(0.3, 0.3, 0.3);
            transform: scale3d(0.3, 0.3, 0.3); }
  to {
    opacity: 0; } }

@keyframes Toastify__zoomOut {
  from {
    opacity: 1; }
  50% {
    opacity: 0;
    -webkit-transform: scale3d(0.3, 0.3, 0.3);
            transform: scale3d(0.3, 0.3, 0.3); }
  to {
    opacity: 0; } }

.Toastify__zoom-enter {
  -webkit-animation-name: Toastify__zoomIn;
          animation-name: Toastify__zoomIn; }

.Toastify__zoom-exit {
  -webkit-animation-name: Toastify__zoomOut;
          animation-name: Toastify__zoomOut; }

@-webkit-keyframes Toastify__flipIn {
  from {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in;
    opacity: 0; }
  40% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in; }
  60% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 10deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 10deg);
    opacity: 1; }
  80% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -5deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -5deg); }
  to {
    -webkit-transform: perspective(400px);
            transform: perspective(400px); } }

@keyframes Toastify__flipIn {
  from {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in;
    opacity: 0; }
  40% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
    -webkit-animation-timing-function: ease-in;
            animation-timing-function: ease-in; }
  60% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 10deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 10deg);
    opacity: 1; }
  80% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -5deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -5deg); }
  to {
    -webkit-transform: perspective(400px);
            transform: perspective(400px); } }

@-webkit-keyframes Toastify__flipOut {
  from {
    -webkit-transform: perspective(400px);
            transform: perspective(400px); }
  30% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
    opacity: 1; }
  to {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
    opacity: 0; } }

@keyframes Toastify__flipOut {
  from {
    -webkit-transform: perspective(400px);
            transform: perspective(400px); }
  30% {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
            transform: perspective(400px) rotate3d(1, 0, 0, -20deg);
    opacity: 1; }
  to {
    -webkit-transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
            transform: perspective(400px) rotate3d(1, 0, 0, 90deg);
    opacity: 0; } }

.Toastify__flip-enter {
  -webkit-animation-name: Toastify__flipIn;
          animation-name: Toastify__flipIn; }

.Toastify__flip-exit {
  -webkit-animation-name: Toastify__flipOut;
          animation-name: Toastify__flipOut; }

@-webkit-keyframes Toastify__slideInRight {
  from {
    -webkit-transform: translate3d(110%, 0, 0);
            transform: translate3d(110%, 0, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@keyframes Toastify__slideInRight {
  from {
    -webkit-transform: translate3d(110%, 0, 0);
            transform: translate3d(110%, 0, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@-webkit-keyframes Toastify__slideInLeft {
  from {
    -webkit-transform: translate3d(-110%, 0, 0);
            transform: translate3d(-110%, 0, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@keyframes Toastify__slideInLeft {
  from {
    -webkit-transform: translate3d(-110%, 0, 0);
            transform: translate3d(-110%, 0, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@-webkit-keyframes Toastify__slideInUp {
  from {
    -webkit-transform: translate3d(0, 110%, 0);
            transform: translate3d(0, 110%, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@keyframes Toastify__slideInUp {
  from {
    -webkit-transform: translate3d(0, 110%, 0);
            transform: translate3d(0, 110%, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@-webkit-keyframes Toastify__slideInDown {
  from {
    -webkit-transform: translate3d(0, -110%, 0);
            transform: translate3d(0, -110%, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@keyframes Toastify__slideInDown {
  from {
    -webkit-transform: translate3d(0, -110%, 0);
            transform: translate3d(0, -110%, 0);
    visibility: visible; }
  to {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); } }

@-webkit-keyframes Toastify__slideOutRight {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(110%, 0, 0);
            transform: translate3d(110%, 0, 0); } }

@keyframes Toastify__slideOutRight {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(110%, 0, 0);
            transform: translate3d(110%, 0, 0); } }

@-webkit-keyframes Toastify__slideOutLeft {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(-110%, 0, 0);
            transform: translate3d(-110%, 0, 0); } }

@keyframes Toastify__slideOutLeft {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(-110%, 0, 0);
            transform: translate3d(-110%, 0, 0); } }

@-webkit-keyframes Toastify__slideOutUp {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(0, 110%, 0);
            transform: translate3d(0, 110%, 0); } }

@keyframes Toastify__slideOutUp {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(0, 110%, 0);
            transform: translate3d(0, 110%, 0); } }

@-webkit-keyframes Toastify__slideOutDown {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(0, -110%, 0);
            transform: translate3d(0, -110%, 0); } }

@keyframes Toastify__slideOutDown {
  from {
    -webkit-transform: translate3d(0, 0, 0);
            transform: translate3d(0, 0, 0); }
  to {
    visibility: hidden;
    -webkit-transform: translate3d(0, -110%, 0);
            transform: translate3d(0, -110%, 0); } }

.Toastify__slide-enter--top-left, .Toastify__slide-enter--bottom-left {
  -webkit-animation-name: Toastify__slideInLeft;
          animation-name: Toastify__slideInLeft; }

.Toastify__slide-enter--top-right, .Toastify__slide-enter--bottom-right {
  -webkit-animation-name: Toastify__slideInRight;
          animation-name: Toastify__slideInRight; }

.Toastify__slide-enter--top-center {
  -webkit-animation-name: Toastify__slideInDown;
          animation-name: Toastify__slideInDown; }

.Toastify__slide-enter--bottom-center {
  -webkit-animation-name: Toastify__slideInUp;
          animation-name: Toastify__slideInUp; }

.Toastify__slide-exit--top-left, .Toastify__slide-exit--bottom-left {
  -webkit-animation-name: Toastify__slideOutLeft;
          animation-name: Toastify__slideOutLeft; }

.Toastify__slide-exit--top-right, .Toastify__slide-exit--bottom-right {
  -webkit-animation-name: Toastify__slideOutRight;
          animation-name: Toastify__slideOutRight; }

.Toastify__slide-exit--top-center {
  -webkit-animation-name: Toastify__slideOutUp;
          animation-name: Toastify__slideOutUp; }

.Toastify__slide-exit--bottom-center {
  -webkit-animation-name: Toastify__slideOutDown;
          animation-name: Toastify__slideOutDown; }</style><style type="text/css" data-styled-components="" data-styled-components-is-local="true"></style><style type="text/css" data-styled-components="jqVHLt iyLjmU" data-styled-components-is-local="true">
/* sc-component-id: sc-cmTdod */

.jqVHLt{white-space:nowrap;}
/* sc-component-id: sc-jwKygS */

.iyLjmU{display:inline-block;font-size:12px;margin-left:10px;color:white;cursor:pointer;}.iyLjmU::before{content:'✕';}</style><style type="text/css" data-styled-components="gXkiAn" data-styled-components-is-local="true">
/* sc-component-id: sc-bXGyLb */

.gXkiAn{width:100%;height:100%;position:absolute;z-index:999;display:-webkit-box;display:-webkit-flex;display:-ms-flexbox;display:flex;-webkit-box-pack:center;-webkit-justify-content:center;-ms-flex-pack:center;justify-content:center;-webkit-align-items:center;-webkit-box-align:center;-ms-flex-align:center;align-items:center;}.gXkiAn .iframe-wrapper{position:absolute;z-index:999;width:480px;height:600px;background-color:#fff;}.gXkiAn .iframe-wrapper iframe{border-radius:2px;border:0;width:100%;height:100%;}.gXkiAn .iframe-wrapper span{position:absolute;width:12px;height:12px;top:23px;right:28px;z-index:999;cursor:pointer;}.gXkiAn .iframe-wrapper span path{fill:#c2c2c2;}.gXkiAn .background{width:100%;height:100%;position:absolute;background:rgba(65,70,75,0.5);}</style><style id="sm-ad-style-container">
  .sm-ad-wrapper {
    display: none;
  }
  .sm-ad-container {
    position: relative;
    height: 0;
    overflow: hidden;
  }
  .sm-ad-container a {
    display: block;
    width: 100%;
    height: 100%;
  }
  @keyframes fadeIn {
    from {
      opacity: 0.3;
    }
    to {
      opacity: 1;
     }
  }

  @keyframes fadeOut {
    from {
      opacity: 1;
     }
    to {
      opacity: 0;
     }
  }

  @-webkit-keyframes fadeIn {
    from {
      opacity: 0.3;
    }
    to {
      opacity: 1;
     }
  }

  @keyframes cardEaseIn {
    from {
      opacity: 0.3;
      top: 50px;
    }
    to {
      opacity: 1;
      top: 0;
     }
  }
  @-webkit-keyframes cardEaseIn {
    from {
      opacity: 0.3;
      top: 50px;
    }
    to {
      opacity: 1;
      top: 0;
     }
  }

  .sm-ad-item {
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    bottom: 0;
    display: block;
  }
  .sm-ad-img {
    display: block;
    max-width: 100%;
    min-width: 100%;
    height: 100%;
  }
  .ad-price {
    cursor: pointer;
    position: absolute;
    bottom: 0;
    right: 0;
    font-size: 10px;
    line-height: 1em;
    padding: 4px 12px;
    color: white;
    background-color: rgba(216, 216, 216);
    background-color: rgba(216, 216, 216, 0.3);
    border-top-left-radius: 2px;
  }
  .ad-close {
    position: absolute;
    top: 0;
    right: 0;
    z-index: 999;
    padding: 3px 7px;
    background-color: rgba(216, 216, 216, 0.3);
    color: white;
    font-size: 14px;
    border-radius: 50%;
  }
  .ad-close:before {
    content: "X";
  }
  .ad-price:before {
    content: "广告";
  }
  .sm-ad-item:hover > .ad-price {
    background-color: rgba(216, 216, 216);
    background-color: rgba(216, 216, 216, 0.5);
  }
  .sm-ad-item:hover > .ad-price:before  {
    content: "升级至无广告版本";
  }
  .sm-ad-mask {
    display: none;
    background-color: rgba(44, 48, 51, 0.4);
    position: absolute;
    top: 0;
    left: 0;
    bottom: 0;
    right: 0;
  }
  .sm-ad-mask button {
    width: 120px;
    height: 35px;
    border-radius: 3px;
    box-shadow: 0px 4px 30px 0px rgba(0,0,0,0.3);
    color: #ffffff;
    font-size: 15px;
    transform: translate(0%, 50%);
  }
  .sm-ad-ever-close {
    background-color: #E1AE6C;
    margin-right: 8px;
    border: none;
  }
  .sm-ad-temporal-close {
    border: 1px solid #FFF;
    background-color: rgba(0,0,0,0.1);
  }

  .sm-ad-card {
    width: 100%;
    position: relative;
    margin: 10px 0;
  }
  .sm-ad-card a {
    text-decoration: none;
  }
  .sm-ad-card .sm-ad-carousel__switcher {
    display: none;
  }
  .sm-ad-card:hover .sm-ad-carousel__switcher {
    display: block;
  }
  .sm-ad-card__close {
    width: 12px;
    height: 12px;
    transform: rotate(45deg);
    color: #cdcdcd;
    position: absolute;
    top: -5px;
    right: -5px;
    font-weight: lighter;
    cursor: pointer;
  }
  .sm-ad-card__close:before {
    content: "+";
    font-size: 20px
  }
  .sm-ad-card__image-wrapper {
    position: relative;
    height: 100%;
  }
  .sm-ad-card__image {
    display: block;
    width: 100%;
    height: 100%;
  }
  .sm-ad-card__label {
    color: white;
    width: 45px;
    height: 22px;
    text-shadow: 0 2px 6px rgba(0, 0, 0, 0.65);
    font-size: 14px;
    transform: scale(0.5);
    transform-origin: top left;
    position: absolute;
    left: 3px;
    top: 2px;
    text-align: center;
  }
  .sm-ad-card__label--dark {
    text-shadow: unset;
    background-color: black;
    transform-origin: bottom right;
    right: 0;
    bottom: 0;
    left: unset;
    top: unset;
    width: 130px;
    height: 30px;
    line-height: 30px;
    color: rgba(255, 255, 255, 0.85);
    cursor: pointer;
  }
  .sm-ad-card__label.sm-ad-card__label--bottom-right,
  .sm-ad-card__label.sm-ad-card__label--top-right {
    width: auto;
    position: absolute;
    color: #fff;
    background-color:#000;
    padding: 4px 12px;
    font-size: 14px;
    line-height: 20px;
    text-shadow: none;
    bottom: 7px;
    left: initial;
    top: initial;
    right: 10px;
    transform-origin: bottom right;
  }
  .sm-ad-card__label.sm-ad-card__label--top-right {
    bottom: initial;
    top: 10px;
    transform-origin: top right;
  }
  .sm-ad-carousel__switcher {
    width: 12px;
    height: 12px;
    position: absolute;
    top: 46%;
    cursor: pointer;
  }
  .sm-ad-carousel__switcher > svg {
    width: 100%;
    height: 100%;
    vertical-align: top;
  }
  .sm-ad-carousel__switcher-right > svg {
    transform: rotateY(180deg);
  }
  .sm-ad-carousel__switcher-left {
    left: 3px;
  }
  .sm-ad-carousel__switcher-right {
    right: 3px;
  }

  .sm-ad-text-link a {
    text-decoration: none;
  }
  .sm-ad-text-link p {
    text-overflow: ellipsis;
    white-space: nowrap;
    overflow: hidden;
  }

  .sm-ad-shortcut {
    width: 217px;
    height: 30px;
    background-color: #efefef;
    left: -10px;
    cursor: pointer
  }
  .sm-ad-shortcut .sm-ad-card__label {
    width: 48px;
    height: 28px;
    line-height: 28px;
    right: unset;
    bottom: unset;
    top: -5px;
    left: -17px;
  }
  .sm-ad-shortcut p {
    padding-left: 45px;
    font-size: 13px;
    line-height: 1.5;
    color: #7f7f7f;
    padding-top: 6px;
    width: 160px;
  }
  .sm-ad-shortcut .sm-ad-card__close {
    width: 20px;
    height: 20px;
    color: #a5a5a5;
    display: none;
    top: 4px;
    right: -1px;
    font-weight: 200;
  }
  .sm-ad-shortcut:hover .sm-ad-card__close {
    display: block;
  }
  .sm-ad-shortcut .sm-ad-card__close:before {
    font-size: 24px;
  }

  .sm-ad-mobile-link {
    width: 100%;
    height: 16px;
    margin: 15px 0 20px;
  }
  .sm-ad-mobile-link .sm-ad-card__label {
    width: 60px;
    left: -30px;
    font-size: 16px;
  }
  .sm-ad-mobile-link p {
    padding-left: 40px;
    font-size: 14px;
    font-weight: 300;
    line-height: 1;
    color: #41464b;
    width: calc(100% - 40px);
    text-align: left;
  }

  .sm-ad-mobile-card {
    height: 48vw;
    margin: 15px 0;
  }

  .sm-ad-mobile-top-banner {
    transition: height 1s ease 0s;
    height: 88px;
    width: 100%;
    margin: 0;
    position: fixed;
    z-index: 999;
  }

  .sm-ad-mobile-top-banner .sm-ad-card__label--bottom-right {
    bottom: 0;
    right: 0;
    background-color: #000000;
    border: 0;
    color: white;
  }

  .sm-ad-mobile-top-banner .sm-ad-card__label--top-left {
    left: 5px;
    top: 5px;
  }

  .sm-ad-mobile-top-banner .sm-ad-card__close {
    right: 0px;
    top: 0px;
  }

  .sm-ad-mobile-card__button {
    width: 120px !important;
    height: 36px !important;
    min-width: auto;
    position: absolute;
    bottom: 16px;
    left: calc(50% - 60px);
  }

  .sm-ad-mobile-stream-a {
    text-decoration:none;
  }
  .sm-ad-mobile-pic-container .sm-ad-card__close,
  .sm-ad-mobile-mixed-container .sm-ad-card__close {
    width: 14px;
    height: 14px;
    top: 14px;
    right: 14px;
  }
  .sm-ad-mobile-pic-container .sm-ad-card__close:before,
  .sm-ad-mobile-mixed-container .sm-ad-card__close:before {
    font-size: 24px;
    line-height: 10px;
  }
  .tencent-ad.sm-ad-mobile-stream-card__label {
    bottom: 0;
    left: 0;
  }
  .sm-ad-mobile-pic-container .sm-ad-mobile-stream-card__label,
  .sm-ad-mobile-mixed-container .sm-ad-mobile-stream-card__label {
    height: 18px;
    line-height: 18px;
    padding: 0 6px;
    top: 15px;
    left: 15px;
    text-align: center;
    border-radius: 2px;
    background-color: rgba(0,0,0,0.2);
    color: white;
  }
  .sm-ad-mobile-pic-container .sm-ad-mobile-stream-card__upgrade,
  .sm-ad-mobile-mixed-container .sm-ad-mobile-stream-card__upgrade,
  .tencent-ad.sm-ad-mobile-stream-card__upgrade {
    bottom: 0;
    right: 0;
  }
  .sm-ad-mobile-mixed-container .sm-ad-mobile-stream-card__label,
  .sm-ad-mobile-mixed-container .sm-ad-mobile-stream-card__upgrade {
    z-index: 1;
  }
  .sm-ad-mobile-stream-card__label, .sm-ad-mobile-stream-card__upgrade {
    position: absolute;
    color: #41464b;
    font-size: .7em;
    padding: 10px;
    line-height: 10px;
  }
  .sm-ad-mobile-stream-card__label {
    text-align: left;
  }
  .sm-ad-mobile-stream-card__upgrade {
    padding: 3px 6px;
    margin: 6px 10px;
    border: 1px solid #41464b;
    border-radius: 2px;
  }
  .sm-ad-mobile-mixed-container {
    position: relative;
    left: 0px;
    padding: 10px 10px 30px 10px !important;
    background-color: #f8f8f8;
  }
  .sm-ad-mobile-mixed-a {
    position: relative;
    float: left;
    display: flex;
    width: 100%;
  }
  .sm-ad-mobile-mixed-image {
    position: relative;
    float: left;
    flex: none;
  }
  .sm-ad-mobile-mixed-content {
    color: #000;
    line-height: normal;
    letter-spacing: 1.6px;
    background-color: rgb(238, 238, 238);
    display: flex;
    flex-direction: column;
  }
  .sm-ad-mobile-mixed-text {
    flex: auto;
    margin: 12px 9.5px 0 14.5px;
    overflow: hidden;
    font-size: 1em;
  }
  .sm-ad-mobile-mixed-price {
    flex: auto;
    margin-left: 14px;
    letter-spacing: 1.7px;
    overflow: hidden;
    width: calc(100% - 28px);
    font-size: 1em;
    white-space: nowrap;
    text-overflow: ellipsis;
  }
  .sm-ad-mobile-mixed-brandText {
    margin-left: 5px;
    letter-spacing: 1.6px;
    color: #676b6f;
  }
  .sm-ad-mobile-mixed-button {
    margin: 0 0 10.5px 14px;
    width: fit-content;
    max-width: 300px;
    background-color: #41464b;
    color: #fff;
    text-align: center;
    overflow: hidden;
    font-size: .86em;
    padding: .3em 1.2em;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 1;
  }
  .sm-ad-mobile-pic-container {
    position: relative;
    float: left;
    width: 100%;
    padding: 10px 10px 30px 10px !important;
    background-color: #f8f8f8;
  }
  .sm-ad-mobile-pic {
    width: 100%;
  }

  .sm-ad-bottom-card__wrapper {
    position: relative;
    top: -18px;
    left: -4px;
  }
  .sm-ad-bottom-card__wrapper--animation {
    animation: cardEaseIn 1s ease-in-out;
    -webkit-animation: cardEaseIn 1s ease-in-out;
  }
  .sm-ad-bottom-card {
    width: 182px;
    height: 182px;
    position: relative;
    background-size: cover;
    cursor: pointer;
  }
  .sm-ad-bottom-card p {
    font-size: 11px;
    color: white;
  }
  .sm-ad-bottom-card .sm-ad-card__close {
    top: -8px;
    right: -2px;
    color: white;
  }
  .sm-ad-bottom-card .sm-ad-card__close:before {
    font-size: 30px;
  }
  .sm-ad-bottom-card__apron {
    box-sizing: border-box;
    width: 100%;
    height: 44px;
    background-color: rgba(0, 0, 0, 0.1);
    padding: 0 15px;
    position: absolute;
    left: 0;
    bottom: 0;
  }
  .sm-ad-bottom-card__text {
    position: relative;
    display: flex;
    flex-direction: column;
    justify-content: center;
    height: 100%;
    top: -7px;
    line-height: 1.1;
  }
  .sm-ad-bottom-card__text p {
    margin: 0;
  }

  .sm-ad-banner {
    height: 50px;
    max-width: 712px;
  }
  .sm-ad-banner .sm-ad-card__close {
    color: #ccc;
    top: -7px;
  }
  .sm-ad-banner::-webkit-scrollbar {
    width: 0;
    background-color: transparent;
  }
  .sm-ad-banner__image {
    width: 712px;
    height: 50px;
    display: block;
  }

  .sm-ad-container.tencent-ad-container .sm-ad-item,
  .sm-ad-container.with-padding-background .sm-ad-item {
    padding: 10px 10px 30px;
    background: #eee;
  }

  .sm-ad-container.with-padding-background .sm-ad-item {
    box-sizing: border-box;
  }

  .sm-ad-container.with-padding-background.sm-ad-mobile-card .sm-ad-item {
    padding-bottom: 10px;
  }

  .sm-ad-mobile-link .sm-ad-card__label--bordered {
    left: 0;
    top: 0;
    width: auto;
    border: solid 1px #41464b;
    color: #41464b;
    padding: 2px 12px;
    font-size: 14px;
    line-height: 20px;
    text-shadow: none;
  }

  .ad-template {
    position: relative;
    overflow: hidden;
    border-radius: 8px;
    background-color: #eaeef1;
  }
  .ad-template__container {
    display: flex;
    justify-content: space-between;
    height: 240px;
    padding-right: 8px;
  }
  .ad-template__mainColumn {
    display: flex;
    flex-direction: column;
    justify-content: center;
    flex-shrink: 0;
    width: 368px;
    padding: 32px 40px;
  }
  .ad-template__title {
    overflow: hidden;
    font-size: 24px;
    font-weight: 600;
    line-height: 32px;
    white-space: nowrap;
    text-overflow: ellipsis;
    color: #2c3033;
  }
  .ad-template__content {
    overflow: hidden;
    max-height: 72px;
    margin-top: 16px;
    font-size: 16px;
    line-height: 24px;
    white-space: pre-line;
    color: #2c3033;
    display: -webkit-box;
    -webkit-box-orient: vertical;
    -webkit-line-clamp: 3;
  }
  .ad-template__buttons {
    display: flex;
    margin: 16px -12px 0;
  }
  .ad-template__button {
    flex: 1;
    overflow: hidden;
    padding: 0 12px;
  }
  .ad-template__sideColumn {
    flex-shrink: 0;
    padding: 24px 40px 16px;
  }
  .ad-template__image {
    height: 200px;
  }
  .ad-template__close {
    position: absolute;
    right: 16px;
    top: 16px;
    width: 20px;
    height: 20px;
    border-radius: 50%;
    cursor: pointer;
  }
  .ad-template__close > svg {
    display: block;
  }
  .ad-button {
    display: block;
    overflow: hidden;
    box-sizing: border-box;
    height: 40px;
    padding: 7px;
    border: 1px solid;
    border-radius: 4px;
    font-size: 16px;
    font-weight: 500;
    line-height: 24px;
    white-space: nowrap;
    text-overflow: ellipsis;
    text-align: center;
    text-decoration: none;
  }
  .ad-button--primary {
    border-color: #4583d4;
    color: #fff;
    background-image: linear-gradient(#5ba0e7, #4583d4);
  }
  .ad-button--primary:hover {
    background-image: none;
    background-color: #5ba0e7;
  }
  .ad-button--primary:active {
    background-image: none;
    background-color: #4583d4;
  }
  .ad-button--secondary {
    border-color: rgba(65, 70, 75, 0.2);
    color: #4583d4;
    background-image: linear-gradient(#fff, #f6f6f6);
  }
  .ad-button--secondary:hover {
    background-image: none;
    background-color: #fff;
  }
  .ad-button--secondary:active {
    background-image: none;
    background-color: #f6f6f6;
  }
  </style><style type="text/css">.ql-sidebar{display:none;width:340px;max-height:100vh;position:fixed;top:0;right:0;background:#f7f7f7;margin-right:auto;border-bottom:1px solid #d9d9d9;box-shadow:0 1px 6px #ccc;transition:right .2s ease-in}.sm-sidebar{width:100%;height:100%}.sm-sidebar .sm-sidebar-title{margin:0 20px;height:48px;line-height:46px;font-size:12px;border-bottom:1px solid #ddd;position:relative}.sm-sidebar .sm-sidebar-title .title-text{display:inline-block;color:#a5a5a5}.sm-sidebar .sm-sidebar-title .icon-close{width:11px;height:11px;margin:7px;color:#888;position:absolute;line-height:12px;right:0;top:10px}.sm-sidebar .sm-sidebar-title .icon-close svg path{fill:#c6c6c6}.sm-sidebar .sm-sidebar-title .icon-close svg:hover{cursor:pointer}.sm-sidebar .sm-sidebar-title .icon-close svg:hover path{fill:#5d5d5d}.sm-sidebar .sm-sidebar-body{height:calc(100% - 48px)}</style><style id="folding-style"></style><script charset="utf-8" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/chunk-vendors_toc-ecd9676ae9.js"></script><link rel="stylesheet" type="text/css" href="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/toc-f9d6f63f12.css"><script charset="utf-8" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/chunk-toc-6b60dad779.js"></script><script charset="utf-8" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/chunk-vendors_hljs-d59d54dee8.js"></script></head>
    <body class="">
        <div id="file-page-header"><div id="ToastsContainer_ShimoUI"><div class="Toastify"></div></div><div class="sc-exAgwC doEjVX"><div class="sc-cQFLBn jqmOiT"><div class="sc-gisBJw cbYHdA"><a class="sc-caSCKo iaSppr" href="https://shimo.im/desktop"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 106 25" class="sc-fAjcbJ kOTtUa"><path d="M24.9 2.9L23.1.8l-1.7 1.5H2l1 1.2c.1.1.2.1.3.1.2 0 3.3-.1 7.2-.1C8.3 9 5.8 14.1.2 18.6c-.1 0-.1.1-.1.2s.1.2.2.2h.1c5-3.2 7.8-6.8 8.1-7.3v12.8c0 .2.3.3.4.3.9-1.1 1.5-2.1 1.6-3.3 1 0 5.5 0 8-.1.3.3.5.3.7 1.3 0 .2.1.2.3.2h.1c1.7-1 1.9-1.9 1.9-5v-5.6c0-.1 0-.1.1-.2l.5-1.1c.1-.1.1-.2 0-.3l-1.9-1.1c-.1-.1-.3 0-.3.1l-.5 1.1c0 .1-.1.1-.2.1h-8.3l-1.2-.5c1.4-1.8 2-2.9 2.8-4.3.1-.2.1-.3.2-.3.2-.1.2-.3.1-.5l-.1-.1c-.7-.5-1.3-1-1.7-1.7 2.9-.1 13.8-.2 13.8-.2.1 0 .2-.1.1-.4zm-14.3 8.6l.3-.2h8.2c.1 0 .3.1.3.3v7.2c0 .5-.1 1.2-.6 1.7l-.2.1h-8v-9.1zm25.8 1.6c1.4.6 2.4 1.3 2.9 1.7s.5.8 0 1.4c-.1.2-.2.3-.6.6-.6.4-1 .3-1.2-.4-.3-1.6-.8-2.7-1.4-3.3.1.1.1 0 .3 0zm5.8 0c1.5.6 2.4 1.2 3 1.6.5.4.5.8.1 1.4-.1.2-.2.3-.6.7-.6.4-1 .3-1.2-.3-.4-1.6-.9-2.7-1.5-3.2 0-.1.1-.2.2-.2zm-8.5-.1l.1-.1c.1 0 .1 0 .1.1 0 0-.2 2.9-.5 3.5-.2.6-.6.8-1.3.6-.3-.1-1-.4-1-.4-.5-.3-.4-.8 0-1.1 1.5-.9 2.2-1.6 2.6-2.6zm19 9.5v.1c0 .1 0 .1-.1.1H30.3s-.1 0-.2-.1l-.7-.6h10.9v-2.3c-4.1 0-8.1.1-8.3.1 0 0-.1 0-.2-.1l-.7-.7h9.2v-3.6l2.1.5c.1 0 .1.1 0 .2l-.2.3V19h6.1l1.2-1.2 1.5 1.6v.1s0 .1-.1.1h-.1s-4.3 0-8.8.1V22h7l1.5-1.6 2.2 2.1zm-2.1-8.2c.6.3.7.7.3 1.5-.1.2-.1.4-.5.8-.5.5-1 .5-1.3-.1-.7-1.6-1.4-2.7-2.1-3.1-.1-.1 0-.2.1-.2 1.7.3 2.8.7 3.5 1.1zm1.3-1.7l.1.1c0 .1-.1.1-.1.1h-.1c-20.6-.1-20.6 0-20.8 0 0 0-.1 0-.2-.1l-.7-.7 10.2.1v-1.9h-7s-.1 0-.2-.1l-.7-.7 7.9.1V7.7h-6.5c-.4.4-1.1 1-1.4 1.2l-.1.1c-.1 0-.2-.1-.2-.2V1.7l2 .6h14.3l.6-1 1.1.6.7.3c.1 0 .1.1 0 .2l-.4.8v4.1l.1.2c.1.1-.1.3-.2.3h-7.9v1.8h5.1l1.1-1.1 1.5 1.5v.1s0 .1-.1.1h-7.7v1.9h7l1.2-1.1 1.4 1.6zm-9.7-9.8v4.3h1.5c.9-1.3 1.2-2.2 1.6-3.8 0-.1 0-.2.1-.2 0 0 .1 0 .1.1l1.3 1.2c.1.1.2.2 0 .4-.6 1.2-2.5 2.1-3.1 2.3h4.4V2.8h-5.9zm-2 4.3V2.8h-6.3v4.3h6.3zm-1.8-2.5c.4.3.4.7 0 1.3-.1.2-.2.3-.5.6-.5.4-.9.2-1.1-.3-.3-1.5-.7-2.5-1.3-3 0-.1 0-.2.1-.1 1.5.5 2.3 1.1 2.8 1.5zM67 4.5C66.3 2.4 65.6 1 64.7.4c-.1-.1 0-.3.2-.2 2 .6 3.1 1.5 3.9 2 .7.4.7 1 .2 1.9-.1.2-.3.5-.5.7-.6.7-1.2.5-1.5-.3zm11.8 16c.1 0 .2.1.2.3 0 .1-.1.2-.2.2s-.4.1-.6.1c-.8.1-2 .4-2.5 1.6l-.1.1-.1.1h-.2c-2-.9-6.5-3-8.1-4.7l-.1-.1c-2.4 2.2-5.4 3.6-10.6 5h-.1c-.1 0-.2-.1-.2-.2s.1-.2.1-.2c4.4-1.8 7.4-3.8 9.5-6-2.2-2.8-3-5.5-4-10h-4.4c-.1 0-.2 0-.3-.1l-.8-.9h18.8l1.5-1.6L78.3 6c.1.2 0 .3-.2.3 0 0-3.3.1-6.7.2.5.3 1.1.5 1.7.6 0 0 .1 0 .1.1.2.1.1.4-.1.4-.1 0-.4.2-.4.4-.7 2.7-2.3 6.4-4.2 8.5l-.2.2c3.2 2.1 6.6 2.9 10.5 3.8zm-16.1-14c1.2 4 2.7 6.8 4.5 8.7 1.9-2.6 2.9-5.5 3.6-8.8-2.4.1-4.8.1-5.9.1h-2.2zm42.9-3.2c.2.1.1.3-.1.4-.1 0-.3.2-.4.4-1.4 1.7-2.7 3.3-4.8 4.9h-.1c-.1 0-.2-.1-.2-.2s.1-.1.1-.2c1.6-2.7 2.2-4 3-6.4 0-.1.1-.2.2-.2s.2.1.2.1l.1.1c.6.3 1.4.8 2 1.1zM94 7.6c-.1-2.1-1.1-4.7-1.7-5.4 0-.1.1-.2.2-.2 1.6 1.3 2.3 2 3 2.6 1.1 1.1 1 2.5.4 3.2-.2.2-.2.3-.4.4-.9.6-1.4.3-1.5-.6zm-1.4 5.8c-.1.2-.3.3-.4.5-.5.5-1 .3-1.3-.3-.4-1.6-.9-2.6-1.5-3.2v9.8c-.1 1.3-.4 2.3-1.4 3.5-.2.1-.5 0-.5-.3V11.2c-.8 2.5-2.7 4.9-4.6 7 0 .1-.1.1-.1.1-.1.1-.2 0-.3-.1-.1-.1 0-.2 0-.3 3.1-4.4 4-7.9 4.7-11.1h-3.3s-.1 0-.2-.1L83 6l4.2.1h.3v-6l2.1.6c.1.1.1.1 0 .2l-.3.3v4.9h1L91.5 5l1.6 1.5.1.1c0 .1-.1.1-.1.1h-3.7v2.8c1.6.6 2.6 1.4 3.1 2 .4.6.6 1.2.1 1.9zm12.6-3.9c.1.1.1.2 0 .3l-.6 1.1c0 .1-.1.1-.1.2v6.2c0 3.4.1 4.5-1.8 5.7h-.1c-.2 0-.3 0-.3-.2-.3-1.1-.4-1.1-.8-1.4-2.8.1-8 .1-9.1.1l-.6-.8h9.8l.2-.1c.5-.6.7-1.3.7-1.9V16s-.1-.1-.2-.1h-9.4l-.6-.7h10v-4.6c0-.2-.1-.3-.3-.3h-9.4l-.6-.7h5.1V.1l2.2.6c.1.1.1.1 0 .2l-.4.3v8.3h3c.1 0 .2-.1.2-.1l.5-1c.1-.1.3-.2.4-.1l2.2 1.2z" fill="#a5a5a5"></path></svg></a></div><div class="sc-fMiknA fWfGDr">开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记</div><button class="sc-lhVmIH iAQwBy"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" width="20px" height="20px"><path d="M13.5 16.9V4.5h-7v12.4l3.5-3.5 3.5 3.5z" fill="none" stroke="#a5a5a5"></path></svg></button><div class="sc-elJkPf cuKFxh"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 14 14" class="sc-bYSBpT cZZyrb" width="12px" height="12px"><path d="M7 13c-3.3 0-6-2.7-6-6s2.7-6 6-6 6 2.7 6 6-2.7 6-6 6zm0-1c2.8 0 5-2.2 5-5S9.8 2 7 2 2 4.2 2 7s2.2 5 5 5zm2.2-8l.8.4L6.1 10 4 7l.7-.6L6.1 8l3.1-4z" fill="#7a9880"></path></svg>2021年4月30日 更新</div></div><div class="sc-gojNiO hAHnBB"><span style="display:inline-block;cursor:not-allowed" class="file-demo-screen-btn"><button class="sm-button sc-hzDkRC iObLYz sc-1n784rm-0 sfCUt" type="primary" disabled="" style="pointer-events:none"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 20 20" class="sc-jhAzac cUDKsr" width="20px" height="20px"><path d="M10 17c-3.9 0-7-3.1-7-7s3.1-7 7-7 7 3.1 7 7-3.1 7-7 7zm0-1c3.3 0 6-2.7 6-6s-2.7-6-6-6-6 2.7-6 6 2.7 6 6 6zm-1.5-3.5v-5l4 2.4-4 2.6z" fill="#555"></path></svg></button></span><button class="register sc-btzYZH jVcKXm">注册</button><button class="login sc-btzYZH jVcKXm">登录</button><button class="sm-button sc-kvZOFW dStWqN sc-1n784rm-0 inYJrZ" type="default"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 40 40" width="18px" height="18px"><path d="M18 12c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm0 9c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2zm0 9c0-1.1.9-2 2-2s2 .9 2 2-.9 2-2 2-2-.9-2-2z" fill="#41464b"></path></svg></button></div></div><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="sm-tooltip  randomClass-mvIob  sm-tooltip-theme-blue sm-tooltip-placement-bottom " style="z-index: 998; left: 1256.49px; top: 39px;"><div class="sm-tooltip-content"><div class="sm-tooltip-arrow"></div><div class="sm-tooltip-inner"><span class="sc-cmTdod jqVHLt">开启更多功能，提升办公效能<span class="sc-jwKygS iyLjmU"></span></span></div></div></div></div></div></div>
        <div id="app-container" class="sm-docs-container external-readonly">
            <div id="editor-scroller" class="editor-scroller">
                <div id="editor" class="ql-container ql-disabled ql-snow ">
                    <div class="ql-title"><div class="ql-title-box" data-value="开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记"><input data-value="开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记" readonly="true" class="mousetrap" id="ql-title-input" autocomplete="off" autocorrect="off" spellcheck="false" value="开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记"></div></div>
                    <div class="ql-editor"><p line="f2Rz"><span style="background: #f9eda6;color: #ff0000;">关注公众号 MarkerHub，回复【 VueAdmin 】可以加群讨论学习、另外还会不定时安排B站视频直播答疑！</span></p><p line="gM9h"><br></p><p line="twTH">一个spring security + jwt + vue的前后端分离项目！综合运用！</p><p line="1KrE"><span class="ql-divide"><span class="ql-hr"></span></span></p><blockquote line="GrlU"><div class="ql-blockquote-item">首发公众号：MarkerHub</div></blockquote><blockquote line="FZfl"><div class="ql-blockquote-item">作者：吕一明</div></blockquote><blockquote line="XmP0"><div class="ql-blockquote-item">视频讲解：<a class="ql-link" href="https://www.bilibili.com/video/BV1af4y1s7Wh/?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2NjUxNTkwMDcsImZpbGVHVUlEIjoiT25aRHdveEZGTDhiblAxYyIsImlhdCI6MTY2NTE1ODcwNywiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotNzIyOTE4Nzc3MX0.AhLZ3583HEK7kJAwvXusonzSRo0h-zE4btlUTrVMoBw" target="_blank" rel="noopener noreferrer nofollow">https://www.bilibili.com/video/BV1af4y1s7Wh/</a></div></blockquote><blockquote line="N8ap"><div class="ql-blockquote-item">线上演示：<a class="ql-link" href="https://www.markerhub.com/vueadmin/?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2NjUxNTkwMDcsImZpbGVHVUlEIjoiT25aRHdveEZGTDhiblAxYyIsImlhdCI6MTY2NTE1ODcwNywiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotNzIyOTE4Nzc3MX0.AhLZ3583HEK7kJAwvXusonzSRo0h-zE4btlUTrVMoBw" target="_blank" rel="noopener noreferrer nofollow">https://www.markerhub.com/vueadmin/</a></div></blockquote><blockquote line="bsp1"><div class="ql-blockquote-item">转载请保留此应用，万分感谢！</div></blockquote><p line="jORu"><br></p><ol data-list-style="decimal"><li class="ordered-item ql-heading-3" line="A3oF" data-list-number="1" data-list-content="1." data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>前言</li></ol><p line="XrV1"><br></p><p line="o1Fs">从零开始搭建一个项目骨架，最好选择合适熟悉的技术，并且在未来易拓展，适合微服务化体系等。所以一般以Springboot作为我们的框架基础，这是离不开的了。</p><p line="B3E2"><br></p><p line="FZnl">然后数据层，我们常用的是Mybatis，易上手，方便维护。但是单表操作比较困难，特别是添加字段或减少字段的时候，比较繁琐，所以这里我推荐使用Mybatis Plus（https://mp.baomidou.com/），为简化开发而生，只需简单配置，即可快速进行 CRUD 操作，从而节省大量时间。</p><p line="cdRE"><br></p><p line="94eM">作为一个项目骨架，权限也是我们不能忽略的，上一个项目<a class="ql-link" href="https://www.bilibili.com/video/BV1PQ4y1P7hZ/?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2NjUxNTkwMDcsImZpbGVHVUlEIjoiT25aRHdveEZGTDhiblAxYyIsImlhdCI6MTY2NTE1ODcwNywiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotNzIyOTE4Nzc3MX0.AhLZ3583HEK7kJAwvXusonzSRo0h-zE4btlUTrVMoBw" target="_blank" rel="noopener noreferrer nofollow">vueblog</a>我们使用了shiro，但是有些同学想学学SpringSecurity，所以这一期我们使用security作为我们的权限控制和会话控制的框架。</p><p line="lMQN"><br></p><p line="9yNJ">考虑到项目可能需要部署多台，一些需要共享的信息就保存在中间件中，Redis是现在主流的缓存中间件，也适合我们的项目。</p><p line="u0eK"><br></p><p line="Kpb1">然后因为前后端分离，所以我们使用jwt作为我们用户身份凭证，并且session我们会禁用，这样以前传统项目使用的方式我们可能就不再适合使用，这点需要注意了。</p><p line="w2KF"><br></p><p line="OOH7">ok，我们现在就开始搭建我们的项目脚手架！</p><p line="Sq5o"><br></p><p line="7Anh">技术栈：</p><ul data-list-style="circle"><li line="7JRt" class="bullet-item">SpringBoot</li></ul><ul data-list-style="circle"><li line="vBsi" class="bullet-item">mybatis plus</li></ul><ul data-list-style="circle"><li line="zJhf" class="bullet-item">spring security</li></ul><ul data-list-style="circle"><li line="A1XJ" class="bullet-item">lombok</li></ul><ul data-list-style="circle"><li line="4JT5" class="bullet-item">redis</li></ul><ul data-list-style="circle"><li line="a6qm" class="bullet-item">hibernate validatior</li></ul><ul data-list-style="circle"><li line="jIFA" class="bullet-item">jwt</li></ul><p line="rRjD"><br></p><ol data-list-style="decimal"><li class="ordered-item ql-heading-3" line="N6OK" data-list-number="2" data-list-content="2." data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>新建springboot项目，注意版本</li></ol><p line="8HUF">这里，我们使用IDEA来开发我们项目，新建步骤比较简单，我们就不截图了。</p><p line="qDI2">开发工具与环境：</p><ul data-list-style="circle"><li line="dbdL" class="bullet-item">idea</li></ul><ul data-list-style="circle"><li line="KdK6" class="bullet-item">mysql</li></ul><ul data-list-style="circle"><li line="evrj" class="bullet-item">jdk 8</li></ul><ul data-list-style="circle"><li line="SjSA" class="bullet-item">maven3.3.9</li></ul><p line="Alu8">新建好的项目结构如下，SpringBoot版本使用的目前最新的2.4.0版本</p><p line="3MaW"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="709" height="auto" ori-width="709" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image.png" style="" ori-height="515" data-src="https://uploader.shimo.im/f/I5q7iP24vltvyLBq.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="Udph"><br></p><p line="PQlv"><br></p><p line="77DD"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="955" height="auto" ori-width="955" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(1).png" style="" ori-height="433" data-src="https://uploader.shimo.im/f/fucXJirXJAjJeY0w.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="Gfsi"><br></p><p line="tyax"><br></p><p line="9hmg">pom的jar包导入如下：</p><div class="ql-code-block-container" data-language="" spellcheck="false"><span class="sm-docs-syntax-language">自动检测</span><div line="pB0m" class="ql-code-block">&lt;parent&gt;</div><div line="3mem" class="ql-code-block">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div line="bMjA" class="ql-code-block">    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;</div><div line="Qliy" class="ql-code-block">    &lt;version&gt;2.4.0&lt;/version&gt;</div><div line="f7hf" class="ql-code-block">    &lt;relativePath/&gt;</div><div line="ZbHg" class="ql-code-block">&lt;/parent&gt;</div><div line="jmM0" class="ql-code-block">&lt;groupId&gt;com.markerhub&lt;/groupId&gt;</div><div line="XJz7" class="ql-code-block">&lt;artifactId&gt;vueadmin-java&lt;/artifactId&gt;</div><div line="MGy6" class="ql-code-block">&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;</div><div line="nn4K" class="ql-code-block">&lt;name&gt;vueadmin-java&lt;/name&gt;</div><div line="Ruhn" class="ql-code-block">&lt;description&gt;公众号：MarkerHub&lt;/description&gt;</div><div line="ToAr" class="ql-code-block">&lt;properties&gt;</div><div line="L8Ix" class="ql-code-block">    &lt;java.version&gt;1.8&lt;/java.version&gt;</div><div line="w5eW" class="ql-code-block">&lt;/properties&gt;</div><div line="4ofG" class="ql-code-block"><br></div><div line="dpqd" class="ql-code-block">&lt;dependencies&gt;</div><div line="FlHV" class="ql-code-block">    &lt;dependency&gt;</div><div line="H52K" class="ql-code-block">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div line="BXJe" class="ql-code-block">        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;</div><div line="IW5Y" class="ql-code-block">    &lt;/dependency&gt;</div><div line="JUMc" class="ql-code-block">    &lt;dependency&gt;</div><div line="MTME" class="ql-code-block">        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div line="glAk" class="ql-code-block">        &lt;artifactId&gt;spring-boot-devtools&lt;/artifactId&gt;</div><div line="AiLq" class="ql-code-block">        &lt;scope&gt;runtime&lt;/scope&gt;</div><div line="p53S" class="ql-code-block">        &lt;optional&gt;true&lt;/optional&gt;</div><div line="oIKf" class="ql-code-block">    &lt;/dependency&gt;</div><div line="xLRQ" class="ql-code-block">    &lt;dependency&gt;</div><div line="857T" class="ql-code-block">        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;</div><div line="JwoD" class="ql-code-block">        &lt;artifactId&gt;lombok&lt;/artifactId&gt;</div><div line="FTSe" class="ql-code-block">        &lt;optional&gt;true&lt;/optional&gt;</div><div line="TipS" class="ql-code-block">    &lt;/dependency&gt;</div><div line="1jrs" class="ql-code-block">&lt;/dependencies&gt;</div></div><ul data-list-style="circle"><li line="GToV" class="bullet-item">devtools：项目的热加载重启插件</li></ul><ul data-list-style="circle"><li line="WkGq" class="bullet-item">lombok：简化代码的工具</li></ul><p line="3hut"><br></p><ol data-list-style="decimal"><li class="ordered-item ql-heading-3" line="H7fj" data-list-number="3" data-list-content="3." data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>整合mybatis plus，生成代码</li></ol><p line="8TRx"><br></p><p line="UtYk">接下来，我们来整合mybatis plus，让项目能完成基本的增删改查操作。步骤很简单：可以去官网看看：<a class="ql-link" href="https://mp.baomidou.com/guide/?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2NjUxNTkwMDcsImZpbGVHVUlEIjoiT25aRHdveEZGTDhiblAxYyIsImlhdCI6MTY2NTE1ODcwNywiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotNzIyOTE4Nzc3MX0.AhLZ3583HEK7kJAwvXusonzSRo0h-zE4btlUTrVMoBw" target="_blank" rel="noopener noreferrer nofollow">https://mp.baomidou.com/guide/</a></p><p line="NVj5"><br></p><h4><div line="47x9" data-header="4" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><strong>第一步：导入jar包</strong></div></h4><p line="Unnf">pom中导入mybatis plus的jar包，因为后面会涉及到代码生成，所以我们还需要导入页面模板引擎，这里我们用的是freemarker。</p><div class="ql-code-block-container" data-language="" spellcheck="false"><span class="sm-docs-syntax-language">自动检测</span><div line="zSap" class="ql-code-block">&lt;!--整合mybatis plus https://baomidou.com/--&gt;</div><div line="KpzX" class="ql-code-block">&lt;dependency&gt;</div><div line="RRko" class="ql-code-block">    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;</div><div line="Vxyo" class="ql-code-block">    &lt;artifactId&gt;mybatis-plus-boot-starter&lt;/artifactId&gt;</div><div line="vCsx" class="ql-code-block">    &lt;version&gt;3.4.1&lt;/version&gt;</div><div line="Slln" class="ql-code-block">&lt;/dependency&gt;</div><div line="QpIz" class="ql-code-block">&lt;!--mp代码生成器--&gt;</div><div line="rXol" class="ql-code-block">&lt;dependency&gt;</div><div line="93se" class="ql-code-block">    &lt;groupId&gt;com.baomidou&lt;/groupId&gt;</div><div line="mDoY" class="ql-code-block">    &lt;artifactId&gt;mybatis-plus-generator&lt;/artifactId&gt;</div><div line="5yD6" class="ql-code-block">    &lt;version&gt;3.4.1&lt;/version&gt;</div><div line="ciOA" class="ql-code-block">&lt;/dependency&gt;</div><div line="rDZl" class="ql-code-block">&lt;dependency&gt;</div><div line="5FEa" class="ql-code-block">    &lt;groupId&gt;org.freemarker&lt;/groupId&gt;</div><div line="SMHD" class="ql-code-block">    &lt;artifactId&gt;freemarker&lt;/artifactId&gt;</div><div line="3MJf" class="ql-code-block">    &lt;version&gt;2.3.30&lt;/version&gt;</div><div line="2e2y" class="ql-code-block">&lt;/dependency&gt;</div><div line="aEmY" class="ql-code-block">&lt;dependency&gt;</div><div line="lqbT" class="ql-code-block">    &lt;groupId&gt;mysql&lt;/groupId&gt;</div><div line="9ueQ" class="ql-code-block">    &lt;artifactId&gt;mysql-connector-java&lt;/artifactId&gt;</div><div line="otc2" class="ql-code-block">    &lt;scope&gt;runtime&lt;/scope&gt;</div><div line="ipQv" class="ql-code-block">&lt;/dependency&gt;</div></div><p line="WW5a"><br></p><h4><div line="a2kf" data-header="4" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><strong>第二步：然后去写配置文件</strong></div></h4><div class="ql-code-block-container" data-language="" spellcheck="false"><span class="sm-docs-syntax-language">自动检测</span><div line="4jPG" class="ql-code-block">server:</div><div line="350h" class="ql-code-block">  port: 8081</div><div line="yWvg" class="ql-code-block"># DataSource Config</div><div line="oI9a" class="ql-code-block">spring:</div><div line="iJhe" class="ql-code-block">  datasource:</div><div line="0LUa" class="ql-code-block">    driver-class-name: com.mysql.cj.jdbc.Driver</div><div line="uoy4" class="ql-code-block">    url: jdbc:mysql://localhost:3306/vueadmin?useUnicode=true&amp;useSSL=false&amp;characterEncoding=utf8&amp;serverTimezone=Asia/Shanghai</div><div line="iTQq" class="ql-code-block">    username: root</div><div line="kTBV" class="ql-code-block">    password: admin</div><div line="P2Yn" class="ql-code-block">mybatis-plus:</div><div line="xwkW" class="ql-code-block">  mapper-locations: classpath*:/mapper/**Mapper.xml</div></div><p line="uSH6">上面除了配置数据库的信息，还配置了myabtis plus的mapper的xml文件的扫描路径，这一步不要忘记了。然后因为前段默认是8080端口了，所以后端我们设置为8081端口，防止端口冲突。</p><p line="zK4Q"><br></p><h4><div line="m5WG" data-header="4" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><strong>第三步：开启mapper接口扫描，添加分页、防全表更新插件</strong></div></h4><p line="jUmv">新建一个包：通过@mapperScan注解指定要变成实现类的接口所在的包，然后包下面的所有接口在编译之后都会生成相应的实现类。</p><ul data-list-style="circle"><li line="MuHL" class="bullet-item">com.markerhub.config.MybatisPlusConfig</li></ul><div class="ql-code-block-container" data-language="" spellcheck="false"><span class="sm-docs-syntax-language">自动检测</span><div line="aWla" class="ql-code-block">@Configuration</div><div line="qKF2" class="ql-code-block">@MapperScan("com.markerhub.mapper")</div><div line="VS6F" class="ql-code-block">public class MybatisPlusConfig {</div><div line="JgBm" class="ql-code-block">   /**</div><div line="Ksf4" class="ql-code-block">    * 新的分页插件,一缓和二缓遵循mybatis的规则,</div><div line="lLfT" class="ql-code-block">    * 需要设置 MybatisConfiguration#useDeprecatedExecutor = false</div><div line="2jGP" class="ql-code-block">    * 避免缓存出现问题(该属性会在旧插件移除后一同移除)</div><div line="Ndoq" class="ql-code-block">    */</div><div line="7ruW" class="ql-code-block">   @Bean</div><div line="DMiX" class="ql-code-block">   public MybatisPlusInterceptor mybatisPlusInterceptor() {</div><div line="23VX" class="ql-code-block">      MybatisPlusInterceptor interceptor = new MybatisPlusInterceptor();</div><div line="Gcmz" class="ql-code-block">      interceptor.addInnerInterceptor(new PaginationInnerInterceptor(DbType.MYSQL));</div><div line="20ii" class="ql-code-block">      // 防止全表更新和删除</div><div line="w09p" class="ql-code-block">      interceptor.addInnerInterceptor(new BlockAttackInnerInterceptor());</div><div line="fMjT" class="ql-code-block">      return interceptor;</div><div line="jXOQ" class="ql-code-block">   }</div><div line="4yDg" class="ql-code-block">   @Bean</div><div line="P1He" class="ql-code-block">   public ConfigurationCustomizer configurationCustomizer() {</div><div line="HMIM" class="ql-code-block">      return configuration -&gt; configuration.setUseDeprecatedExecutor(false);</div><div line="KlL4" class="ql-code-block">   }</div><div line="N8W8" class="ql-code-block">}</div></div><p line="F4NP">上面代码中，我们给Mybatis plus添加了2个拦截器，这是根据mp官网配置的：</p><ul data-list-style="circle"><li line="X7NK" class="bullet-item">PaginationInnerInterceptor：新的分页插件</li></ul><ul data-list-style="circle"><li line="BfQh" class="bullet-item">BlockAttackInnerInterceptor：防止全表更新和删除</li></ul><p line="46mg"><br></p><h4><div line="ZxMf" data-header="4" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>第四步：创建数据库和表</div></h4><p line="dNOq">因为是后台管理系统的权限模块，所以我们需要考虑的表主要就几个：用户表、角色表、菜单权限表、以及关联的用户角色中间表、菜单角色中间表。就5个表，至于什么字段其实都听随意的，用户表里面除了用户名、密码字段必要，其他其实都听随意，然后角色和菜单我们可以参考一下其他的系统、或者自己在做项目的过程中需要的时候在添加也行，反正重新生成代码也是非常简便的事情，综合考虑，数据库名称为vueadmin，我们建表语句如下：</p><ul data-list-style="circle"><li line="ekIz" class="bullet-item">vueadmin.sql</li></ul><ul data-list-style="circle"><li line="Xji4" class="bullet-item"><a class="ql-link" href="https://gitee.com/markerhub/VueAdmin/blob/master/vueadmin-java/%E6%95%B0%E6%8D%AE%E5%BA%93%E8%84%9A%E6%9C%AC%20-%20vueadmin.sql?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2NjUxNTkwMDcsImZpbGVHVUlEIjoiT25aRHdveEZGTDhiblAxYyIsImlhdCI6MTY2NTE1ODcwNywiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotNzIyOTE4Nzc3MX0.AhLZ3583HEK7kJAwvXusonzSRo0h-zE4btlUTrVMoBw" target="_blank" rel="noopener noreferrer nofollow">vueadmin-java/数据库脚本 - vueadmin.sql · MarkerHub/VueAdmin - Gitee.com</a></li></ul><ul data-list-style="circle"><li line="6HAw" class="bullet-item">用户名/密码  admin/111111    test/1234567</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="9Eji" data-language="plain" class="ql-code-block">/*</div><div line="NqXo" data-language="plain" class="ql-code-block">Navicat MySQL Data Transfer</div><div line="zr3H" data-language="plain" class="ql-code-block"><br></div><div line="yPy9" data-language="plain" class="ql-code-block">Source Server&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: localhost</div><div line="xuBO" data-language="plain" class="ql-code-block">Source Server Version : 50717</div><div line="lhfh" data-language="plain" class="ql-code-block">Source Host&nbsp; &nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: localhost:3306</div><div line="mDmH" data-language="plain" class="ql-code-block">Source Database&nbsp; &nbsp; &nbsp; &nbsp;: vueadmin</div><div line="GHBk" data-language="plain" class="ql-code-block"><br></div><div line="04QJ" data-language="plain" class="ql-code-block">Target Server Type&nbsp; &nbsp; : MYSQL</div><div line="98ln" data-language="plain" class="ql-code-block">Target Server Version : 50717</div><div line="Zpch" data-language="plain" class="ql-code-block">File Encoding&nbsp; &nbsp; &nbsp; &nbsp; &nbsp;: 65001</div><div line="1HYG" data-language="plain" class="ql-code-block"><br></div><div line="prP8" data-language="plain" class="ql-code-block">Date: 2021-01-23 09:41:50</div><div line="0RWs" data-language="plain" class="ql-code-block">*/</div><div line="yhNn" data-language="plain" class="ql-code-block"><br></div><div line="whFK" data-language="plain" class="ql-code-block">SET FOREIGN_KEY_CHECKS=0;</div><div line="U0nV" data-language="plain" class="ql-code-block"><br></div><div line="GfcZ" data-language="plain" class="ql-code-block">-- ----------------------------</div><div line="3lFp" data-language="plain" class="ql-code-block">-- Table structure for sys_menu</div><div line="ljCh" data-language="plain" class="ql-code-block">-- ----------------------------</div><div line="jCwI" data-language="plain" class="ql-code-block">DROP TABLE IF EXISTS `sys_menu`;</div><div line="KWqU" data-language="plain" class="ql-code-block">CREATE TABLE `sys_menu` (</div><div line="Maa3" data-language="plain" class="ql-code-block">&nbsp; `id` bigint(20) NOT NULL AUTO_INCREMENT,</div><div line="YP7q" data-language="plain" class="ql-code-block">&nbsp; `parent_id` bigint(20) DEFAULT NULL COMMENT '父菜单ID，一级菜单为0',</div><div line="MleT" data-language="plain" class="ql-code-block">&nbsp; `name` varchar(64) NOT NULL,</div><div line="xajr" data-language="plain" class="ql-code-block">&nbsp; `path` varchar(255) DEFAULT NULL COMMENT '菜单URL',</div><div line="OD9v" data-language="plain" class="ql-code-block">&nbsp; `perms` varchar(255) DEFAULT NULL COMMENT '授权(多个用逗号分隔，如：user:list,user:create)',</div><div line="97sy" data-language="plain" class="ql-code-block">&nbsp; `component` varchar(255) DEFAULT NULL,</div><div line="Zc7M" data-language="plain" class="ql-code-block">&nbsp; `type` int(5) NOT NULL COMMENT '类型&nbsp; &nbsp; &nbsp;0：目录&nbsp; &nbsp;1：菜单&nbsp; &nbsp;2：按钮',</div><div line="sZau" data-language="plain" class="ql-code-block">&nbsp; `icon` varchar(32) DEFAULT NULL COMMENT '菜单图标',</div><div line="DMx0" data-language="plain" class="ql-code-block">&nbsp; `orderNum` int(11) DEFAULT NULL COMMENT '排序',</div><div line="ZnQ7" data-language="plain" class="ql-code-block">&nbsp; `created` datetime NOT NULL,</div><div line="Wbpt" data-language="plain" class="ql-code-block">&nbsp; `updated` datetime DEFAULT NULL,</div><div line="VyHA" data-language="plain" class="ql-code-block">&nbsp; `statu` int(5) NOT NULL,</div><div line="nJg0" data-language="plain" class="ql-code-block">&nbsp; PRIMARY KEY (`id`),</div><div line="EQqt" data-language="plain" class="ql-code-block">&nbsp; UNIQUE KEY `name` (`name`) USING BTREE</div><div line="80Cz" data-language="plain" class="ql-code-block">) ENGINE=InnoDB AUTO_INCREMENT=21 DEFAULT CHARSET=utf8;</div><div line="hRk3" data-language="plain" class="ql-code-block"><br></div><div line="jxT2" data-language="plain" class="ql-code-block">-- ----------------------------</div><div line="ULrS" data-language="plain" class="ql-code-block">-- Table structure for sys_role</div><div line="ifnJ" data-language="plain" class="ql-code-block">-- ----------------------------</div><div line="XEQH" data-language="plain" class="ql-code-block">DROP TABLE IF EXISTS `sys_role`;</div><div line="ESp4" data-language="plain" class="ql-code-block">CREATE TABLE `sys_role` (</div><div line="EHLh" data-language="plain" class="ql-code-block">&nbsp; `id` bigint(20) NOT NULL AUTO_INCREMENT,</div><div line="GJro" data-language="plain" class="ql-code-block">&nbsp; `name` varchar(64) NOT NULL,</div><div line="J0O8" data-language="plain" class="ql-code-block">&nbsp; `code` varchar(64) NOT NULL,</div><div line="sfZH" data-language="plain" class="ql-code-block">&nbsp; `remark` varchar(64) DEFAULT NULL COMMENT '备注',</div><div line="nUZP" data-language="plain" class="ql-code-block">&nbsp; `created` datetime DEFAULT NULL,</div><div line="VGv7" data-language="plain" class="ql-code-block">&nbsp; `updated` datetime DEFAULT NULL,</div><div line="XhWz" data-language="plain" class="ql-code-block">&nbsp; `statu` int(5) NOT NULL,</div><div line="RVmd" data-language="plain" class="ql-code-block">&nbsp; PRIMARY KEY (`id`),</div><div line="LPv1" data-language="plain" class="ql-code-block">&nbsp; UNIQUE KEY `name` (`name`) USING BTREE,</div><div line="lGl9" data-language="plain" class="ql-code-block">&nbsp; UNIQUE KEY `code` (`code`) USING BTREE</div><div line="tZCX" data-language="plain" class="ql-code-block">) ENGINE=InnoDB AUTO_INCREMENT=8 DEFAULT CHARSET=utf8;</div><div line="jovZ" data-language="plain" class="ql-code-block"><br></div><div line="AtrC" data-language="plain" class="ql-code-block">-- ----------------------------</div><div line="AH6A" data-language="plain" class="ql-code-block">-- Table structure for sys_role_menu</div><div line="9HD9" data-language="plain" class="ql-code-block">-- ----------------------------</div><div line="7D0e" data-language="plain" class="ql-code-block">DROP TABLE IF EXISTS `sys_role_menu`;</div><div line="teUr" data-language="plain" class="ql-code-block">CREATE TABLE `sys_role_menu` (</div><div line="xua0" data-language="plain" class="ql-code-block">&nbsp; `id` bigint(20) NOT NULL AUTO_INCREMENT,</div><div line="tt66" data-language="plain" class="ql-code-block">&nbsp; `role_id` bigint(20) NOT NULL,</div><div line="xyc9" data-language="plain" class="ql-code-block">&nbsp; `menu_id` bigint(20) NOT NULL,</div><div line="jLRO" data-language="plain" class="ql-code-block">&nbsp; PRIMARY KEY (`id`)</div><div line="PpCe" data-language="plain" class="ql-code-block">) ENGINE=InnoDB AUTO_INCREMENT=102 DEFAULT CHARSET=utf8mb4;</div><div line="6HEg" data-language="plain" class="ql-code-block"><br></div><div line="3WXt" data-language="plain" class="ql-code-block">-- ----------------------------</div><div line="9W0F" data-language="plain" class="ql-code-block">-- Table structure for sys_user</div><div line="jGoH" data-language="plain" class="ql-code-block">-- ----------------------------</div><div line="gmsj" data-language="plain" class="ql-code-block">DROP TABLE IF EXISTS `sys_user`;</div><div line="8nXz" data-language="plain" class="ql-code-block">CREATE TABLE `sys_user` (</div><div line="WoJW" data-language="plain" class="ql-code-block">&nbsp; `id` bigint(20) NOT NULL AUTO_INCREMENT,</div><div line="m242" data-language="plain" class="ql-code-block">&nbsp; `username` varchar(64) DEFAULT NULL,</div><div line="iUHx" data-language="plain" class="ql-code-block">&nbsp; `password` varchar(64) DEFAULT NULL,</div><div line="HNXh" data-language="plain" class="ql-code-block">&nbsp; `avatar` varchar(255) DEFAULT NULL,</div><div line="goH6" data-language="plain" class="ql-code-block">&nbsp; `email` varchar(64) DEFAULT NULL,</div><div line="H2bj" data-language="plain" class="ql-code-block">&nbsp; `city` varchar(64) DEFAULT NULL,</div><div line="T0xQ" data-language="plain" class="ql-code-block">&nbsp; `created` datetime DEFAULT NULL,</div><div line="W3rV" data-language="plain" class="ql-code-block">&nbsp; `updated` datetime DEFAULT NULL,</div><div line="Wn4u" data-language="plain" class="ql-code-block">&nbsp; `last_login` datetime DEFAULT NULL,</div><div line="Ygfr" data-language="plain" class="ql-code-block">&nbsp; `statu` int(5) NOT NULL,</div><div line="ATCq" data-language="plain" class="ql-code-block">&nbsp; PRIMARY KEY (`id`),</div><div line="Otqk" data-language="plain" class="ql-code-block">&nbsp; UNIQUE KEY `UK_USERNAME` (`username`) USING BTREE</div><div line="siwQ" data-language="plain" class="ql-code-block">) ENGINE=InnoDB AUTO_INCREMENT=7 DEFAULT CHARSET=utf8;</div><div line="14KR" data-language="plain" class="ql-code-block"><br></div><div line="NoXQ" data-language="plain" class="ql-code-block">-- ----------------------------</div><div line="NqV3" data-language="plain" class="ql-code-block">-- Table structure for sys_user_role</div><div line="lT3c" data-language="plain" class="ql-code-block">-- ----------------------------</div><div line="eCR5" data-language="plain" class="ql-code-block">DROP TABLE IF EXISTS `sys_user_role`;</div><div line="eRmD" data-language="plain" class="ql-code-block">CREATE TABLE `sys_user_role` (</div><div line="BzA8" data-language="plain" class="ql-code-block">&nbsp; `id` bigint(20) NOT NULL AUTO_INCREMENT,</div><div line="VQpZ" data-language="plain" class="ql-code-block">&nbsp; `user_id` bigint(20) NOT NULL,</div><div line="QHrC" data-language="plain" class="ql-code-block">&nbsp; `role_id` bigint(20) NOT NULL,</div><div line="2n3k" data-language="plain" class="ql-code-block">&nbsp; PRIMARY KEY (`id`)</div><div line="fzZ7" data-language="plain" class="ql-code-block">) ENGINE=InnoDB AUTO_INCREMENT=15 DEFAULT CHARSET=utf8mb4;</div><div line="8KOG" data-language="plain" class="ql-code-block"><br></div></div><p line="JTTi"><br></p><h4><div line="AUyV" data-header="4" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><strong>第五步：代码生成</strong></div></h4><ol data-list-style="decimal"><li line="fxYv" data-list-number="1" data-list-content="1." class="ordered-item">获取项目数据库所对应表和字段的信息</li></ol><ol data-list-style="decimal"><li line="UqoE" data-list-number="2" data-list-content="2." class="ordered-item">新建一个freemarker的页面模板 - SysUser.java.ftl - ${baseEntity}</li></ol><ol data-list-style="decimal"><li line="ZIau" data-list-number="3" data-list-content="3." class="ordered-item">提供相关需要进行渲染的动态数据 - BaseEntity、表字段、注释、baseEntity=SuperEntity</li></ol><ol data-list-style="decimal"><li line="rmNB" data-list-number="4" data-list-content="4." class="ordered-item">使用freemarker模板引擎进行渲染！ - SysUser.java</li></ol><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="x15X" data-language="plain" class="ql-code-block"># 获取表</div><div line="uUpV" data-language="plain" class="ql-code-block">SELECT</div><div line="Vaap" data-language="plain" class="ql-code-block">	*</div><div line="JNKJ" data-language="plain" class="ql-code-block">FROM</div><div line="eSOM" data-language="plain" class="ql-code-block">	information_schema. TABLES</div><div line="PLay" data-language="plain" class="ql-code-block">WHERE</div><div line="cJA0" data-language="plain" class="ql-code-block">	TABLE_SCHEMA = (SELECT DATABASE());</div><div line="67dt" data-language="plain" class="ql-code-block"><br></div><div line="7BHH" data-language="plain" class="ql-code-block"># 获取字段</div><div line="0K22" data-language="plain" class="ql-code-block">SELECT</div><div line="vgBg" data-language="plain" class="ql-code-block">	*</div><div line="oNJU" data-language="plain" class="ql-code-block">FROM</div><div line="nSdD" data-language="plain" class="ql-code-block">	information_schema. COLUMNS</div><div line="ZORt" data-language="plain" class="ql-code-block">WHERE</div><div line="4V3p" data-language="plain" class="ql-code-block">	TABLE_SCHEMA = (SELECT DATABASE())</div><div line="HiOp" data-language="plain" class="ql-code-block">AND TABLE_NAME = "sys_user";</div></div><p line="NbPg">有了数据库之后，那么现在就已经可以使用mybatis plus了，官方给我们提供了一个代码生成器，然后我写上自己的参数之后，就可以直接根据数据库表信息生成entity、service、mapper等接口和实现类。</p><p line="hmVl">因为代码比较长，就不贴出来了，说明一下重点：</p><ul data-list-style="circle"><li line="m5b8" class="bullet-item">com.markerhub.CodeGenerator</li></ul><p line="UdQ7"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="727" height="auto" ori-width="727" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(2).png" style="" ori-height="412" data-src="https://uploader.shimo.im/f/tKZTVY4AOjPZmAlw.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="7K2D"><br></p><p line="MT4c">上面代码生成的过程中，我默认所有的实体类都继承BaseEntity，控制器都继承BaseController，所以在代码生成之前，最好先编写这两个基类：</p><ul data-list-style="circle"><li line="6mAB" class="bullet-item">com.markerhub.entity.BaseEntity</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="MJAl" data-language="plain" class="ql-code-block">@Data</div><div line="VflU" data-language="plain" class="ql-code-block">public class BaseEntity implements Serializable {</div><div line="Bswh" data-language="plain" class="ql-code-block">   @TableId(value = "id", type = IdType.AUTO)</div><div line="d1D1" data-language="plain" class="ql-code-block">   private Long id;</div><div line="dCir" data-language="plain" class="ql-code-block">   private LocalDateTime created;</div><div line="UDyr" data-language="plain" class="ql-code-block">   private LocalDateTime updated;</div><div line="dUmD" data-language="plain" class="ql-code-block">   private Integer statu;</div><div line="d0aL" data-language="plain" class="ql-code-block">}</div></div><ul data-list-style="circle"><li line="yGtY" class="bullet-item">com.markerhub.controller.BaseController</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="MY3R" data-language="plain" class="ql-code-block">public class BaseController {</div><div line="uvcF" data-language="plain" class="ql-code-block">   @Autowired</div><div line="1q0e" data-language="plain" class="ql-code-block">   HttpServletRequest req;</div><div line="58TU" data-language="plain" class="ql-code-block">}</div></div><p line="VDYP">然后我们单独运行CodeGenerator的main方法，注意调整CodeGenerator的数据库连接、账号密码啥的，然后我们输入表名称，通过逗号隔开：sys_menu,sys_role,sys_role_menu,sys_user,sys_user_role</p><p line="qaO8"><br></p><p line="t6Pd">执行结果成功：</p><p line="5k0y"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="546" height="auto" ori-width="546" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(3).png" style="" ori-height="84" data-src="https://uploader.shimo.im/f/Hjmb8PXNXGNF8WJr.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="2zxR"><br></p><p line="IWO3">然后我们生成了一些代码如下：</p><p line="7WBf"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="400" height="auto" ori-width="400" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(4).png" style="" ori-height="874" data-src="https://uploader.shimo.im/f/RYK63O3K3yYZd7Rd.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="UgbV"><br></p><p line="nd04">这里有点需要注意，因为关联的用户角色中间表、菜单角色中间表我们是没有created等几个公共字段的，所以我们把这两个实体继承BaseEntity去掉：</p><p line="oTCW"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="525" height="auto" ori-width="525" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(5).png" style="" ori-height="289" data-src="https://uploader.shimo.im/f/MPDZk5fYnSq5F12z.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="rosu">最后这样子的：</p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="45AA" data-language="plain" class="ql-code-block">@Data</div><div line="r2bm" data-language="plain" class="ql-code-block">public class SysRoleMenu {</div><div line="YfYS" data-language="plain" class="ql-code-block">   ...</div><div line="jj0N" data-language="plain" class="ql-code-block">}</div></div><p line="Dgr8">简洁！方便！经过上面的步骤，基本上我们已经把mybatis plus框架集成到项目中了，并且也生成了基本的代码，省了好多功夫。然后我们做个简单测试：</p><ul data-list-style="circle"><li line="EhBS" class="bullet-item">com.markerhub.controller.TestController</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="hfXn" data-language="plain" class="ql-code-block">@RestController</div><div line="wTdU" data-language="plain" class="ql-code-block">public class TestController {</div><div line="BpVy" data-language="plain" class="ql-code-block">   @Autowired</div><div line="GSE2" data-language="plain" class="ql-code-block">   SysUserService userService;</div><div line="S0eC" data-language="plain" class="ql-code-block">   @GetMapping("/test")</div><div line="pwEm" data-language="plain" class="ql-code-block">   public Object test() {</div><div line="jV3G" data-language="plain" class="ql-code-block">      return userService.list();</div><div line="gK77" data-language="plain" class="ql-code-block">   }</div><div line="91sU" data-language="plain" class="ql-code-block">}</div></div><p line="upRq">然后sys_user随意添加几条数据，结果如下：</p><p line="gk0d"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="602" height="auto" ori-width="602" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(6).png" style="" ori-height="351" data-src="https://uploader.shimo.im/f/kkurekFGgkDmgyDp.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="ikaU"><br></p><p line="mVMF">ok，毛什么问题，大家不用在意密码是怎么生成的，后面我们会说到，你现在随意填写就好了。对了，好多人问我的浏览器的json数据怎么显示这么好看，这是因为我用了JSONView这个插件：</p><p line="DIDF"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="300" height="auto" ori-width="300" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(7).png" style="" ori-height="43" data-src="https://uploader.shimo.im/f/OiZChHuhpAHGVf5n.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="Bqix"><br></p><ol data-list-style="decimal"><li class="ordered-item ql-heading-3" line="EA4M" data-list-number="4" data-list-content="4." data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>结果封装</li></ol><p line="GnWC">因为是前后端分离的项目，所以我们有必要统一一个结果返回封装类，这样前后端交互的时候有个统一的标准，约定结果返回的数据是正常的或者遇到异常了。</p><p line="V4Nl"><br></p><p line="pKhh">这里我们用到了一个Result的类，这个用于我们的异步统一返回的结果封装。一般来说，结果里面有几个要素必要的</p><ul data-list-style="circle"><li line="FCUR" class="bullet-item">是否成功，可用code表示（如200表示成功，400表示异常）</li></ul><ul data-list-style="circle"><li line="ytHr" class="bullet-item">结果消息</li></ul><ul data-list-style="circle"><li line="ts1J" class="bullet-item">结果数据</li></ul><p line="06g8"><br></p><p line="BSSa">所以可得到封装如下：</p><ul data-list-style="circle"><li line="qGkZ" class="bullet-item">com.markerhub.common.lang.Result</li></ul><div class="ql-code-block-container" data-language="" spellcheck="false"><span class="sm-docs-syntax-language">自动检测</span><div line="nnxV" class="ql-code-block">@Data</div><div line="OnJs" class="ql-code-block">public class Result implements Serializable {</div><div line="Dx7d" class="ql-code-block"><br></div><div line="hkgX" class="ql-code-block">    private int code; // 200是正常，非200表示异常</div><div line="vcKR" class="ql-code-block">    private String msg;</div><div line="ekzd" class="ql-code-block">    private Object data;</div><div line="ICyT" class="ql-code-block">    </div><div line="bIxq" class="ql-code-block">    public static Result succ(Object data) {</div><div line="xW3f" class="ql-code-block">        return succ(200, "操作成功", data);</div><div line="MmNk" class="ql-code-block">    }</div><div line="qTrb" class="ql-code-block">    public static Result succ(int code, String msg, Object data) {</div><div line="Wx8e" class="ql-code-block">        Result r = new Result();</div><div line="Jt8s" class="ql-code-block">        r.setCode(code);</div><div line="Ithz" class="ql-code-block">        r.setMsg(msg);</div><div line="9Vdt" class="ql-code-block">        r.setData(data);</div><div line="1H7P" class="ql-code-block">        return r;</div><div line="6Eno" class="ql-code-block">    }</div><div line="GHsq" class="ql-code-block">    public static Result fail(String msg) {</div><div line="7QK7" class="ql-code-block">        return fail(400, msg, null);</div><div line="RHbT" class="ql-code-block">    }</div><div line="WFsa" class="ql-code-block">    public static Result fail(String msg, Object data) {</div><div line="16Hj" class="ql-code-block">        return fail(400, msg, data);</div><div line="sL8h" class="ql-code-block">    }</div><div line="Jhg9" class="ql-code-block">    public static Result fail(int code, String msg, Object data) {</div><div line="9kVN" class="ql-code-block">        Result r = new Result();</div><div line="nuu5" class="ql-code-block">        r.setCode(code);</div><div line="inZF" class="ql-code-block">        r.setMsg(msg);</div><div line="PFyR" class="ql-code-block">        r.setData(data);</div><div line="Bcnc" class="ql-code-block">        return r;</div><div line="jn2N" class="ql-code-block">    }</div><div line="uYts" class="ql-code-block">}</div></div><p line="bbJs">另外出了在结果封装类上的code可以提现数据是否正常，我们还可以通过http的状态码来提现访问是否遇到了异常，比如401表示五权限拒绝访问等，注意灵活使用。</p><p line="PhCt"><br></p><ol data-list-style="decimal"><li class="ordered-item ql-heading-3" line="6Pds" data-list-number="5" data-list-content="5." data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>全局异常处理</li></ol><p line="5sih">有时候不可避免服务器报错的情况，如果不配置异常处理机制，就会默认返回tomcat或者nginx的5XX页面，对普通用户来说，不太友好，用户也不懂什么情况。这时候需要我们程序员设计返回一个友好简单的格式给前端。</p><p line="naoX"><br></p><p line="HIyc">处理办法如下：通过使用@ControllerAdvice来进行统一异常处理，@ExceptionHandler(value = RuntimeException.class)来指定捕获的Exception各个类型异常 ，这个异常的处理，是全局的，所有类似的异常，都会跑到这个地方处理。</p><p line="oGEP"><br></p><p line="wWSa">步骤二、定义全局异常处理，@ControllerAdvice表示定义全局控制器异常处理，@ExceptionHandler表示针对性异常处理，可对每种异常针对性处理。</p><p line="rVJi"><br></p><ul data-list-style="circle"><li line="h1mS" class="bullet-item">com.markerhub.common.exception.GlobalExceptionHandler</li></ul><div class="ql-code-block-container" data-language="" spellcheck="false"><span class="sm-docs-syntax-language">自动检测</span><div line="UDwP" class="ql-code-block">/**</div><div line="Mj3O" class="ql-code-block"> * 全局异常处理</div><div line="omRN" class="ql-code-block"> */</div><div line="GT7z" class="ql-code-block">@Slf4j</div><div line="I5l6" class="ql-code-block">@RestControllerAdvice</div><div line="MMnS" class="ql-code-block">public class GlobalExceptionHandler {</div><div line="mubp" class="ql-code-block"><br></div><div line="BM4W" class="ql-code-block">    @ResponseStatus(HttpStatus.FORBIDDEN)</div><div line="fmkn" class="ql-code-block">    @ExceptionHandler(value = AccessDeniedException.class)</div><div line="FIxq" class="ql-code-block">    public Result handler(AccessDeniedException e) {</div><div line="XSaM" class="ql-code-block">        log.info("security权限不足：----------------{}", e.getMessage());</div><div line="fwJT" class="ql-code-block">        return Result.fail("权限不足");</div><div line="p6jP" class="ql-code-block">    }</div><div line="QAdv" class="ql-code-block">    </div><div line="8C3E" class="ql-code-block">    @ResponseStatus(HttpStatus.BAD_REQUEST)</div><div line="MAiM" class="ql-code-block">    @ExceptionHandler(value = MethodArgumentNotValidException.class)</div><div line="7Zk7" class="ql-code-block">    public Result handler(MethodArgumentNotValidException e) {</div><div line="s281" class="ql-code-block">        log.info("实体校验异常：----------------{}", e.getMessage());</div><div line="3ybI" class="ql-code-block">        BindingResult bindingResult = e.getBindingResult();</div><div line="oSXt" class="ql-code-block">        ObjectError objectError = bindingResult.getAllErrors().stream().findFirst().get();</div><div line="ucxQ" class="ql-code-block">        return Result.fail(objectError.getDefaultMessage());</div><div line="6bC7" class="ql-code-block">    }</div><div line="Mdjp" class="ql-code-block">    </div><div line="Bjmr" class="ql-code-block">    @ResponseStatus(HttpStatus.BAD_REQUEST)</div><div line="PkMc" class="ql-code-block">    @ExceptionHandler(value = IllegalArgumentException.class)</div><div line="nUpl" class="ql-code-block">    public Result handler(IllegalArgumentException e) {</div><div line="cGWM" class="ql-code-block">        log.error("Assert异常：----------------{}", e.getMessage());</div><div line="WQPQ" class="ql-code-block">        return Result.fail(e.getMessage());</div><div line="BP7n" class="ql-code-block">    }</div><div line="XXzr" class="ql-code-block">    </div><div line="NFd1" class="ql-code-block">    @ResponseStatus(HttpStatus.BAD_REQUEST)</div><div line="11Ou" class="ql-code-block">    @ExceptionHandler(value = RuntimeException.class)</div><div line="sR5q" class="ql-code-block">    public Result handler(RuntimeException e) {</div><div line="lFb2" class="ql-code-block">        log.error("运行时异常：----------------{}", e);</div><div line="5jPj" class="ql-code-block">        return Result.fail(e.getMessage());</div><div line="Vymn" class="ql-code-block">    }</div><div line="3XG7" class="ql-code-block">}</div></div><p line="f7uP"><br></p><p line="0W83">上面我们捕捉了几个异常：</p><ul data-list-style="circle"><li line="AO0S" class="bullet-item">ShiroException：shiro抛出的异常，比如没有权限，用户登录异常</li></ul><ul data-list-style="circle"><li line="xAjX" class="bullet-item">IllegalArgumentException：处理Assert的异常</li></ul><ul data-list-style="circle"><li line="WlDL" class="bullet-item">MethodArgumentNotValidException：处理实体校验的异常</li></ul><ul data-list-style="circle"><li line="Lp6e" class="bullet-item">RuntimeException：捕捉其他异常</li></ul><p line="6rg9"><br></p><ol data-list-style="decimal"><li class="ordered-item ql-heading-3" line="TxF9" data-list-number="6" data-list-content="6." data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>整合Spring Security</li></ol><p line="NBOu"><br></p><p line="yG5e">很多人不懂spring security，觉得这个框架比shiro要难，的确，security更加复杂一点，同时功能也更加强大，我们首先来看一下security的原理，这里我们引用一张来自江南一点雨大佬画的一张原理图（<a class="ql-link" href="https://blog.csdn.net/u012702547/article/details/89629415?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2NjUxNTkwMDcsImZpbGVHVUlEIjoiT25aRHdveEZGTDhiblAxYyIsImlhdCI6MTY2NTE1ODcwNywiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotNzIyOTE4Nzc3MX0.AhLZ3583HEK7kJAwvXusonzSRo0h-zE4btlUTrVMoBw" target="_blank" rel="noopener noreferrer nofollow">https://blog.csdn.net/u012702547/article/details/89629415</a>）：</p><p line="qzpp"><br></p><p line="wcrs"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="1080" height="auto" ori-width="1080" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(8).png" style="" ori-height="1488" data-src="https://uploader.shimo.im/f/cmNJaueFeTJbeviK.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="iaxs"><br></p><p class="ql-align-center" line="dkVL">（引自江南一点雨的博客）</p><p class="ql-align-center" line="SThw"><br></p><p line="ev6T">上面这张图一定要好好看，特别清晰，毕竟security是责任链的设计模式，是一堆过滤器链的组合，如果对于这个流程都不清楚，那么你就谈不上理解security。那么针对我们现在的这个系统，我们可以自己设计一个security的认证方案，结合江南一点雨大佬的博客，我们得到这样一套流程：</p><p line="xUkr"><br></p><p line="id6Q"><a class="ql-link" href="https://www.processon.com/view/link/606b0b5307912932d09adcb3?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2NjUxNTkwMDcsImZpbGVHVUlEIjoiT25aRHdveEZGTDhiblAxYyIsImlhdCI6MTY2NTE1ODcwNywiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotNzIyOTE4Nzc3MX0.AhLZ3583HEK7kJAwvXusonzSRo0h-zE4btlUTrVMoBw" target="_blank" rel="noopener noreferrer nofollow">https://www.processon.com/view/link/606b0b5307912932d09adcb3</a></p><p line="OcQY"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="1645" height="auto" ori-width="1645" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(9).png" style="" ori-height="2084" data-src="https://uploader.shimo.im/f/T9E9QfMpXhKniwtb.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="BnyV"><br></p><p line="Lu4M"><br></p><p line="hMBh">流程说明：</p><p line="btJR"><br></p><ol data-list-style="decimal" style="color: #494949;"><li style="color: #494949;" line="PAlI" class="ordered-item ql-size-11" data-list-number="1" data-list-content="1."><span style="color: #494949;" class="ql-size-11">客户端发起一个请求，进入 Security 过滤器链。</span></li></ol><p line="DfWR"><br></p><ol data-list-style="decimal" style="color: #494949;"><li style="color: #494949;" line="dmk3" class="ordered-item ql-size-11" data-list-number="2" data-list-content="2."><span style="color: #494949;" class="ql-size-11">当到 LogoutFilter 的时候判断是否是登出路径，如果是登出路径则到 logoutHandler ，如果登出成功则到 logoutSuccessHandler 登出成功处理。如果不是登出路径则直接进入下一个过滤器。</span></li></ol><p line="Fxbm"><br></p><ol data-list-style="decimal" style="color: #494949;"><li style="color: #494949;" line="uQuV" class="ordered-item ql-size-11" data-list-number="3" data-list-content="3."><span style="color: #494949;" class="ql-size-11">当到 UsernamePasswordAuthenticationFilter 的时候判断是否为登录路径，如果是，则进入该过滤器进行登录操作，如果登录失败则到 AuthenticationFailureHandler ，登录失败处理器处理，如果登录成功则到 AuthenticationSuccessHandler 登录成功处理器处理，如果不是登录请求则不进入该过滤器。</span></li></ol><p line="E5sQ"><br></p><ol data-list-style="decimal" style="color: #494949;"><li style="color: #494949;" line="xfuz" class="ordered-item ql-size-11" data-list-number="4" data-list-content="4.">进入认证BasicAuthenticationFilter进行用户认证，成功的话会把认证了的结果写入到SecurityContextHolder中SecurityContext的属性authentication上面。如果认证失败就会交给AuthenticationEntryPoint认证失败处理类，或者抛出异常被后续ExceptionTranslationFilter过滤器处理异常，如果是AuthenticationException就交给AuthenticationEntryPoint处理，如果是AccessDeniedException异常则交给AccessDeniedHandler处理。</li></ol><p line="oiLd"><br></p><ol data-list-style="decimal" style="color: #494949;"><li style="color: #494949;" line="egkQ" class="ordered-item ql-size-11" data-list-number="5" data-list-content="5."><span style="color: #494949;" class="ql-size-11">当到 FilterSecurityInterceptor 的时候会拿到 uri ，根据 uri 去找对应的鉴权管理器，鉴权管理器做鉴权工作，鉴权成功则到 Controller 层，否则到 AccessDeniedHandler 鉴权失败处理器处理。</span></li></ol><p line="GT2y"><br></p><p line="NjWi">Spring Security 实战干货：必须掌握的一些内置 Filter：<a class="ql-link" href="https://blog.csdn.net/qq_35067322/article/details/102690579?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2NjUxNTkwMDcsImZpbGVHVUlEIjoiT25aRHdveEZGTDhiblAxYyIsImlhdCI6MTY2NTE1ODcwNywiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotNzIyOTE4Nzc3MX0.AhLZ3583HEK7kJAwvXusonzSRo0h-zE4btlUTrVMoBw" target="_blank" rel="noopener noreferrer nofollow">https://blog.csdn.net/qq_35067322/article/details/102690579</a></p><p line="6yPr"><br></p><p line="87v8">ok，上面我们说的流程中涉及到几个组件，有些是我们需要根据实际情况来重写的。因为我们是使用json数据进行前后端数据交互，并且我们返回结果也是特定封装的。我们先再总结一下我们需要了解的几个组件：</p><p line="MAf3"><br></p><ul data-list-style="circle" style="color: #494949;"><li style="color: #494949;" line="LvqF" class="bullet-item ql-size-11"><span style="color: #494949;" class="ql-size-11">LogoutFilter  - 登出过滤器</span></li></ul><ul data-list-style="circle" style="color: #494949;"><li style="color: #494949;" line="zhQd" class="bullet-item ql-size-11"><span style="color: #494949;" class="ql-size-11">logoutSuccessHandler - 登出成功之后的操作类</span></li></ul><ul data-list-style="circle" style="color: #494949;"><li style="color: #494949;" line="LwZo" class="bullet-item ql-size-11"><span style="color: #494949;" class="ql-size-11">UsernamePasswordAuthenticationFilter  - from提交用户名密码登录认证过滤器</span></li></ul><ul data-list-style="circle" style="color: #494949;"><li style="color: #494949;" line="fwtd" class="bullet-item ql-size-11"><span style="color: #494949;" class="ql-size-11">AuthenticationFailureHandler  - 登录失败操作类</span></li></ul><ul data-list-style="circle" style="color: #494949;"><li style="color: #494949;" line="cK6v" class="bullet-item ql-size-11"><span style="color: #494949;" class="ql-size-11">AuthenticationSuccessHandler  - 登录成功操作类</span></li></ul><ul data-list-style="circle" style="color: #494949;"><li style="color: #494949;" line="NxO5" class="bullet-item ql-size-11"><span style="color: #494949;" class="ql-size-11">BasicAuthenticationFilter - Basic身份认证过滤器</span></li></ul><ul data-list-style="circle" style="color: #494949;"><li style="color: #494949;" line="rPWH" class="bullet-item ql-size-11"><span style="color: #494949;" class="ql-size-11">SecurityContextHolder - 安全上下文静态工具类</span></li></ul><ul data-list-style="circle" style="color: #494949;"><li style="color: #494949;" line="oXaG" class="bullet-item ql-size-11"><span style="color: #494949;" class="ql-size-11">AuthenticationEntryPoint - 认证失败入口</span></li></ul><ul data-list-style="circle" style="color: #494949;"><li style="color: #494949;" line="ppFy" class="bullet-item ql-size-11"><span style="color: #494949;" class="ql-size-11">ExceptionTranslationFilter - 异常处理过滤器</span></li></ul><ul data-list-style="circle" style="color: #494949;"><li style="color: #494949;" line="UrBJ" class="bullet-item ql-size-11"><span style="color: #494949;" class="ql-size-11">AccessDeniedHandler - 权限不足操作类</span></li></ul><ul data-list-style="circle" style="color: #494949;"><li style="color: #494949;" line="vXJw" class="bullet-item ql-size-11"><span style="color: #494949;" class="ql-size-11">FilterSecurityInterceptor - 权限判断拦截器、出口</span></li></ul><p line="mDXA"><br></p><p line="6YSz">有了上面的组件，那么认证与授权两个问题我们就已经接近啦，我们现在需要做的就是去重写我们的一些关键类。</p><p line="LA0j"><br></p><h4><div line="XJA5" data-header="4" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>引入Security与jwt</div></h4><p line="7Mxo"><br></p><p line="587h">首先我们导入security包，因为我们前后端交互用户凭证用的是JWT，所以我们也导入jwt的相关包，然后因为验证码的存储需要用到redis，所以引入redis。最后为了一些工具类，我们引入hutool。</p><ul data-list-style="circle"><li line="1P4n" class="bullet-item">pom.xml</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="GxGn" data-language="plain" class="ql-code-block">&lt;!-- springboot security --&gt;</div><div line="BBH5" data-language="plain" class="ql-code-block">&lt;dependency&gt;</div><div line="UK6I" data-language="plain" class="ql-code-block">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div line="i0qa" data-language="plain" class="ql-code-block">    &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;</div><div line="IGes" data-language="plain" class="ql-code-block">&lt;/dependency&gt;</div><div line="9UT0" data-language="plain" class="ql-code-block">&lt;dependency&gt;</div><div line="I7ff" data-language="plain" class="ql-code-block">    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;</div><div line="urgL" data-language="plain" class="ql-code-block">    &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;</div><div line="SQXJ" data-language="plain" class="ql-code-block">&lt;/dependency&gt;</div><div line="5p5Z" data-language="plain" class="ql-code-block">&lt;!-- jwt --&gt;</div><div line="ihEe" data-language="plain" class="ql-code-block">&lt;dependency&gt;</div><div line="oKjh" data-language="plain" class="ql-code-block">    &lt;groupId&gt;io.jsonwebtoken&lt;/groupId&gt;</div><div line="PLUW" data-language="plain" class="ql-code-block">    &lt;artifactId&gt;jjwt&lt;/artifactId&gt;</div><div line="XCbV" data-language="plain" class="ql-code-block">    &lt;version&gt;0.9.1&lt;/version&gt;</div><div line="0JyA" data-language="plain" class="ql-code-block">&lt;/dependency&gt;</div><div line="ahEa" data-language="plain" class="ql-code-block">&lt;dependency&gt;</div><div line="nJ13" data-language="plain" class="ql-code-block">    &lt;groupId&gt;com.github.axet&lt;/groupId&gt;</div><div line="6uR9" data-language="plain" class="ql-code-block">    &lt;artifactId&gt;kaptcha&lt;/artifactId&gt;</div><div line="s2YV" data-language="plain" class="ql-code-block">    &lt;version&gt;0.0.9&lt;/version&gt;</div><div line="6dfr" data-language="plain" class="ql-code-block">&lt;/dependency&gt;</div><div line="2xc3" data-language="plain" class="ql-code-block">&lt;!-- hutool工具类--&gt;</div><div line="QfE1" data-language="plain" class="ql-code-block">&lt;dependency&gt;</div><div line="EbsD" data-language="plain" class="ql-code-block">    &lt;groupId&gt;cn.hutool&lt;/groupId&gt;</div><div line="hHHd" data-language="plain" class="ql-code-block">    &lt;artifactId&gt;hutool-all&lt;/artifactId&gt;</div><div line="fLbV" data-language="plain" class="ql-code-block">    &lt;version&gt;5.3.3&lt;/version&gt;</div><div line="ArMZ" data-language="plain" class="ql-code-block">&lt;/dependency&gt;</div><div line="SBeV" data-language="plain" class="ql-code-block">&lt;dependency&gt;</div><div line="gjL5" data-language="plain" class="ql-code-block">    &lt;groupId&gt;org.apache.commons&lt;/groupId&gt;</div><div line="02mx" data-language="plain" class="ql-code-block">    &lt;artifactId&gt;commons-lang3&lt;/artifactId&gt;</div><div line="CcC0" data-language="plain" class="ql-code-block">    &lt;version&gt;3.11&lt;/version&gt;</div><div line="Jb8b" data-language="plain" class="ql-code-block">&lt;/dependency&gt;</div></div><p line="gEyu">启动redis，然后我们再启动项目，这时候我们再去访问<a class="ql-link" href="http://localhost:8081/test?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2NjUxNTkwMDcsImZpbGVHVUlEIjoiT25aRHdveEZGTDhiblAxYyIsImlhdCI6MTY2NTE1ODcwNywiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotNzIyOTE4Nzc3MX0.AhLZ3583HEK7kJAwvXusonzSRo0h-zE4btlUTrVMoBw" target="_blank" rel="noopener noreferrer nofollow">http://localhost:8081/test</a>，会发现系统会先判断到你未登录跳转到<a class="ql-link" href="http://localhost:8081/login?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2NjUxNTkwMDcsImZpbGVHVUlEIjoiT25aRHdveEZGTDhiblAxYyIsImlhdCI6MTY2NTE1ODcwNywiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotNzIyOTE4Nzc3MX0.AhLZ3583HEK7kJAwvXusonzSRo0h-zE4btlUTrVMoBw" target="_blank" rel="noopener noreferrer nofollow">http://localhost:8081/login</a>，因为security内置了登录页，用户名为user，密码在启动项目的时候打印在了控制台。登录完成之后我们才可以正常访问接口。</p><p line="u78b"><br></p><p line="JX9t">因为每次启动密码都会改变，所以我们通过配置文件来配置一下默认的用户名和密码：</p><ul data-list-style="circle"><li line="CsaQ" class="bullet-item">application.yml</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="Td9T" data-language="plain" class="ql-code-block">spring:</div><div line="xNEl" data-language="plain" class="ql-code-block">  security:</div><div line="0ZGN" data-language="plain" class="ql-code-block">    user:</div><div line="A3B6" data-language="plain" class="ql-code-block">      name: user</div><div line="oveR" data-language="plain" class="ql-code-block">      password: 111111</div></div><p line="YJBv"><br></p><h4><div line="OEbJ" data-header="4" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>用户认证</div></h4><p line="vyww">首先我们来解决用户认证问题，分为首次登陆，和二次认证。</p><p line="1jFc"><br></p><ul data-list-style="circle"><li line="u7ez" class="bullet-item">首次登录认证：用户名、密码和验证码完成登录</li></ul><ul data-list-style="circle"><li line="lAhZ" class="bullet-item">二次token认证：请求头携带Jwt进行身份认证</li></ul><p line="IMHN"><br></p><p line="4X9v">使用用户名密码来登录的，然后我们还想添加图片验证码，那么security给我们提供的UsernamePasswordAuthenticationFilter能使用吗？</p><p line="m6xB"><br></p><p line="II5o">首先security的所有过滤器都是没有图片验证码这回事的，看起来不适用了。其实这里我们可以灵活点，如果你依然想沿用自带的UsernamePasswordAuthenticationFilter，那么我们就在这过滤器之前添加一个图片验证码过滤器。当然了我们也可以通过自定义过滤器继承UsernamePasswordAuthenticationFilter，然后自己把验证码验证逻辑和认证逻辑写在一起，这也是一种解决方式。</p><p line="lDk2"><br></p><p line="nprg">我们这次解决方式是在UsernamePasswordAuthenticationFilter之前自定义一个图片过滤器CaptchaFilter，提前校验验证码是否正确，这样我们就可以使用UsernamePasswordAuthenticationFilter了，然后登录正常或失败我们都可以通过对应的Handler来返回我们特定格式的封装结果数据。</p><p line="IHBE"><br></p><h4><div line="lrUb" data-header="4" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>生成验证码</div></h4><p line="3kSa">首先我们先生成验证码，之前我们已经引用了google的验证码生成器，我们先来配置一下图片验证码的生成规则：</p><ul data-list-style="circle"><li line="Omeb" class="bullet-item">com.markerhub.config.KaptchaConfig</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="nNmb" data-language="plain" class="ql-code-block">@Configuration</div><div line="L1H6" data-language="plain" class="ql-code-block">public class KaptchaConfig {</div><div line="lT0L" data-language="plain" class="ql-code-block">   @Bean</div><div line="v4mS" data-language="plain" class="ql-code-block">   public DefaultKaptcha producer() {</div><div line="HVYu" data-language="plain" class="ql-code-block">      Properties properties = new Properties();</div><div line="if1m" data-language="plain" class="ql-code-block">      properties.put("kaptcha.border", "no");</div><div line="jhHs" data-language="plain" class="ql-code-block">      properties.put("kaptcha.textproducer.font.color", "black");</div><div line="XR59" data-language="plain" class="ql-code-block">      properties.put("kaptcha.textproducer.char.space", "4");</div><div line="mlRH" data-language="plain" class="ql-code-block">      properties.put("kaptcha.image.height", "40");</div><div line="Cfk5" data-language="plain" class="ql-code-block">      properties.put("kaptcha.image.width", "120");</div><div line="ULuz" data-language="plain" class="ql-code-block">      properties.put("kaptcha.textproducer.font.size", "30");</div><div line="haml" data-language="plain" class="ql-code-block">      Config config = new Config(properties);</div><div line="dGaG" data-language="plain" class="ql-code-block">      DefaultKaptcha defaultKaptcha = new DefaultKaptcha();</div><div line="VrNR" data-language="plain" class="ql-code-block">      defaultKaptcha.setConfig(config);</div><div line="LBKW" data-language="plain" class="ql-code-block">      return defaultKaptcha;</div><div line="xSbc" data-language="plain" class="ql-code-block">   }</div><div line="UEeP" data-language="plain" class="ql-code-block">}</div></div><p line="NAL0">上面我定义了图片验证码的长宽字体颜色等，自己可以调整哈。</p><p line="Rxtm"><br></p><p line="R9rI">然后我们通过控制器提供生成验证码的方法：</p><ul data-list-style="circle"><li line="4E5t" class="bullet-item">com.markerhub.controller.AuthController</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="f89K" data-language="plain" class="ql-code-block">@Slf4j</div><div line="sGkV" data-language="plain" class="ql-code-block">@RestController</div><div line="B6pp" data-language="plain" class="ql-code-block">public class AuthController extends BaseController{</div><div line="mp4m" data-language="plain" class="ql-code-block">   @Autowired</div><div line="O19n" data-language="plain" class="ql-code-block">   private Producer producer;</div><div line="OZww" data-language="plain" class="ql-code-block">   /**</div><div line="kpGz" data-language="plain" class="ql-code-block">    * 图片验证码</div><div line="GmtY" data-language="plain" class="ql-code-block">    */</div><div line="OwTZ" data-language="plain" class="ql-code-block">   @GetMapping("/captcha")</div><div line="wnTB" data-language="plain" class="ql-code-block">   public Result captcha(HttpServletRequest request, HttpServletResponse response) throws IOException {</div><div line="x8QR" data-language="plain" class="ql-code-block">      String code = producer.createText();</div><div line="WEQz" data-language="plain" class="ql-code-block">      String key = UUID.randomUUID().toString();</div><div line="lZtD" data-language="plain" class="ql-code-block"><br></div><div line="aZqY" data-language="plain" class="ql-code-block">      BufferedImage image = producer.createImage(code);</div><div line="ZXNN" data-language="plain" class="ql-code-block">      ByteArrayOutputStream outputStream = new ByteArrayOutputStream();</div><div line="BEGo" data-language="plain" class="ql-code-block">      ImageIO.write(image, "jpg", outputStream);</div><div line="Sg1l" data-language="plain" class="ql-code-block">      BASE64Encoder encoder = new BASE64Encoder();</div><div line="tAIs" data-language="plain" class="ql-code-block">      String str = "data:image/jpeg;base64,";</div><div line="Mhec" data-language="plain" class="ql-code-block">      String base64Img = str + encoder.encode(outputStream.toByteArray());</div><div line="uE0u" data-language="plain" class="ql-code-block">      </div><div line="OKMr" data-language="plain" class="ql-code-block">      // 存储到redis中</div><div line="wyew" data-language="plain" class="ql-code-block">      redisUtil.hset(Const.captcha_KEY, key, code, 120);</div><div line="zhEu" data-language="plain" class="ql-code-block">      log.info("验证码 -- {} - {}", key, code);</div><div line="KgqM" data-language="plain" class="ql-code-block">      return Result.succ(</div><div line="UECK" data-language="plain" class="ql-code-block">            MapUtil.builder()</div><div line="IRN9" data-language="plain" class="ql-code-block">            .put("token", key)</div><div line="7dsl" data-language="plain" class="ql-code-block">            .put("base64Img", base64Img)</div><div line="IAYU" data-language="plain" class="ql-code-block">            .build()</div><div line="wsqQ" data-language="plain" class="ql-code-block">      );</div><div line="D7w1" data-language="plain" class="ql-code-block">   }</div><div line="3lwO" data-language="plain" class="ql-code-block">}</div></div><p line="rX0x">因为前后端分离，我们禁用了session，所以我们把验证码放在了redis中，使用一个随机字符串作为key，并传送到前端，前端再把随机字符串和用户输入的验证码提交上来，这样我们就可以通过随机字符串获取到保存的验证码和用户的验证码进行比较了是否正确了。</p><p line="byeQ"><br></p><p line="bP4G">然后因为图片验证码的方式，所以我们进行了encode，把图片进行了base64编码，这样前端就可以显示图片了。</p><p line="4OhF"><br></p><p line="sk0T">而前端的处理，我们之前是使用了mockjs进行随机生成数据的，现在后端有接口之后，我们只需要在main.js中去掉mockjs的引入即可，这样前端就可以访问后端的接口而不被mock拦截了。</p><p line="7HN2"><br></p><h4><div line="gkEn" data-header="4" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>验证码认证过滤器</div></h4><p line="UAfS">图片验证码进行认证验证码是否正确。</p><ul data-list-style="circle"><li line="DsfG" class="bullet-item">CaptchaFilter</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="d0Nw" data-language="plain" class="ql-code-block">/**</div><div line="Bvn6" data-language="plain" class="ql-code-block"> * 图片验证码校验过滤器，在登录过滤器前</div><div line="oSpW" data-language="plain" class="ql-code-block"> */</div><div line="fAFp" data-language="plain" class="ql-code-block">@Slf4j</div><div line="kWjd" data-language="plain" class="ql-code-block">@Component</div><div line="xNYq" data-language="plain" class="ql-code-block">public class CaptchaFilter extends OncePerRequestFilter {</div><div line="6HU8" data-language="plain" class="ql-code-block">   private final String loginUrl = "/login";</div><div line="AKtb" data-language="plain" class="ql-code-block">   @Autowired</div><div line="eVAz" data-language="plain" class="ql-code-block">   RedisUtil redisUtil;</div><div line="tLs4" data-language="plain" class="ql-code-block">   @Autowired</div><div line="uUDg" data-language="plain" class="ql-code-block">   LoginFailureHandler loginFailureHandler;</div><div line="IJwm" data-language="plain" class="ql-code-block">   @Override</div><div line="WbkD" data-language="plain" class="ql-code-block">   protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain filterChain)</div><div line="CPtQ" data-language="plain" class="ql-code-block">         throws ServletException, IOException {</div><div line="wEsu" data-language="plain" class="ql-code-block">      String url = request.getRequestURI();</div><div line="40hS" data-language="plain" class="ql-code-block">      if (loginUrl.equals(url) &amp;&amp; request.getMethod().equals("POST")) {</div><div line="7rot" data-language="plain" class="ql-code-block">         log.info("获取到login链接，正在校验验证码 -- " + url);</div><div line="6WcX" data-language="plain" class="ql-code-block">         try {</div><div line="Wwwj" data-language="plain" class="ql-code-block">            validate(request);</div><div line="wAps" data-language="plain" class="ql-code-block">         } catch (CaptchaException e) {</div><div line="QJQQ" data-language="plain" class="ql-code-block">            log.info(e.getMessage());</div><div line="dMWT" data-language="plain" class="ql-code-block">            // 交给登录失败处理器处理</div><div line="aI0T" data-language="plain" class="ql-code-block">            loginFailureHandler.onAuthenticationFailure(request, response, e);</div><div line="VvZl" data-language="plain" class="ql-code-block">         }</div><div line="jfoI" data-language="plain" class="ql-code-block">      }</div><div line="HRqB" data-language="plain" class="ql-code-block">      filterChain.doFilter(request, response);</div><div line="bDxA" data-language="plain" class="ql-code-block">   }</div><div line="Yhs4" data-language="plain" class="ql-code-block">   private void validate(HttpServletRequest request) {</div><div line="JhKn" data-language="plain" class="ql-code-block">      String code = request.getParameter("code");</div><div line="bdKg" data-language="plain" class="ql-code-block">      String token = request.getParameter("token");</div><div line="g5c5" data-language="plain" class="ql-code-block">      if (StringUtils.isBlank(code) || StringUtils.isBlank(token)) {</div><div line="clod" data-language="plain" class="ql-code-block">         throw new CaptchaException("验证码不能为空");</div><div line="2WC3" data-language="plain" class="ql-code-block">      }</div><div line="6YzH" data-language="plain" class="ql-code-block">      if(!code.equals(redisUtil.hget(Const.captcha_KEY, token))) {</div><div line="Xays" data-language="plain" class="ql-code-block">         throw new CaptchaException("验证码不正确");</div><div line="zu7A" data-language="plain" class="ql-code-block">      }</div><div line="55Rp" data-language="plain" class="ql-code-block">      // 一次性使用</div><div line="HYw2" data-language="plain" class="ql-code-block">      redisUtil.hdel(Const.captcha_KEY, token);</div><div line="la6l" data-language="plain" class="ql-code-block">   }</div><div line="WhfS" data-language="plain" class="ql-code-block">}</div></div><p line="3BWN">上面代码中，因为验证码需要存储，所以添加了RedisUtil工具类，这个工具类代码我们就不贴出来了。</p><ul data-list-style="circle"><li line="FaAI" class="bullet-item">com.markerhub.util.RedisUtil</li></ul><p line="mVwg">然后验证码出错的时候我们返回异常信息，这是一个认证异常，所以我们自定了一个CaptchaException：</p><ul data-list-style="circle"><li line="dJzK" class="bullet-item">com.javacat.common.exception.CaptchaException</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="7MWV" data-language="plain" class="ql-code-block">public class CaptchaException extends AuthenticationException {</div><div line="PBg7" data-language="plain" class="ql-code-block">   public CaptchaException(String msg) {</div><div line="KrF6" data-language="plain" class="ql-code-block">      super(msg);</div><div line="vNTa" data-language="plain" class="ql-code-block">   }</div><div line="l1Nq" data-language="plain" class="ql-code-block">}</div></div><ul data-list-style="circle"><li line="ZIav" class="bullet-item">com.markerhub.common.lang.Const</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="K5JW" data-language="plain" class="ql-code-block">public class Const {</div><div line="yiA5" data-language="plain" class="ql-code-block">   public static final String captcha_KEY = "captcha";</div><div line="DNGa" data-language="plain" class="ql-code-block">}</div></div><p line="9eeG">然后认证失败的话，我们之前说过，登录失败的时候交给AuthenticationFailureHandler，所以我们自定义了LoginFailureHandler</p><ul data-list-style="circle"><li line="8IrJ" class="bullet-item">com.markerhub.security.LoginFailureHandler</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="0hTv" data-language="plain" class="ql-code-block">@Component</div><div line="gQ62" data-language="plain" class="ql-code-block">public class LoginFailureHandler implements AuthenticationFailureHandler {</div><div line="G7aU" data-language="plain" class="ql-code-block">   @Override</div><div line="ADzG" data-language="plain" class="ql-code-block">   public void onAuthenticationFailure(HttpServletRequest request, HttpServletResponse response, AuthenticationException exception) throws IOException, ServletException {</div><div line="JklP" data-language="plain" class="ql-code-block">      response.setContentType("application/json;charset=UTF-8");</div><div line="v4YC" data-language="plain" class="ql-code-block">      ServletOutputStream outputStream = response.getOutputStream();</div><div line="i4KK" data-language="plain" class="ql-code-block">      Result result = Result.fail(</div><div line="s1Rk" data-language="plain" class="ql-code-block">            "Bad credentials".equals(exception.getMessage()) ? "用户名或密码不正确" : exception.getMessage()</div><div line="gA6m" data-language="plain" class="ql-code-block">      );</div><div line="MAgA" data-language="plain" class="ql-code-block">      outputStream.write(JSONUtil.toJsonStr(result).getBytes("UTF-8"));</div><div line="pl8z" data-language="plain" class="ql-code-block">      outputStream.flush();</div><div line="let8" data-language="plain" class="ql-code-block">      outputStream.close();</div><div line="raxy" data-language="plain" class="ql-code-block">   }</div><div line="5Vhp" data-language="plain" class="ql-code-block">}</div></div><p line="2FBA">其实主要就是获取异常的消息，然后封装到Result，最后转成json返回给前端而已哈。</p><p line="CgYK"><br></p><p line="rBZ9">然后我们配置SecurityConfig</p><ul data-list-style="circle"><li line="4fVE" class="bullet-item">com.markerhub.config.SecurityConfig</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="feTZ" data-language="plain" class="ql-code-block">@Configuration</div><div line="6pHa" data-language="plain" class="ql-code-block">@EnableGlobalMethodSecurity(prePostEnabled = true)</div><div line="zK2n" data-language="plain" class="ql-code-block">@EnableWebSecurity</div><div line="Mdgt" data-language="plain" class="ql-code-block">public class SecurityConfig extends WebSecurityConfigurerAdapter {</div><div line="4CZm" data-language="plain" class="ql-code-block"><br></div><div line="c5sN" data-language="plain" class="ql-code-block">   @Autowired</div><div line="Wqa6" data-language="plain" class="ql-code-block">   LoginFailureHandler loginFailureHandler;</div><div line="sEro" data-language="plain" class="ql-code-block">   </div><div line="Bvwc" data-language="plain" class="ql-code-block">   @Autowired</div><div line="tHNZ" data-language="plain" class="ql-code-block">   CaptchaFilter captchaFilter;</div><div line="O6Or" data-language="plain" class="ql-code-block">   </div><div line="wJc6" data-language="plain" class="ql-code-block">   public static final String[] URL_WHITELIST = {</div><div line="f4Og" data-language="plain" class="ql-code-block"><br></div><div line="f4jB" data-language="plain" class="ql-code-block">         "/webjars/**",</div><div line="GBxq" data-language="plain" class="ql-code-block">         "/favicon.ico",</div><div line="uFTC" data-language="plain" class="ql-code-block">         </div><div line="OVoj" data-language="plain" class="ql-code-block">         "/captcha",</div><div line="4z12" data-language="plain" class="ql-code-block">         "/login",</div><div line="71QA" data-language="plain" class="ql-code-block">         "/logout",</div><div line="izkG" data-language="plain" class="ql-code-block">   };</div><div line="HPwr" data-language="plain" class="ql-code-block">   </div><div line="XQK4" data-language="plain" class="ql-code-block">   @Override</div><div line="GZVb" data-language="plain" class="ql-code-block">   protected void configure(HttpSecurity http) throws Exception {</div><div line="tRwo" data-language="plain" class="ql-code-block">      http.cors().and().csrf().disable()</div><div line="jGKe" data-language="plain" class="ql-code-block">            .formLogin()</div><div line="cteI" data-language="plain" class="ql-code-block">            .failureHandler(loginFailureHandler)</div><div line="jwwa" data-language="plain" class="ql-code-block">            </div><div line="bhyt" data-language="plain" class="ql-code-block">            .and()</div><div line="7UCb" data-language="plain" class="ql-code-block">            .authorizeRequests()</div><div line="iM1R" data-language="plain" class="ql-code-block">            .antMatchers(URL_WHITELIST).permitAll() //白名单</div><div line="l7G3" data-language="plain" class="ql-code-block">            .anyRequest().authenticated()</div><div line="FqKy" data-language="plain" class="ql-code-block">            // 不会创建 session</div><div line="ATgB" data-language="plain" class="ql-code-block">            .and()</div><div line="NwJO" data-language="plain" class="ql-code-block">            .sessionManagement()</div><div line="atLu" data-language="plain" class="ql-code-block">            .sessionCreationPolicy(SessionCreationPolicy.STATELESS)</div><div line="t9B7" data-language="plain" class="ql-code-block">            </div><div line="k74U" data-language="plain" class="ql-code-block">            .and()</div><div line="9Vja" data-language="plain" class="ql-code-block">            .addFilterBefore(captchaFilter, UsernamePasswordAuthenticationFilter.class) // 登录验证码校验过滤器</div><div line="2Ln6" data-language="plain" class="ql-code-block">      ;</div><div line="PGWb" data-language="plain" class="ql-code-block">   }</div><div line="iz3c" data-language="plain" class="ql-code-block">}</div></div><p line="PIok">首先formLogin我们定义了表单登录提交的方式以及定义了登录失败的处理器，后面我们还要定义登录成功的处理器的。然后authorizeRequests我们除了白名单的链接之外其他请求都会被拦截。再然后就是禁用session，最后是设定验证码过滤器在登录过滤器之前。</p><p line="TGko"><br></p><p line="gqKV">然后我们打开前端的/login，发现出现了跨域的问题，后面我处理，我们先用postman调试接口。</p><p line="M1Ma"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="482" height="auto" ori-width="482" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(10).png" style="" ori-height="580" data-src="https://uploader.shimo.im/f/Xz19FZRRnnOQcXHB.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="v9OF"><br></p><p line="yMRg">可以看到，我们的随机码token和base64Img编码都是正常的。控制台上看到我们的验证是2yyxm：</p><p line="ioHU"><br></p><p line="djDQ"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="621" height="auto" ori-width="621" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(11).png" style="" ori-height="76" data-src="https://uploader.shimo.im/f/uKnMCemSTW2wK8kV.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="iJZL"><br></p><p line="YSQ5">然后我们尝试登录，因为之前我们已经设置了用户名密码为user/111111，所以我们提交表单的时候再带上我们的token和验证码。</p><p line="Bz2l"><br></p><p line="OUKM">这时候我们就可以去提交表单了吗，其实还不可以，为啥？因为就算我们登录成功，security默认跳转到/链接，但是又会因为没有权限访问/，所有又会教你去登录，所以我们必须取消原先默认的登录成功之后的操作，根据我们之前分析的流程，登录成功之后会走<span style="color: #494949;" class="ql-size-11">AuthenticationSuccessHandler，因此在登录之前，我们先去自定义这个登录成功操作类：</span></p><ul data-list-style="circle"><li line="yhWy" class="bullet-item">com.markerhub.security.LoginSuccessHandler</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="BYkB" data-language="plain" class="ql-code-block">@Component</div><div line="bYiN" data-language="plain" class="ql-code-block">public class LoginSuccessHandler implements AuthenticationSuccessHandler {</div><div line="CcFQ" data-language="plain" class="ql-code-block">   @Autowired</div><div line="pW4a" data-language="plain" class="ql-code-block">   JwtUtils jwtUtils;</div><div line="16e7" data-language="plain" class="ql-code-block">   </div><div line="kK0I" data-language="plain" class="ql-code-block">   @Override</div><div line="p3Ib" data-language="plain" class="ql-code-block">   public void onAuthenticationSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication) throws IOException, ServletException {</div><div line="wQ6a" data-language="plain" class="ql-code-block">      response.setContentType("application/json;charset=UTF-8");</div><div line="3XqC" data-language="plain" class="ql-code-block">      ServletOutputStream outputStream = response.getOutputStream();</div><div line="8WAP" data-language="plain" class="ql-code-block">      </div><div line="4SFa" data-language="plain" class="ql-code-block">      // 生成jwt返回</div><div line="NSCF" data-language="plain" class="ql-code-block">      String jwt = jwtUtils.generateToken(authentication.getName());</div><div line="Aro2" data-language="plain" class="ql-code-block">      response.setHeader(jwtUtils.getHeader(), jwt);</div><div line="o0Bc" data-language="plain" class="ql-code-block">      </div><div line="m3Dz" data-language="plain" class="ql-code-block">      Result result = Result.succ("");</div><div line="QFXY" data-language="plain" class="ql-code-block">      outputStream.write(JSONUtil.toJsonStr(result).getBytes("UTF-8"));</div><div line="Y787" data-language="plain" class="ql-code-block">      outputStream.flush();</div><div line="wYR0" data-language="plain" class="ql-code-block">      outputStream.close();</div><div line="IAeV" data-language="plain" class="ql-code-block">   }</div><div line="4Pk2" data-language="plain" class="ql-code-block">}</div></div><p line="ak8o">登录成功之后我们利用用户名生成jwt，jwtUtils这个工具类我就不贴代码了哈，去看我们项目源码，然后把jwt作为请求头返回回去，名称就叫Authorization哈。我们需要在配置文件中配置一些jwt的一些密钥信息：</p><ul data-list-style="circle"><li line="m8nS" class="bullet-item">application.yml</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="BoeF" data-language="plain" class="ql-code-block">markerhub:</div><div line="unyn" data-language="plain" class="ql-code-block">  jwt:</div><div line="0mkr" data-language="plain" class="ql-code-block">    # 加密秘钥</div><div line="DH8d" data-language="plain" class="ql-code-block">    secret: f4e2e52034348f86b67cde581c0f9eb5</div><div line="yiwi" data-language="plain" class="ql-code-block">    # token有效时长，7天，单位秒</div><div line="7WoF" data-language="plain" class="ql-code-block">    expire: 604800</div><div line="EIPY" data-language="plain" class="ql-code-block">    header: Authorization</div></div><p line="q31T">然后我们再security配置中添加上登录成功之后的操作类：</p><ul data-list-style="circle"><li line="n2tX" class="bullet-item">com.markerhub.config.SecurityConfig</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="gTL1" data-language="plain" class="ql-code-block">@Autowired</div><div line="7AYH" data-language="plain" class="ql-code-block">LoginSuccessHandler loginSuccessHandler;</div><div line="8G7F" data-language="plain" class="ql-code-block"><br></div><div line="KToR" data-language="plain" class="ql-code-block">...</div><div line="NuDV" data-language="plain" class="ql-code-block"># configure代码：</div><div line="rUfn" data-language="plain" class="ql-code-block"><br></div><div line="ORiV" data-language="plain" class="ql-code-block">http.cors().and().csrf().disable()</div><div line="r3dq" data-language="plain" class="ql-code-block">      .formLogin()</div><div line="n0JN" data-language="plain" class="ql-code-block">      .failureHandler(loginFailureHandler)</div><div line="mA9f" data-language="plain" class="ql-code-block">      .successHandler(loginSuccessHandler)</div></div><p line="2k8i">然后我们去postman的进行我们的登录测试：</p><p line="y7W5"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="577" height="auto" ori-width="577" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(12).png" style="" ori-height="494" data-src="https://uploader.shimo.im/f/3vFyyoBVJzCNxDTe.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="qJMC"><br></p><p line="u1Ox">上面我们可以看到，我们已经可以登录成功了。然后去结果的请求头中查看jwt：</p><p line="HFiQ"><br></p><p line="GPeA"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="814" height="auto" ori-width="814" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(13).png" style="" ori-height="158" data-src="https://uploader.shimo.im/f/cF5va6E7hmLZPFBR.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="Wrsj"><br></p><p line="TOo4">搞定，登录成功啦，验证码也正常验证了。</p><p line="TyEP"><br></p><h4><div line="QhEU" data-header="4" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>身份认证 - 1</div></h4><p line="N2D0">登录成功之后前端就可以获取到了jwt的信息，前端中我们是保存在了store中，同时也保存在了localStorage中，然后每次axios请求之前，我们都会添加上我们的请求头信息，可以回顾一下：</p><ul data-list-style="circle"><li line="HPAo" class="bullet-item">前端项目的axios.js</li></ul><p line="jDVT"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="742" height="auto" ori-width="742" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(14).png" style="" ori-height="210" data-src="https://uploader.shimo.im/f/63aM3zeNztYwF09f.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="nG64"><br></p><p line="lyfT"><br></p><p line="jbq6">所以后端进行用户身份识别的时候，我们需要通过请求头中获取jwt，然后解析出我们的用户名，这样我们就可以知道是谁在访问我们的接口啦，然后判断用户是否有权限等操作。</p><p line="D2dw"><br></p><p line="NM1D">那么我们自定义一个过滤器用来进行识别jwt。</p><ul data-list-style="circle"><li line="iqlX" class="bullet-item">JWTAuthenticationFilter</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="15Vi" data-language="plain" class="ql-code-block">@Slf4j</div><div line="Dkc4" data-language="plain" class="ql-code-block">public class JWTAuthenticationFilter extends BasicAuthenticationFilter {</div><div line="NlLv" data-language="plain" class="ql-code-block">   @Autowired</div><div line="lzCX" data-language="plain" class="ql-code-block">   JwtUtils jwtUtils;</div><div line="RUI7" data-language="plain" class="ql-code-block">   @Autowired</div><div line="tNGk" data-language="plain" class="ql-code-block">   RedisUtil redisUtil;</div><div line="KTmI" data-language="plain" class="ql-code-block">   @Autowired</div><div line="ZKi1" data-language="plain" class="ql-code-block">   SysUserService sysUserService;</div><div line="s9WO" data-language="plain" class="ql-code-block">   public JWTAuthenticationFilter(AuthenticationManager authenticationManager) {</div><div line="dNOn" data-language="plain" class="ql-code-block">      super(authenticationManager);</div><div line="ui8a" data-language="plain" class="ql-code-block">   }</div><div line="EiS1" data-language="plain" class="ql-code-block">   @Override</div><div line="7x1L" data-language="plain" class="ql-code-block">   protected void doFilterInternal(HttpServletRequest request, HttpServletResponse response, FilterChain chain) throws IOException, ServletException {</div><div line="nU9c" data-language="plain" class="ql-code-block">      log.info("jwt 校验 filter");</div><div line="MngU" data-language="plain" class="ql-code-block">      String jwt = request.getHeader(jwtUtils.getHeader());</div><div line="pI8s" data-language="plain" class="ql-code-block">      if (StrUtil.isBlankOrUndefined(jwt)) {</div><div line="TgsW" data-language="plain" class="ql-code-block">         chain.doFilter(request, response);</div><div line="mJMZ" data-language="plain" class="ql-code-block">         return;</div><div line="3EJ3" data-language="plain" class="ql-code-block">      }</div><div line="aHFG" data-language="plain" class="ql-code-block">      Claims claim = jwtUtils.getClaimByToken(jwt);</div><div line="Ul6B" data-language="plain" class="ql-code-block">      if (claim == null) {</div><div line="qloM" data-language="plain" class="ql-code-block">         throw new JwtException("token异常！");</div><div line="K1hv" data-language="plain" class="ql-code-block">      }</div><div line="OxDh" data-language="plain" class="ql-code-block">      if (jwtUtils.isTokenExpired(claim.getExpiration())) {</div><div line="q9KK" data-language="plain" class="ql-code-block">         throw new JwtException("token已过期");</div><div line="05I8" data-language="plain" class="ql-code-block">      }</div><div line="kp4Y" data-language="plain" class="ql-code-block">      String username = claim.getSubject();</div><div line="O4WN" data-language="plain" class="ql-code-block">      log.info("用户-{}，正在登陆！", username);</div><div line="9AKZ" data-language="plain" class="ql-code-block">      UsernamePasswordAuthenticationToken usernamePasswordAuthenticationToken</div><div line="Tzz5" data-language="plain" class="ql-code-block">            = new UsernamePasswordAuthenticationToken(username, null, new TreeSet&lt;&gt;());</div><div line="wm7p" data-language="plain" class="ql-code-block">      SecurityContextHolder.getContext().setAuthentication(usernamePasswordAuthenticationToken);</div><div line="U6gz" data-language="plain" class="ql-code-block">      chain.doFilter(request, response);</div><div line="DX9G" data-language="plain" class="ql-code-block">   }</div><div line="P1L8" data-language="plain" class="ql-code-block">}</div></div><p line="4PzN">上面的逻辑也很简单，正如我前面说到的，获取到用户名之后我们直接把封装成UsernamePasswordAuthenticationToken，之后交给SecurityContextHolder参数传递authentication对象，这样后续security就能获取到当前登录的用户信息了，也就完成了用户认证。</p><p line="hVaS"><br></p><p line="3s6N">当认证失败的时候会进入AuthenticationEntryPoint，于是我们自定义认证失败返回的数据：</p><ul data-list-style="circle"><li line="dLr1" class="bullet-item">com.markerhub.security.JwtAuthenticationEntryPoint</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="krvv" data-language="plain" class="ql-code-block">/**</div><div line="xR1g" data-language="plain" class="ql-code-block"> * 定义认证失败处理类</div><div line="EFuU" data-language="plain" class="ql-code-block"> */</div><div line="0yA9" data-language="plain" class="ql-code-block">@Slf4j</div><div line="UP5z" data-language="plain" class="ql-code-block">@Component</div><div line="LSoD" data-language="plain" class="ql-code-block">public class JwtAuthenticationEntryPoint implements AuthenticationEntryPoint {</div><div line="LOOz" data-language="plain" class="ql-code-block">   @Override</div><div line="dG6B" data-language="plain" class="ql-code-block">   public void commence(HttpServletRequest request, HttpServletResponse response, AuthenticationException authException)</div><div line="dph7" data-language="plain" class="ql-code-block">         throws IOException {</div><div line="ViOB" data-language="plain" class="ql-code-block">      log.info("认证失败！未登录！");</div><div line="XiL1" data-language="plain" class="ql-code-block">      response.setContentType("application/json;charset=UTF-8");</div><div line="I8nC" data-language="plain" class="ql-code-block">      response.setStatus(HttpServletResponse.SC_UNAUTHORIZED);</div><div line="3vzI" data-language="plain" class="ql-code-block">      ServletOutputStream outputStream = response.getOutputStream();</div><div line="zVHK" data-language="plain" class="ql-code-block">      </div><div line="zwij" data-language="plain" class="ql-code-block">      Result result = Result.fail("请先登录！");</div><div line="SkjX" data-language="plain" class="ql-code-block">      outputStream.write(JSONUtil.toJsonStr(result).getBytes("UTF-8"));</div><div line="lSLN" data-language="plain" class="ql-code-block">      outputStream.flush();</div><div line="KC4X" data-language="plain" class="ql-code-block">      outputStream.close();</div><div line="K53k" data-language="plain" class="ql-code-block">   }</div><div line="lZXB" data-language="plain" class="ql-code-block">}</div></div><p line="ubGP">不过是啥原因，认证失败，我们就要求重新登录，所以返回的信息直接明了“请先登录！”哈哈。</p><p line="d1nY"><br></p><p line="LQbO">然后我们把认证过滤器和认证失败入口配置到SecurityConfig中：</p><ul data-list-style="circle"><li line="W3Ym" class="bullet-item">com.markerhub.config.SecurityConfig</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="EQMx" data-language="plain" class="ql-code-block">@Bean</div><div line="1iuv" data-language="plain" class="ql-code-block">JWTAuthenticationFilter jwtAuthenticationFilter() throws Exception {</div><div line="2eTn" data-language="plain" class="ql-code-block">   JWTAuthenticationFilter filter = new JWTAuthenticationFilter(authenticationManager());</div><div line="qzBG" data-language="plain" class="ql-code-block">   return filter;</div><div line="FTsW" data-language="plain" class="ql-code-block">}</div><div line="1GKw" data-language="plain" class="ql-code-block"><br></div><div line="83nv" data-language="plain" class="ql-code-block">.and()</div><div line="e11V" data-language="plain" class="ql-code-block">.exceptionHandling()</div><div line="8B58" data-language="plain" class="ql-code-block">.authenticationEntryPoint(jwtAuthenticationEntryPoint)</div><div line="yEoV" data-language="plain" class="ql-code-block"><br></div><div line="CjFa" data-language="plain" class="ql-code-block">.and()</div><div line="LY6X" data-language="plain" class="ql-code-block">.addFilter(jwtAuthenticationFilter())</div><div line="Ony9" data-language="plain" class="ql-code-block">.addFilterBefore(captchaFilter, UsernamePasswordAuthenticationFilter.class) // 登录验证码校验过滤器</div></div><p line="79t0">这样携带jwt请求头我们就可以正常访问我们的接口了。</p><p line="DLKc"><br></p><h4><div line="eyCK" data-header="4" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>身份认证 - 2</div></h4><p line="EG5y">之前我们的用户名密码配置在配置文件中的，而且密码也用的是明文，这明显不符合我们的要求，我们的用户必须是存储在数据库中，密码也是得经过加密的。所以我们先来解决这个问题，然后再去弄授权。</p><p line="KuN2"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="1212" height="auto" ori-width="1212" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(15).png" style="" ori-height="698" data-src="https://uploader.shimo.im/f/djDbTlwZMm5xCIte.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="xiEE"><br></p><p line="FUd7"><br></p><p line="pyOv"><br></p><p line="SYTM">首先来插入一条用户数据，但这里有个问题，就是我们的密码怎么生成？密码怎么来的？这里我们使用Security内置了的BCryptPasswordEncoder，里面就有生成和匹配密码是否正确的方法，也就是加密和验证策略。因此我们再SecurityConfig中进行配置：</p><ul data-list-style="circle"><li line="QAPP" class="bullet-item">com.markerhub.config.SecurityConfig</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="asgx" data-language="plain" class="ql-code-block">@Bean</div><div line="NLdz" data-language="plain" class="ql-code-block">BCryptPasswordEncoder bCryptPasswordEncoder() {</div><div line="6LQW" data-language="plain" class="ql-code-block">   return new BCryptPasswordEncoder();</div><div line="5UIt" data-language="plain" class="ql-code-block">}</div></div><p line="jMiS">这样系统就会使用我们找个新的密码策略进行匹配密码是否正常了。之前我们配置文件配置的用户名密码去掉：</p><ul data-list-style="circle"><li line="nM8r" class="bullet-item">application.yml</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="nPiq" data-language="plain" class="ql-code-block">#  security:</div><div line="NWAk" data-language="plain" class="ql-code-block">#    user:</div><div line="Hgk6" data-language="plain" class="ql-code-block">#      name: user</div><div line="1C3x" data-language="plain" class="ql-code-block">#      password: 111111</div></div><p line="Kbvo">ok，我们先使用BCryptPasswordEncoder给我们生成一个密码，给数据库添加一条数据先，我们再TestController中注入BCryptPasswordEncoder，然后使用encode进行密码加密，对了，记得在SecurityConfig中吧/test/**添加白名单哈，不然访问会提示你登录！！</p><ul data-list-style="circle"><li line="Tts1" class="bullet-item">com.markerhub.controller.TestController</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="J28i" data-language="plain" class="ql-code-block">@Autowired</div><div line="BOiz" data-language="plain" class="ql-code-block">BCryptPasswordEncoder bCryptPasswordEncoder;</div><div line="Rfko" data-language="plain" class="ql-code-block"><br></div><div line="RVy3" data-language="plain" class="ql-code-block">@GetMapping("/test/pass")</div><div line="N5Kz" data-language="plain" class="ql-code-block">public Result passEncode() {</div><div line="6G4B" data-language="plain" class="ql-code-block">   // 密码加密</div><div line="M0nG" data-language="plain" class="ql-code-block">   String pass = bCryptPasswordEncoder.encode("111111");</div><div line="rXE6" data-language="plain" class="ql-code-block">   </div><div line="PQxD" data-language="plain" class="ql-code-block">   // 密码验证</div><div line="dBmv" data-language="plain" class="ql-code-block">   boolean matches = bCryptPasswordEncoder.matches("111111", pass);</div><div line="JGdA" data-language="plain" class="ql-code-block">   </div><div line="SpYj" data-language="plain" class="ql-code-block">   return Result.succ(MapUtil.builder()</div><div line="O8u4" data-language="plain" class="ql-code-block">         .put("pass", pass)</div><div line="CD9r" data-language="plain" class="ql-code-block">         .put("marches", matches)</div><div line="p57d" data-language="plain" class="ql-code-block">         .build()</div><div line="EKzb" data-language="plain" class="ql-code-block">   );</div><div line="DHTP" data-language="plain" class="ql-code-block">}</div></div><p line="En6q" style="line-height: 2.5;" linespacing="150">可以看到我密码是111111，加密以及验证的结果如下：<span style="background: #fffffe;color: #0451a5;" class="ql-size-9">$2a$10$R7zegeWzOXPw871CmNuJ6upC0v8D373GuLuTw8jn6NET4BkPRZfgK</span></p><p line="vx4Q"><br></p><p line="OnKn"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="596" height="auto" ori-width="596" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(16).png" style="" ori-height="321" data-src="https://uploader.shimo.im/f/qv3IGr64fzmHjrY6.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="w5Oq"><br></p><p line="R6c3"><br></p><p line="zVkE">data中的那一串字符串就是我们的密码了，可以看到marches也是true，说明密码验证也是正确的，我们添加到我们数据库sys_user表中：</p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="wfvX" data-language="plain" class="ql-code-block">INSERT INTO `vueadmin`.`sys_user` (`id`, `username`, `password`, `avatar`, `email`, `city`, `created`, `updated`, `last_login`, `statu`) VALUES ('1', 'admin', '$2a$10$R7zegeWzOXPw871CmNuJ6upC0v8D373GuLuTw8jn6NET4BkPRZfgK', 'https://image-1300566513.cos.ap-guangzhou.myqcloud.com/upload/images/5a9f48118166308daba8b6da7e466aab.jpg', '123@qq.com', '广州', '2021-01-12 22:13:53', '2021-01-16 16:57:32', '2020-12-30 08:38:37', '1');</div></div><p line="FzkG">后面我们就可以使用admin/111111登录我们的系统哈。</p><p line="JeTv"><br></p><p line="vr1y">但是先我们登录过程系统不是从我们数据库中获取数据的，因此，我们需要重新定义这个查用户数据的过程，我们需要重写UserDetailsService接口。</p><ul data-list-style="circle"><li line="qlEd" class="bullet-item">com.markerhub.security.UserDetailsServiceImpl</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="cQvX" data-language="plain" class="ql-code-block">@Slf4j</div><div line="Khvk" data-language="plain" class="ql-code-block">@Service</div><div line="lkix" data-language="plain" class="ql-code-block">public class UserDetailsServiceImpl implements UserDetailsService {</div><div line="N0kc" data-language="plain" class="ql-code-block"><br></div><div line="FJ1c" data-language="plain" class="ql-code-block">   @Autowired</div><div line="dV7c" data-language="plain" class="ql-code-block">   SysUserService sysUserService;</div><div line="GFiG" data-language="plain" class="ql-code-block">   </div><div line="AlyY" data-language="plain" class="ql-code-block">   @Override</div><div line="Dh7E" data-language="plain" class="ql-code-block">   public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {</div><div line="NnuS" data-language="plain" class="ql-code-block">      SysUser sysUser = sysUserService.getByUsername(username);</div><div line="j7qj" data-language="plain" class="ql-code-block">      if (sysUser == null) {</div><div line="6GBw" data-language="plain" class="ql-code-block">         throw new UsernameNotFoundException("用户名或密码不正确!");</div><div line="w8Sb" data-language="plain" class="ql-code-block">      }</div><div line="JJrP" data-language="plain" class="ql-code-block">      return new AccountUser(sysUser.getId(), sysUser.getUsername(), sysUser.getPassword(), new TreeSet&lt;&gt;());</div><div line="S4Lv" data-language="plain" class="ql-code-block">   }</div><div line="3BRi" data-language="plain" class="ql-code-block">}</div></div><p line="5TS3">因为security在认证用户身份的时候会调用UserDetailsService.loadUserByUsername()方法，因此我们重写了之后security就可以根据我们的流程去查库获取用户了。然后我们把UserDetailsServiceImpl配置到SecurityConfig中：</p><ul data-list-style="circle"><li line="GJGW" class="bullet-item">com.markerhub.config.SecurityConfig</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="V8kf" data-language="plain" class="ql-code-block">@Autowired</div><div line="VmRW" data-language="plain" class="ql-code-block">UserDetailsServiceImpl userDetailsService;</div><div line="nfdk" data-language="plain" class="ql-code-block"><br></div><div line="HjZo" data-language="plain" class="ql-code-block">@Override</div><div line="IUPT" data-language="plain" class="ql-code-block">protected void configure(AuthenticationManagerBuilder auth) throws Exception {</div><div line="8xZh" data-language="plain" class="ql-code-block">   auth.userDetailsService(userDetailsService);</div><div line="X9vb" data-language="plain" class="ql-code-block">}</div></div><p line="cL8u">然后上面UserDetailsService.loadUserByUsername()默认返回的UserDetails，我们自定义了AccountUser去重写了UserDetails，这也是为了后面我们可能会调整用户的一些数据等。</p><ul data-list-style="circle"><li line="H6Ca" class="bullet-item">com.markerhub.security.AccountUser</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="jCts" data-language="plain" class="ql-code-block">public class AccountUser implements UserDetails {</div><div line="NRM2" data-language="plain" class="ql-code-block">   private Long userId;</div><div line="5L84" data-language="plain" class="ql-code-block">   private String password;</div><div line="qOi8" data-language="plain" class="ql-code-block">   private final String username;</div><div line="gYt0" data-language="plain" class="ql-code-block">   private final Collection&lt;? extends GrantedAuthority&gt; authorities;</div><div line="7Bxk" data-language="plain" class="ql-code-block">   private final boolean accountNonExpired;</div><div line="M2fo" data-language="plain" class="ql-code-block">   private final boolean accountNonLocked;</div><div line="vLJA" data-language="plain" class="ql-code-block">   private final boolean credentialsNonExpired;</div><div line="lw2D" data-language="plain" class="ql-code-block">   private final boolean enabled;</div><div line="5p2i" data-language="plain" class="ql-code-block">   public AccountUser(Long userId, String username, String password, Collection&lt;? extends GrantedAuthority&gt; authorities) {</div><div line="Ou1N" data-language="plain" class="ql-code-block">      this(userId, username, password, true, true, true, true, authorities);</div><div line="nX2o" data-language="plain" class="ql-code-block">   }</div><div line="7qLU" data-language="plain" class="ql-code-block">   public AccountUser(Long userId, String username, String password, boolean enabled,</div><div line="Ay1c" data-language="plain" class="ql-code-block">                      boolean accountNonExpired, boolean credentialsNonExpired, boolean accountNonLocked,</div><div line="MyiA" data-language="plain" class="ql-code-block">                      Collection&lt;? extends GrantedAuthority&gt; authorities) {</div><div line="gxzu" data-language="plain" class="ql-code-block">      Assert.isTrue(username != null &amp;&amp; !"".equals(username) &amp;&amp; password != null, "Cannot pass null or empty values to constructor");</div><div line="GInr" data-language="plain" class="ql-code-block">      this.userId = userId;</div><div line="Wx6J" data-language="plain" class="ql-code-block">      this.username = username;</div><div line="9K3G" data-language="plain" class="ql-code-block">      this.password = password;</div><div line="ryrg" data-language="plain" class="ql-code-block">      this.enabled = enabled;</div><div line="urlJ" data-language="plain" class="ql-code-block">      this.accountNonExpired = accountNonExpired;</div><div line="2jGe" data-language="plain" class="ql-code-block">      this.credentialsNonExpired = credentialsNonExpired;</div><div line="Hlft" data-language="plain" class="ql-code-block">      this.accountNonLocked = accountNonLocked;</div><div line="3Psm" data-language="plain" class="ql-code-block">      this.authorities = authorities;</div><div line="aZZG" data-language="plain" class="ql-code-block">   }</div><div line="MOsZ" data-language="plain" class="ql-code-block">   public Long getUserId() {</div><div line="CNQ4" data-language="plain" class="ql-code-block">      return userId;</div><div line="K6ZU" data-language="plain" class="ql-code-block">   }</div><div line="KMYx" data-language="plain" class="ql-code-block">   ...  </div><div line="Cl7A" data-language="plain" class="ql-code-block">}</div></div><p line="Bn21">其实数据基本没变，我就添加多了一个用户的id而已。</p><p line="TiV3"><br></p><p line="3ndX">ok，万事俱备，我们再次尝试去登录，看能不能登录成功。</p><p line="mrpq"><br></p><p line="mZ0G">1、获取验证码：</p><p line="EmZv"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="450" height="auto" ori-width="450" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(17).png" style="" ori-height="607" data-src="https://uploader.shimo.im/f/mUiYvXEck1ZlzjEO.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="oAWp"><br></p><p line="HNv2">2、从控制台获取到对应的验证码</p><p line="Sz4W"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="535" height="auto" ori-width="535" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(18).png" style="" ori-height="60" data-src="https://uploader.shimo.im/f/IDfd6YRVwnhFg1Np.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="TZLG"><br></p><p line="7t1S">3、提交登录表单</p><p line="z7tr"><br></p><p line="w5ly"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="557" height="auto" ori-width="557" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(19).png" style="" ori-height="519" data-src="https://uploader.shimo.im/f/4hHx2Xvl4JdcBBsU.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="oi8E"><br></p><p line="ZD24"><br></p><p line="nAMB">4、登录成功，并在请求头中获取到了Authorization，也就是JWT。完美！！</p><p line="D4zi"><br></p><h4><div line="rzqS" data-header="4" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>解决授权</div></h4><p line="Gyit">然后关于权限部分，也是security的重要功能，当用户认证成功之后，我们就知道谁在访问系统接口，这是又有一个问题，就是这个用户有没有权限来访问我们这个接口呢，要解决这个问题，我们需要知道用户有哪些权限，哪些角色，这样security才能我们做权限判断。</p><p line="LOIK"><br></p><p line="X1kv">之前我们已经定义及几张表，用户、角色、菜单、以及一些关联表，一般当权限粒度比较细的时候，我们都通过判断用户有没有此菜单或操作的权限，而不是通过角色判断，而用户和菜单是不直接做关联的，是通过用户拥有哪些角色，然后角色拥有哪些菜单权限这样来获得的。</p><p line="IMZn"><br></p><p line="HEqt">问题1：我们是在哪里赋予用户权限的？有两个地方：</p><ul data-list-style="circle"><li line="krTl" class="bullet-item">1、用户登录，调用调用UserDetailsService.loadUserByUsername()方法时候可以返回用户的权限信息。</li></ul><ul data-list-style="circle"><li line="QREX" class="bullet-item">2、接口调用进行身份认证过滤器时候JWTAuthenticationFilter，需要返回用户权限信息</li></ul><p line="afSI"><br></p><p line="aFG1">问题2：在哪里决定什么接口需要什么权限？</p><p line="1xnS">Security内置的权限注解：</p><ul data-list-style="circle"><li line="0kHj" class="bullet-item ql-size-11"><span class="ql-size-11">@PreAuthorize：方法执行前进行权限检查</span></li></ul><ul data-list-style="circle"><li line="NKH0" class="bullet-item ql-size-11"><span class="ql-size-11">@PostAuthorize：方法执行后进行权限检查</span></li></ul><ul data-list-style="circle"><li line="Zv0E" class="bullet-item ql-size-11"><span class="ql-size-11">@Secured：类似于 @PreAuthorize</span></li></ul><p line="6VkB">可以在Controller的方法前添加这些注解表示接口需要什么权限。</p><p line="X0e7"><br></p><p line="M7LV">比如需要Admin角色权限：</p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="weWN" data-language="plain" class="ql-code-block">@PreAuthorize("hasRole('admin')")</div></div><p line="jCzm">比如需要添加管理员的操作权限</p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="DOVM" data-language="plain" class="ql-code-block">@PreAuthorize("hasAuthority('sys:user:save')")</div></div><p line="KIRr"><br></p><p line="gEXY">ok，我们再来整体梳理一下授权、验证权限的流程：</p><ol data-list-style="decimal"><li line="i292" data-list-number="1" data-list-content="1." class="ordered-item">用户登录或者调用接口时候识别到用户，并获取到用户的权限信息</li></ol><ol data-list-style="decimal"><li line="df0o" data-list-number="2" data-list-content="2." class="ordered-item">注解标识Controller中的方法需要的权限或角色</li></ol><ol data-list-style="decimal"><li line="QzBd" data-list-number="3" data-list-content="3." class="ordered-item">Security通过FilterSecurityInterceptor匹配URI和权限是否匹配</li></ol><ol data-list-style="decimal"><li line="BFnQ" data-list-number="4" data-list-content="4." class="ordered-item">有权限则可以访问接口，当无权限的时候返回异常交给AccessDeniedHandler操作类处理</li></ol><p line="18Mg"><br></p><p line="hbE9">ok，流程清晰之后我们就开始我们的编码：</p><ul data-list-style="circle"><li line="akWn" class="bullet-item">UserDetailsServiceImpl</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="ubZa" data-language="plain" class="ql-code-block">@Override</div><div line="hWUS" data-language="plain" class="ql-code-block">public UserDetails loadUserByUsername(String username) throws UsernameNotFoundException {</div><div line="Foqi" data-language="plain" class="ql-code-block"><br></div><div line="3MDf" data-language="plain" class="ql-code-block">   ...   </div><div line="cPY4" data-language="plain" class="ql-code-block"><br></div><div line="zDbz" data-language="plain" class="ql-code-block">   return new AccountUser(sysUser.getId(), sysUser.getUsername(), sysUser.getPassword(), getUserAuthority(sysUser.getId()));</div><div line="zDza" data-language="plain" class="ql-code-block">}</div><div line="T5r8" data-language="plain" class="ql-code-block"><br></div><div line="vu6L" data-language="plain" class="ql-code-block">public List&lt;GrantedAuthority&gt; getUserAuthority(Long userId) {</div><div line="Ry9O" data-language="plain" class="ql-code-block">   // 通过内置的工具类，把权限字符串封装成GrantedAuthority列表</div><div line="IwWE" data-language="plain" class="ql-code-block">   return  AuthorityUtils.commaSeparatedStringToAuthorityList(</div><div line="5LM0" data-language="plain" class="ql-code-block">         sysUserService.getUserAuthorityInfo(userId)</div><div line="6DPu" data-language="plain" class="ql-code-block">   );</div><div line="58s5" data-language="plain" class="ql-code-block">}</div></div><ul data-list-style="circle"><li line="WxGj" class="bullet-item">com.markerhub.security.JWTAuthenticationFilter</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="SP7f" data-language="plain" class="ql-code-block">SysUser sysUser = sysUserService.getByUsername(username);</div><div line="Jihh" data-language="plain" class="ql-code-block">List&lt;GrantedAuthority&gt; grantedAuthorities = userDetailsService.getUserAuthority(sysUser.getId());</div><div line="VZQ4" data-language="plain" class="ql-code-block">UsernamePasswordAuthenticationToken usernamePasswordAuthenticationToken</div><div line="yxjD" data-language="plain" class="ql-code-block">      = new UsernamePasswordAuthenticationToken(username, null, grantedAuthorities);</div><div line="ifwn" data-language="plain" class="ql-code-block"><br></div></div><p line="1M29">代码中的com.markerhub.service.impl.SysUserServiceImpl#getUserAuthorityInfo是重点：</p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="MKLV" data-language="plain" class="ql-code-block">@Slf4j</div><div line="Q8n6" data-language="plain" class="ql-code-block">@Service</div><div line="15C4" data-language="plain" class="ql-code-block">public class SysUserServiceImpl extends ServiceImpl&lt;SysUserMapper, SysUser&gt; implements SysUserService {</div><div line="tNW7" data-language="plain" class="ql-code-block"><br></div><div line="ST7Y" data-language="plain" class="ql-code-block">   ... </div><div line="viRz" data-language="plain" class="ql-code-block"><br></div><div line="fEl3" data-language="plain" class="ql-code-block">   @Override</div><div line="ENWD" data-language="plain" class="ql-code-block">   public String getUserAuthorityInfo(Long userId) {</div><div line="QSWk" data-language="plain" class="ql-code-block">      SysUser sysUser = this.getById(userId);</div><div line="ozqC" data-language="plain" class="ql-code-block">      String authority = null;</div><div line="NgvJ" data-language="plain" class="ql-code-block">      </div><div line="vDSh" data-language="plain" class="ql-code-block">      if (redisUtil.hasKey("GrantedAuthority:" + sysUser.getUsername())) {</div><div line="3b0w" data-language="plain" class="ql-code-block">         // 优先从缓存获取</div><div line="4RZh" data-language="plain" class="ql-code-block">         authority = (String)redisUtil.get("GrantedAuthority:" + sysUser.getUsername());</div><div line="oDHK" data-language="plain" class="ql-code-block">         </div><div line="R8Qa" data-language="plain" class="ql-code-block">      } else {</div><div line="BEdJ" data-language="plain" class="ql-code-block">      </div><div line="UP5Y" data-language="plain" class="ql-code-block">         List&lt;SysRole&gt; roles = sysRoleService.list(new QueryWrapper&lt;SysRole&gt;()</div><div line="9dWB" data-language="plain" class="ql-code-block">               .inSql("id", "select role_id from sys_user_role where user_id = " + userId));</div><div line="mBgS" data-language="plain" class="ql-code-block">         List&lt;Long&gt; menuIds = sysUserMapper.getNavMenuIds(userId);</div><div line="5bEc" data-language="plain" class="ql-code-block">         List&lt;SysMenu&gt; menus = sysMenuService.listByIds(menuIds);</div><div line="kGxi" data-language="plain" class="ql-code-block">         </div><div line="inMy" data-language="plain" class="ql-code-block">         String roleNames = roles.stream().map(r -&gt; "ROLE_" + r.getCode()).collect(Collectors.joining(","));</div><div line="AeEx" data-language="plain" class="ql-code-block">         String permNames = menus.stream().map(m -&gt; m.getPerms()).collect(Collectors.joining(","));</div><div line="en79" data-language="plain" class="ql-code-block">         </div><div line="prXO" data-language="plain" class="ql-code-block">         authority = roleNames.concat(",").concat(permNames);</div><div line="KDqY" data-language="plain" class="ql-code-block">         log.info("用户ID - {} ---拥有的权限：{}", userId, authority);</div><div line="MUVV" data-language="plain" class="ql-code-block">         </div><div line="8ikF" data-language="plain" class="ql-code-block">         redisUtil.set("GrantedAuthority:" + sysUser.getUsername(), authority, 60*60);</div><div line="LbEv" data-language="plain" class="ql-code-block">         </div><div line="9Eg5" data-language="plain" class="ql-code-block">      }</div><div line="RHka" data-language="plain" class="ql-code-block">      return authority;</div><div line="gAFA" data-language="plain" class="ql-code-block">   }</div><div line="dVyb" data-language="plain" class="ql-code-block">}</div></div><p line="e63J">可以看到，我通过用户id分别获取到用户的角色信息和菜单信息，然后通过逗号链接起来，因为角色信息我们需要这样“ROLE_”+角色，所以才有了上面的写法：</p><p line="0yN2"><br></p><p line="Kt3X">比如用户拥有Admin角色和添加用户权限，则最后的字符串是：<strong>ROLE_admin,sys:user:save</strong>。</p><p line="K0gk"><br></p><p line="aVJg">同时为了避免多次查库，我做了一层缓存，这里理解应该不难。</p><p line="t94h"><br></p><p line="DSLS">然后sysUserMapper.getNavMenuIds(userId)因为要查询数据库，具体SQL如下：</p><ul data-list-style="circle"><li line="ecAc" class="bullet-item">com.markerhub.mapper.SysUserMapper#getNavMenuIds</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="3GEG" data-language="plain" class="ql-code-block">&lt;select id="getNavMenuIds" resultType="java.lang.Long"&gt;</div><div line="L85k" data-language="plain" class="ql-code-block">    SELECT</div><div line="34Pf" data-language="plain" class="ql-code-block">        DISTINCT rm.menu_id</div><div line="XfdW" data-language="plain" class="ql-code-block">    FROM</div><div line="45Ry" data-language="plain" class="ql-code-block">        sys_user_role ur</div><div line="8B7d" data-language="plain" class="ql-code-block">    LEFT JOIN `sys_role_menu` rm ON rm.role_id = ur.role_id</div><div line="EwO2" data-language="plain" class="ql-code-block">    WHERE</div><div line="DuuS" data-language="plain" class="ql-code-block">        ur.user_id = #{userId};</div><div line="ULtK" data-language="plain" class="ql-code-block">&lt;/select&gt;</div></div><p line="N6iD">上面表示通过用户ID获取用户关联的菜单的id，因此需要用到两个中间表的关联了。</p><p line="Ykhn"><br></p><p line="T4x3">ok，这样我们就赋予了用户角色和操作权限了。后面我们只需要在Controller添加上具体注解表示需要的权限，Security就会自动帮我们自动完成权限校验了。</p><p line="1koh"><br></p><h4><div line="Juaj" data-header="4" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>权限缓存</div></h4><p line="BNee">因为上面我在获取用户权限那里添加了个缓存，这时候问题来了，就是权限缓存的实时更新问题，比如当后台更新某个管理员的权限角色信息的时候如果权限缓存信息没有实时更新，就会出现操作无效的问题，那么我们现在点定义几个方法，用于清除某个用户或角色或者某个菜单的权限的方法：</p><ul data-list-style="circle"><li line="jmmV" class="bullet-item">com.markerhub.service.impl.SysUserServiceImpl</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="dBC7" data-language="plain" class="ql-code-block">// 删除某个用户的权限信息</div><div line="e6Yy" data-language="plain" class="ql-code-block">@Override</div><div line="SovV" data-language="plain" class="ql-code-block">public void clearUserAuthorityInfo(String username) {</div><div line="fVJB" data-language="plain" class="ql-code-block">   redisUtil.del("GrantedAuthority:" + username);</div><div line="7fjv" data-language="plain" class="ql-code-block">}</div><div line="bhW1" data-language="plain" class="ql-code-block"><br></div><div line="MExh" data-language="plain" class="ql-code-block">// 删除所有与该角色关联的用户的权限信息</div><div line="IDTP" data-language="plain" class="ql-code-block">@Override</div><div line="i65U" data-language="plain" class="ql-code-block">public void clearUserAuthorityInfoByRoleId(Long roleId) {</div><div line="X2JH" data-language="plain" class="ql-code-block">   List&lt;SysUser&gt; sysUsers = this.list(new QueryWrapper&lt;SysUser&gt;()</div><div line="EzHy" data-language="plain" class="ql-code-block">         .inSql("id", "select user_id from sys_user_role where role_id = " + roleId)</div><div line="cyg1" data-language="plain" class="ql-code-block">   );</div><div line="JCW3" data-language="plain" class="ql-code-block">   sysUsers.forEach(u -&gt; {</div><div line="Ed6Q" data-language="plain" class="ql-code-block">      this.clearUserAuthorityInfo(u.getUsername());</div><div line="KfPB" data-language="plain" class="ql-code-block">   });</div><div line="6mal" data-language="plain" class="ql-code-block">}</div><div line="HgEC" data-language="plain" class="ql-code-block"><br></div><div line="IqUF" data-language="plain" class="ql-code-block">// 删除所有与该菜单关联的所有用户的权限信息</div><div line="Hp9C" data-language="plain" class="ql-code-block">@Override</div><div line="ePDZ" data-language="plain" class="ql-code-block">public void clearUserAuthorityInfoByMenuId(Long menuId) {</div><div line="Zrdd" data-language="plain" class="ql-code-block">   List&lt;SysUser&gt; sysUsers = sysUserMapper.listByMenuId(menuId);</div><div line="Wqjx" data-language="plain" class="ql-code-block">   sysUsers.forEach(u -&gt; {</div><div line="9O6a" data-language="plain" class="ql-code-block">      this.clearUserAuthorityInfo(u.getUsername());</div><div line="iCmQ" data-language="plain" class="ql-code-block">   });</div><div line="S44g" data-language="plain" class="ql-code-block">}</div></div><p line="3dnA">上面最后一个方法查到了与菜单关联的所有用户的，具体sql如下：</p><ul data-list-style="circle"><li line="osmV" class="bullet-item">com.markerhub.mapper.SysUserMapper#listByMenuId</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="vmUC" data-language="plain" class="ql-code-block">&lt;select id="listByMenuId" resultType="com.javacat.entity.SysUser"&gt;</div><div line="7ZG8" data-language="plain" class="ql-code-block">    SELECT</div><div line="GHwk" data-language="plain" class="ql-code-block">    DISTINCT</div><div line="VV9S" data-language="plain" class="ql-code-block">        su.*</div><div line="UlC7" data-language="plain" class="ql-code-block">    FROM</div><div line="nkhI" data-language="plain" class="ql-code-block">        sys_user_role ur</div><div line="DTMU" data-language="plain" class="ql-code-block">    LEFT JOIN `sys_role_menu` rm ON rm.role_id = ur.role_id</div><div line="lber" data-language="plain" class="ql-code-block">    LEFT JOIN `sys_user` su ON su.id = ur.user_id</div><div line="kyif" data-language="plain" class="ql-code-block">    WHERE</div><div line="BgeD" data-language="plain" class="ql-code-block">        rm.menu_id = #{menuId};</div><div line="RoXT" data-language="plain" class="ql-code-block">&lt;/select&gt;</div></div><p line="zVtU">有了这几个方法之后，在哪里调用？这就简单了，在更新、删除角色权限、更新、删除菜单的时候调用，虽然我们现在还没写到这几个方法，后续我们再写增删改查的时候记得加上就行啦。</p><p line="YYdm"><br></p><h4><div line="SApx" data-header="4" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>退出数据返回</div></h4><p line="txgn">jwt -username</p><p line="7gnl">token - 随机码 - redis</p><p line="qhMK"><br></p><ul data-list-style="circle"><li line="KZpL" class="bullet-item">com.markerhub.security.JwtLogoutSuccessHandler</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="iJty" data-language="plain" class="ql-code-block">@Component</div><div line="pJzX" data-language="plain" class="ql-code-block">public class JwtLogoutSuccessHandler implements LogoutSuccessHandler {</div><div line="SBYn" data-language="plain" class="ql-code-block">   @Autowired</div><div line="jjQC" data-language="plain" class="ql-code-block">   JwtUtils jwtUtils;</div><div line="EXeo" data-language="plain" class="ql-code-block">   @Override</div><div line="OJQk" data-language="plain" class="ql-code-block">   public void onLogoutSuccess(HttpServletRequest request, HttpServletResponse response, Authentication authentication)</div><div line="ap7p" data-language="plain" class="ql-code-block">         throws IOException, ServletException {</div><div line="tPCJ" data-language="plain" class="ql-code-block">      if (authentication != null) {</div><div line="Tmvg" data-language="plain" class="ql-code-block">         new SecurityContextLogoutHandler().logout(request, response, authentication);</div><div line="RBHb" data-language="plain" class="ql-code-block">      }</div><div line="99eN" data-language="plain" class="ql-code-block">      response.setContentType("application/json;charset=UTF-8");</div><div line="KaVd" data-language="plain" class="ql-code-block">      response.setHeader(jwtUtils.getHeader(), "");</div><div line="hN9q" data-language="plain" class="ql-code-block">      ServletOutputStream out = response.getOutputStream();</div><div line="PhJx" data-language="plain" class="ql-code-block">      Result result = Result.succ("");</div><div line="z4ul" data-language="plain" class="ql-code-block">      out.write(JSONUtil.toJsonStr(result).getBytes("UTF-8"));</div><div line="UDXx" data-language="plain" class="ql-code-block">      out.flush();</div><div line="8pwa" data-language="plain" class="ql-code-block">      out.close();</div><div line="qEzQ" data-language="plain" class="ql-code-block">   }</div><div line="ZLBM" data-language="plain" class="ql-code-block"><br></div></div><p line="0czY"><br></p><h4><div line="Lbe2" data-header="4" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>无权限数据返回</div></h4><ul data-list-style="circle"><li line="aGFM" class="bullet-item">com.markerhub.security.JwtAccessDeniedHandler</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="x0mv" data-language="plain" class="ql-code-block">@Slf4j</div><div line="yMfy" data-language="plain" class="ql-code-block">@Component</div><div line="kni9" data-language="plain" class="ql-code-block">public class JwtAccessDeniedHandler implements AccessDeniedHandler {</div><div line="DIcu" data-language="plain" class="ql-code-block">   @Override</div><div line="sl3E" data-language="plain" class="ql-code-block">   public void handle(HttpServletRequest request, HttpServletResponse response, AccessDeniedException accessDeniedException)</div><div line="MjpS" data-language="plain" class="ql-code-block">         throws IOException, ServletException {</div><div line="1l5D" data-language="plain" class="ql-code-block">//    response.sendError(HttpServletResponse.SC_FORBIDDEN, accessDeniedException.getMessage());</div><div line="uoTP" data-language="plain" class="ql-code-block">      log.info("权限不够！！");</div><div line="AczV" data-language="plain" class="ql-code-block">      response.setContentType("application/json;charset=UTF-8");</div><div line="6hML" data-language="plain" class="ql-code-block">      response.setStatus(HttpServletResponse.SC_FORBIDDEN);</div><div line="Awdj" data-language="plain" class="ql-code-block">      ServletOutputStream outputStream = response.getOutputStream();</div><div line="zJrL" data-language="plain" class="ql-code-block">      Result result = Result.fail(accessDeniedException.getMessage());</div><div line="vtqL" data-language="plain" class="ql-code-block">      outputStream.write(JSONUtil.toJsonStr(result).getBytes("UTF-8"));</div><div line="hb7H" data-language="plain" class="ql-code-block">      outputStream.flush();</div><div line="TODL" data-language="plain" class="ql-code-block">      outputStream.close();</div><div line="JBA9" data-language="plain" class="ql-code-block">   }</div><div line="MvAw" data-language="plain" class="ql-code-block">}</div></div><p line="0eih"><br></p><p line="dS39">致此，SpringSecurity就已经完美整合到了我们的项目中来了。</p><h3><div line="F9oq" data-header="3" data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span><br></div></h3><ol data-list-style="decimal"><li class="ordered-item ql-heading-3" line="NZ56" data-list-number="7" data-list-content="7." data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>解决跨域问题</li></ol><p line="OihI">上面的调试我们都是使用的postman，如果我们和前端进行对接的时候，会出现跨域的问题，如何解决？</p><ul data-list-style="circle"><li line="AvqB" class="bullet-item">com.markerhub.config.CorsConfig</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="Fptf" data-language="plain" class="ql-code-block">@Configuration</div><div line="qyDE" data-language="plain" class="ql-code-block">public class CorsConfig implements WebMvcConfigurer {</div><div line="V9rt" data-language="plain" class="ql-code-block"><br></div><div line="QYLT" data-language="plain" class="ql-code-block">   private CorsConfiguration buildConfig() {</div><div line="QFoi" data-language="plain" class="ql-code-block">      CorsConfiguration corsConfiguration = new CorsConfiguration();</div><div line="R2eC" data-language="plain" class="ql-code-block">      corsConfiguration.addAllowedOrigin("*");</div><div line="if9F" data-language="plain" class="ql-code-block">      corsConfiguration.addAllowedHeader("*");</div><div line="bsER" data-language="plain" class="ql-code-block">      corsConfiguration.addAllowedMethod("*");</div><div line="4nJ5" data-language="plain" class="ql-code-block">      corsConfiguration.addExposedHeader("Authorization");</div><div line="4vBb" data-language="plain" class="ql-code-block">      return corsConfiguration;</div><div line="2TeL" data-language="plain" class="ql-code-block">   }</div><div line="SKf8" data-language="plain" class="ql-code-block">   </div><div line="RHCb" data-language="plain" class="ql-code-block">   @Bean</div><div line="OFxU" data-language="plain" class="ql-code-block">   public CorsFilter corsFilter() {</div><div line="wSq6" data-language="plain" class="ql-code-block">      UrlBasedCorsConfigurationSource source = new UrlBasedCorsConfigurationSource();</div><div line="Gn2I" data-language="plain" class="ql-code-block">      source.registerCorsConfiguration("/**", buildConfig());</div><div line="lFB0" data-language="plain" class="ql-code-block">      return new CorsFilter(source);</div><div line="pyM4" data-language="plain" class="ql-code-block">   }</div><div line="2Mf2" data-language="plain" class="ql-code-block">   </div><div line="QgDs" data-language="plain" class="ql-code-block">   @Override</div><div line="ZGwl" data-language="plain" class="ql-code-block">   public void addCorsMappings(CorsRegistry registry) {</div><div line="t1oi" data-language="plain" class="ql-code-block">      registry.addMapping("/**")</div><div line="AnkM" data-language="plain" class="ql-code-block">            .allowedOrigins("*")</div><div line="gwsM" data-language="plain" class="ql-code-block">//          .allowCredentials(true)</div><div line="l7bx" data-language="plain" class="ql-code-block">            .allowedMethods("GET", "POST", "DELETE", "PUT")</div><div line="YXPD" data-language="plain" class="ql-code-block">            .maxAge(3600);</div><div line="r0JH" data-language="plain" class="ql-code-block">   }</div><div line="dPPF" data-language="plain" class="ql-code-block">}</div></div><p line="lpLr"><br></p><ol data-list-style="decimal"><li class="ordered-item ql-heading-3" line="iMYW" data-list-number="8" data-list-content="8." data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>前后端对接的问题</li></ol><p line="grlr"><br></p><p line="Eo8F">因为我们之前开发前端的时候，我们都是使用mockjs返回随机数据的，一般来说问题不会很大，我就怕有些同学再去掉mock之后，和后端对接却显示不出数据，这就尴尬了。这时候我建议你去看我的开发视频哈。</p><p line="E18C"><br></p><p line="1p7M">后面因为都是接口的增删改查，难度其实不是特别大，所以大部分时候我都会直接贴代码，如果想看手把手教程，还是去看我的教学视频哈，B站搜索MarkerHub就可以啦，公众号也是叫MarkerHub。</p><p line="4vTB"><br></p><ol data-list-style="decimal"><li class="ordered-item ql-heading-3" line="do6V" data-list-number="9" data-list-content="9." data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>菜单接口开发</li></ol><p line="JpP4"><br></p><p line="jZ4v">我们先来开发菜单的接口，因为这3个表：用户表、角色表、菜单表，才有菜单表是不需要通过其他表来获取信息的。比如用户需要关联角色，角色需要关联菜单，而菜单不需要主动关联其他表。因此菜单表的增删改查是最简单的。</p><p line="UaUT"><br></p><p line="X4ll">再回到我们的前端项目，登录完成之后我们通过JWT获取项目的导航菜单和权限，那么接下来我们就先编写这个接口。</p><p line="STBE"><br></p><p line="jmEt">获取菜单导航和权限的链接是/sys/menu/nav，然后我们的菜单导航的json数据应该是这样的：</p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="qFGx" data-language="plain" class="ql-code-block">{</div><div line="qzCV" data-language="plain" class="ql-code-block">   title: '角色管理',</div><div line="9GFW" data-language="plain" class="ql-code-block">   icon: 'el-icon-rank',</div><div line="VUkc" data-language="plain" class="ql-code-block">   path: '/sys/roles',</div><div line="0qM5" data-language="plain" class="ql-code-block">   name: 'SysRoles',</div><div line="Rzb6" data-language="plain" class="ql-code-block">   component: 'sys/Role',</div><div line="pEGq" data-language="plain" class="ql-code-block">   children: []</div><div line="ctU2" data-language="plain" class="ql-code-block">}</div></div><p line="I6P5">然后返回的权限数据应该是个数组：</p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="EHvl" data-language="plain" class="ql-code-block">["sys:menu:list","sys:menu:save","sys:user:list"...]</div></div><p line="g84Y">注意导航菜单那里有个children，也就是子菜单，是个树形结构，因为我们的菜单可能这样：</p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="Fos4" data-language="plain" class="ql-code-block">系统管理 - 菜单管理 - 添加菜单</div></div><p line="KmNV">可以看到这就已经有3级了菜单了。</p><p line="4e5p"><br></p><p line="6LV3">所以在打代码时候要注意这个关系的关联。我们的SysMenu实体类中有个parentId，但是没有children，因此我们可以在SysMenu中添加一个children，当然了其实不添加也可以，因为我们也需要一个dto，这样我们才能按照上面json数据格式返回。</p><p line="J4Rd"><br></p><p line="77h0">我们还是来添加一个children吧：</p><ul data-list-style="circle"><li line="GCbD" class="bullet-item">com.markerhub.entity.SysMenu</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="TcAD" data-language="plain" class="ql-code-block">@Data</div><div line="anqA" data-language="plain" class="ql-code-block">@EqualsAndHashCode(callSuper = true)</div><div line="Q4cM" data-language="plain" class="ql-code-block">public class SysMenu extends BaseEntity {</div><div line="Q2Xf" data-language="plain" class="ql-code-block"><br></div><div line="6vEZ" data-language="plain" class="ql-code-block">   ...</div><div line="5g7u" data-language="plain" class="ql-code-block"><br></div><div line="hyGU" data-language="plain" class="ql-code-block">   @TableField(exist = false)</div><div line="ZNgz" data-language="plain" class="ql-code-block">   private List&lt;SysMenu&gt; children = new ArrayList&lt;&gt;();</div><div line="Qxlr" data-language="plain" class="ql-code-block">}</div></div><p line="BTPA">然后我们也先来定义一个SysMenuDto吧，知道要返回什么样的数据，我们就只需要去填充数据就好了</p><ul data-list-style="circle"><li line="uAiC" class="bullet-item">com.markerhub.common.dto.SysMenuDto</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="wICE" data-language="plain" class="ql-code-block">@Data</div><div line="0wfi" data-language="plain" class="ql-code-block">public class SysMenuDto implements Serializable {</div><div line="3dze" data-language="plain" class="ql-code-block">   private Long id;</div><div line="Ht5q" data-language="plain" class="ql-code-block">   private String title;</div><div line="aIEY" data-language="plain" class="ql-code-block">   private String icon;</div><div line="gjPO" data-language="plain" class="ql-code-block">   private String path;</div><div line="bIHW" data-language="plain" class="ql-code-block">   private String name;</div><div line="73CM" data-language="plain" class="ql-code-block">   private String component;</div><div line="0iRq" data-language="plain" class="ql-code-block">   List&lt;SysMenuDto&gt; children = new ArrayList&lt;&gt;();</div><div line="jOrU" data-language="plain" class="ql-code-block">}</div></div><p line="homb">ok，我们来开始我们的编码</p><ul data-list-style="circle"><li line="Pc9s" class="bullet-item">com.markerhub.controller.SysMenuController#nav</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="1tQT" data-language="plain" class="ql-code-block">/**</div><div line="y5fm" data-language="plain" class="ql-code-block"> * 获取当前用户的菜单栏以及权限</div><div line="DXdm" data-language="plain" class="ql-code-block"> */</div><div line="gYtT" data-language="plain" class="ql-code-block">@GetMapping("/nav")</div><div line="HXVP" data-language="plain" class="ql-code-block">public Result nav(Principal principal) {</div><div line="7VAz" data-language="plain" class="ql-code-block">   String username = principal.getName();</div><div line="CdHY" data-language="plain" class="ql-code-block">   SysUser sysUser = sysUserService.getByUsername(username);</div><div line="LR9p" data-language="plain" class="ql-code-block">   // ROLE_Admin,sys:user:save</div><div line="rqIP" data-language="plain" class="ql-code-block">   String[] authoritys = StringUtils.tokenizeToStringArray(</div><div line="EfnG" data-language="plain" class="ql-code-block">         sysUserService.getUserAuthorityInfo(sysUser.getId())</div><div line="tppz" data-language="plain" class="ql-code-block">         , ",");</div><div line="71rg" data-language="plain" class="ql-code-block">   return Result.succ(</div><div line="ZLjm" data-language="plain" class="ql-code-block">         MapUtil.builder()</div><div line="m8w5" data-language="plain" class="ql-code-block">               .put("nav", sysMenuService.getcurrentUserNav())</div><div line="i8eQ" data-language="plain" class="ql-code-block">               .put("authoritys", authoritys)</div><div line="Ly9q" data-language="plain" class="ql-code-block">               .map()</div><div line="8G0U" data-language="plain" class="ql-code-block">   );</div><div line="VDZy" data-language="plain" class="ql-code-block">}</div></div><p line="Zmam">方法中Principal principal表示注入当前用户的信息，getName就可以获取当当前用户的用户名了。sysUserService.getUserAuthorityInfo方法我们之前已经说过了，就在我们登录完成或者身份认证时候需要返回用户权限时候编写的。然后通过StringUtils.tokenizeToStringArray把字符串通过逗号分开组成数组形式。</p><p line="Z8nj"><br></p><p line="rJ7U">重点在与sysMenuService.getcurrentUserNav，获取当前用户的菜单导航，</p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="Xyuf" data-language="plain" class="ql-code-block">@Service</div><div line="1N9o" data-language="plain" class="ql-code-block">public class SysMenuServiceImpl extends ServiceImpl&lt;SysMenuMapper, SysMenu&gt; implements SysMenuService {</div><div line="bvkT" data-language="plain" class="ql-code-block"><br></div><div line="koTv" data-language="plain" class="ql-code-block">   ...</div><div line="aHtJ" data-language="plain" class="ql-code-block">   </div><div line="Fifs" data-language="plain" class="ql-code-block">   /**</div><div line="ucAG" data-language="plain" class="ql-code-block">    * 获取当前用户菜单导航</div><div line="HKVy" data-language="plain" class="ql-code-block">    */</div><div line="VKB0" data-language="plain" class="ql-code-block">   @Override</div><div line="AUyq" data-language="plain" class="ql-code-block">   public List&lt;SysMenuDto&gt; getcurrentUserNav() {</div><div line="R46m" data-language="plain" class="ql-code-block">      String username = (String) SecurityContextHolder.getContext().getAuthentication().getPrincipal();</div><div line="j4NA" data-language="plain" class="ql-code-block">      </div><div line="MIk9" data-language="plain" class="ql-code-block">      SysUser sysUser = sysUserService.getByUsername(username);</div><div line="ewZZ" data-language="plain" class="ql-code-block">      </div><div line="ASKG" data-language="plain" class="ql-code-block">      // 获取用户的所有菜单</div><div line="ByMZ" data-language="plain" class="ql-code-block">      List&lt;Long&gt; menuIds = sysUserMapper.getNavMenuIds(sysUser.getId());</div><div line="Ejke" data-language="plain" class="ql-code-block">      </div><div line="ILrA" data-language="plain" class="ql-code-block">      List&lt;SysMenu&gt; menus = buildTreeMenu(this.listByIds(menuIds));</div><div line="UTlg" data-language="plain" class="ql-code-block">      return convert(menus);</div><div line="V12g" data-language="plain" class="ql-code-block">   }</div><div line="peQy" data-language="plain" class="ql-code-block">   </div><div line="Ikqd" data-language="plain" class="ql-code-block">   /**</div><div line="m0iZ" data-language="plain" class="ql-code-block">    * 把list转成树形结构的数据</div><div line="ZHtE" data-language="plain" class="ql-code-block">    */</div><div line="RGVu" data-language="plain" class="ql-code-block">   private List&lt;SysMenu&gt; buildTreeMenu(List&lt;SysMenu&gt; menus){</div><div line="ZsWE" data-language="plain" class="ql-code-block">      List&lt;SysMenu&gt; finalMenus = new ArrayList&lt;&gt;();</div><div line="YExx" data-language="plain" class="ql-code-block">      for (SysMenu menu : menus) {</div><div line="Wc2D" data-language="plain" class="ql-code-block">      </div><div line="85RX" data-language="plain" class="ql-code-block">         // 先寻找各自的孩子</div><div line="Cit5" data-language="plain" class="ql-code-block">         for (SysMenu e : menus) {</div><div line="nzBW" data-language="plain" class="ql-code-block">            if (e.getParentId() == menu.getId()) {</div><div line="L7XV" data-language="plain" class="ql-code-block">               menu.getChildren().add(e);</div><div line="hO6V" data-language="plain" class="ql-code-block">            }</div><div line="RJEF" data-language="plain" class="ql-code-block">         }</div><div line="XBN3" data-language="plain" class="ql-code-block">         // 提取出父节点</div><div line="HOnv" data-language="plain" class="ql-code-block">         if (menu.getParentId() == 0L) {</div><div line="nlcI" data-language="plain" class="ql-code-block">            finalMenus.add(menu);</div><div line="ueAe" data-language="plain" class="ql-code-block">         }</div><div line="IVal" data-language="plain" class="ql-code-block">      }</div><div line="nSzw" data-language="plain" class="ql-code-block">      return finalMenus;</div><div line="CMtw" data-language="plain" class="ql-code-block">   }</div><div line="0nJT" data-language="plain" class="ql-code-block">   </div><div line="7c6N" data-language="plain" class="ql-code-block">   /**</div><div line="EGzI" data-language="plain" class="ql-code-block">    * menu转menuDto</div><div line="6IGe" data-language="plain" class="ql-code-block">    */</div><div line="Rdqv" data-language="plain" class="ql-code-block">   private List&lt;SysMenuDto&gt; convert(List&lt;SysMenu&gt; menus) {</div><div line="Bvok" data-language="plain" class="ql-code-block">      List&lt;SysMenuDto&gt; menuDtos = new ArrayList&lt;&gt;();</div><div line="sACC" data-language="plain" class="ql-code-block">      menus.forEach(m -&gt; {</div><div line="Ugj1" data-language="plain" class="ql-code-block">         SysMenuDto dto = new SysMenuDto();</div><div line="FhHu" data-language="plain" class="ql-code-block">         dto.setId(m.getId());</div><div line="wIA2" data-language="plain" class="ql-code-block">         dto.setName(m.getPerms());</div><div line="vBNd" data-language="plain" class="ql-code-block">         dto.setTitle(m.getName());</div><div line="kUJX" data-language="plain" class="ql-code-block">         dto.setComponent(m.getComponent());</div><div line="408o" data-language="plain" class="ql-code-block">         dto.setIcon(m.getIcon());</div><div line="FJPJ" data-language="plain" class="ql-code-block">         dto.setPath(m.getPath());</div><div line="z3Qb" data-language="plain" class="ql-code-block">         if (m.getChildren().size() &gt; 0) {</div><div line="cSVy" data-language="plain" class="ql-code-block">            dto.setChildren(convert(m.getChildren()));</div><div line="gxOh" data-language="plain" class="ql-code-block">         }</div><div line="SSsD" data-language="plain" class="ql-code-block">         menuDtos.add(dto);</div><div line="8X2e" data-language="plain" class="ql-code-block">      });</div><div line="GqoS" data-language="plain" class="ql-code-block">      return menuDtos;</div><div line="GNiu" data-language="plain" class="ql-code-block">   }</div><div line="GXz7" data-language="plain" class="ql-code-block">}</div></div><p line="anpI">接口中sysUserMapper.getNavMenuIds我们之前就已经写过的了，通过用户id获取菜单的id，然后后面就是转成树形结构，buildTreeMenu方法的思想很简单，我们现实把菜单循环，让所有菜单先找到各自的子节点，然后我们在把最顶级的菜单获取出来，这样顶级下面有二级，二级也有自己的三级。最后就是convert把menu转成menuDto。这个比较简单，就不说了。</p><p line="1O2W"><br></p><p line="uMcX">好了，导航菜单已经开发完毕，我们来写菜单管理的增删改查，因为菜单列表也是个树形接口，这次我们就不是获取当前用户的菜单列表的，而是所有菜单然后组成树形结构，一样的思想，数据不一样而已。</p><ul data-list-style="circle"><li line="mWKj" class="bullet-item">com.markerhub.controller.SysMenuController</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="NVsq" data-language="plain" class="ql-code-block">@GetMapping("/info/{id}")</div><div line="5t3A" data-language="plain" class="ql-code-block">@PreAuthorize("hasAuthority('sys:menu:list')")</div><div line="Chfc" data-language="plain" class="ql-code-block">public Result info(@PathVariable("id") Long id) {</div><div line="3Vgn" data-language="plain" class="ql-code-block">   return Result.succ(sysMenuService.getById(id));</div><div line="Xe5T" data-language="plain" class="ql-code-block">}</div><div line="HJcO" data-language="plain" class="ql-code-block"><br></div><div line="M3Gs" data-language="plain" class="ql-code-block">@GetMapping("/list")</div><div line="ghBC" data-language="plain" class="ql-code-block">@PreAuthorize("hasAuthority('sys:menu:list')")</div><div line="043f" data-language="plain" class="ql-code-block">public Result list() {</div><div line="2Dev" data-language="plain" class="ql-code-block">   List&lt;SysMenu&gt; menus = sysMenuService.tree();</div><div line="zby0" data-language="plain" class="ql-code-block">   return Result.succ(menus);</div><div line="V7Ul" data-language="plain" class="ql-code-block">}</div><div line="N4bK" data-language="plain" class="ql-code-block"><br></div><div line="KKiM" data-language="plain" class="ql-code-block">@PostMapping("/save")</div><div line="BLMs" data-language="plain" class="ql-code-block">@PreAuthorize("hasAuthority('sys:menu:save')")</div><div line="NXXg" data-language="plain" class="ql-code-block">public Result save(@Validated @RequestBody SysMenu sysMenu) {</div><div line="PUQ9" data-language="plain" class="ql-code-block">   sysMenu.setCreated(LocalDateTime.now());</div><div line="jbCY" data-language="plain" class="ql-code-block">   sysMenu.setStatu(Const.STATUS_ON);</div><div line="K2NI" data-language="plain" class="ql-code-block">   sysMenuService.save(sysMenu);</div><div line="yIjE" data-language="plain" class="ql-code-block">   return Result.succ(sysMenu);</div><div line="Kh8h" data-language="plain" class="ql-code-block">}</div><div line="CGQh" data-language="plain" class="ql-code-block"><br></div><div line="xX8K" data-language="plain" class="ql-code-block">@PostMapping("/update")</div><div line="UXyL" data-language="plain" class="ql-code-block">@PreAuthorize("hasAuthority('sys:menu:update')")</div><div line="KH60" data-language="plain" class="ql-code-block">public Result update(@Validated @RequestBody SysMenu sysMenu) {</div><div line="yl6Q" data-language="plain" class="ql-code-block">   sysMenu.setUpdated(LocalDateTime.now());</div><div line="UoJK" data-language="plain" class="ql-code-block">   sysMenuService.updateById(sysMenu);</div><div line="sPMS" data-language="plain" class="ql-code-block">   // 清除所有与该菜单相关的权限缓存</div><div line="CFUW" data-language="plain" class="ql-code-block">   sysUserService.clearUserAuthorityInfoByMenuId(sysMenu.getId());</div><div line="ZMCR" data-language="plain" class="ql-code-block">   return Result.succ(sysMenu);</div><div line="fvsV" data-language="plain" class="ql-code-block">}</div><div line="neFy" data-language="plain" class="ql-code-block"><br></div><div line="TO93" data-language="plain" class="ql-code-block">@Transactional</div><div line="iGIe" data-language="plain" class="ql-code-block">@PostMapping("/delete/{id}")</div><div line="qyC8" data-language="plain" class="ql-code-block">@PreAuthorize("hasAuthority('sys:menu:delete')")</div><div line="KL10" data-language="plain" class="ql-code-block">public Result delete(@PathVariable Long id) {</div><div line="gXK5" data-language="plain" class="ql-code-block"><br></div><div line="LUh8" data-language="plain" class="ql-code-block">   int count = sysMenuService.count(new QueryWrapper&lt;SysMenu&gt;().eq("parent_id", id));</div><div line="waq9" data-language="plain" class="ql-code-block">   if (count &gt; 0) {</div><div line="RFGR" data-language="plain" class="ql-code-block">      return Result.fail("请先删除子菜单");</div><div line="iMSo" data-language="plain" class="ql-code-block">   }</div><div line="xqRw" data-language="plain" class="ql-code-block">   </div><div line="ITMb" data-language="plain" class="ql-code-block">   // 先清除所有与该菜单相关的权限缓存</div><div line="TxeH" data-language="plain" class="ql-code-block">   sysUserService.clearUserAuthorityInfoByMenuId(id);</div><div line="ctdA" data-language="plain" class="ql-code-block">   sysMenuService.removeById(id);</div><div line="gyh0" data-language="plain" class="ql-code-block">   </div><div line="soM2" data-language="plain" class="ql-code-block">   // 同步删除</div><div line="XdFq" data-language="plain" class="ql-code-block">   sysRoleMenuService.remove(new QueryWrapper&lt;SysRoleMenu&gt;().eq("menu_id", id));</div><div line="Tjfw" data-language="plain" class="ql-code-block">   return Result.succ("");</div><div line="z0Yo" data-language="plain" class="ql-code-block">}</div></div><p line="9snv">删除、更新菜单的时候记得调用根据菜单id清楚用户权限缓存信息的方法哈。然后每个方法前都会带有权限注解：@PreAuthorize("hasAuthority('sys:menu:delete')")，这就要求用户有特定的操作权限才能调用这个接口，sys:menu:delete这些数据不是乱写出来的，我们必须和数据库的数据保持一致才行，然后component字段，也是要和前端进行沟通，因为这个是链接到的前端的组件页面。</p><p line="6nn3"><br></p><p line="a0eq">有了增删改查，我们就去先添加我们的所有的菜单权限数据先。效果如下：</p><p line="pxNV"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="1568" height="auto" ori-width="1568" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(20).png" style="" ori-height="954" data-src="https://uploader.shimo.im/f/vNKnSEE002RArMEv.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="PxY7"><br></p><p line="zT2G"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="1159" height="auto" ori-width="1159" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(21).png" style="" ori-height="874" data-src="https://uploader.shimo.im/f/bsuGADrHdTV5fEWM.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="pedD"><br></p><p line="l3Lw"><br></p><p line="AsEl">基本上线填好所有菜单的列表和增删改查操作权限，就ok。</p><p line="Abqw"><br></p><ol data-list-style="decimal"><li class="ordered-item ql-heading-3" line="qT41" data-list-number="10" data-list-content="10." data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>角色接口开发</li></ol><p line="ixHE">角色的增删改查其实也简单，而且字段这么少，基本上吧菜单的增删改查复制过来，然后把menu改成role，在调整一下就差不多啦。然后有个角色关联菜单的操作，这个我们等下讲讲，先来看代码：</p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="dm5z" data-language="plain" class="ql-code-block">@RestController</div><div line="SaLi" data-language="plain" class="ql-code-block">@RequestMapping("/sys/role")</div><div line="fX4q" data-language="plain" class="ql-code-block">public class SysRoleController extends BaseController {</div><div line="bWAH" data-language="plain" class="ql-code-block"><br></div><div line="EL6N" data-language="plain" class="ql-code-block">   @GetMapping("/info/{id}")</div><div line="cO3G" data-language="plain" class="ql-code-block">   @PreAuthorize("hasAuthority('sys:role:list')")</div><div line="KS06" data-language="plain" class="ql-code-block">   public Result info(@PathVariable Long id) {</div><div line="vA7M" data-language="plain" class="ql-code-block">      SysRole role = sysRoleService.getById(id);</div><div line="gjCf" data-language="plain" class="ql-code-block">      List&lt;SysRoleMenu&gt; roleMenus = sysRoleMenuService.list(new QueryWrapper&lt;SysRoleMenu&gt;().eq("role_id", id));</div><div line="GXiK" data-language="plain" class="ql-code-block">      List&lt;Long&gt; menuIds = roleMenus.stream().map(p -&gt; p.getMenuId()).collect(Collectors.toList());</div><div line="OlUT" data-language="plain" class="ql-code-block">      role.setMenuIds(menuIds);</div><div line="NYWp" data-language="plain" class="ql-code-block">      return Result.succ(role);</div><div line="RtN4" data-language="plain" class="ql-code-block">   }</div><div line="iTYj" data-language="plain" class="ql-code-block">   </div><div line="Lsos" data-language="plain" class="ql-code-block">   @GetMapping("/list")</div><div line="MfNw" data-language="plain" class="ql-code-block">   @PreAuthorize("hasAuthority('sys:role:list')")</div><div line="JUnG" data-language="plain" class="ql-code-block">   public Result list(String name) {</div><div line="mjgP" data-language="plain" class="ql-code-block">      Page&lt;SysRole&gt; roles = sysRoleService.page(getPage(),</div><div line="LdE4" data-language="plain" class="ql-code-block">            new QueryWrapper&lt;SysRole&gt;()</div><div line="RrK7" data-language="plain" class="ql-code-block">                  .like(StrUtil.isNotBlank(name), "name", name)</div><div line="fGRs" data-language="plain" class="ql-code-block">      );</div><div line="hrDW" data-language="plain" class="ql-code-block">      return Result.succ(roles);</div><div line="nlmf" data-language="plain" class="ql-code-block">   }</div><div line="keeL" data-language="plain" class="ql-code-block">   </div><div line="TGdf" data-language="plain" class="ql-code-block">   @PostMapping("/save")</div><div line="oyc9" data-language="plain" class="ql-code-block">   @PreAuthorize("hasAuthority('sys:role:save')")</div><div line="CKok" data-language="plain" class="ql-code-block">   public Result save(@Validated @RequestBody SysRole sysRole) {</div><div line="AhQc" data-language="plain" class="ql-code-block">      sysRole.setCreated(LocalDateTime.now());</div><div line="uxPb" data-language="plain" class="ql-code-block">      sysRole.setStatu(Const.STATUS_ON);</div><div line="s7Nt" data-language="plain" class="ql-code-block">      sysRoleService.save(sysRole);</div><div line="TU6o" data-language="plain" class="ql-code-block">      return Result.succ(sysRole);</div><div line="T1pw" data-language="plain" class="ql-code-block">   }</div><div line="yWkf" data-language="plain" class="ql-code-block">   </div><div line="PieK" data-language="plain" class="ql-code-block">   @PostMapping("/update")</div><div line="MneQ" data-language="plain" class="ql-code-block">   @PreAuthorize("hasAuthority('sys:role:update')")</div><div line="08s4" data-language="plain" class="ql-code-block">   public Result update(@Validated @RequestBody SysRole sysRole) {</div><div line="cVfW" data-language="plain" class="ql-code-block">      sysRole.setUpdated(LocalDateTime.now());</div><div line="FbMI" data-language="plain" class="ql-code-block">      sysRoleService.updateById(sysRole);</div><div line="jQLT" data-language="plain" class="ql-code-block">      return Result.succ(sysRole);</div><div line="5ODr" data-language="plain" class="ql-code-block">   }</div><div line="r9md" data-language="plain" class="ql-code-block">   </div><div line="8O5l" data-language="plain" class="ql-code-block">   @Transactional</div><div line="XzUS" data-language="plain" class="ql-code-block">   @PostMapping("/delete")</div><div line="fBzk" data-language="plain" class="ql-code-block">   @PreAuthorize("hasAuthority('sys:role:delete')")</div><div line="OUgF" data-language="plain" class="ql-code-block">   public Result delete(@RequestBody Long[] ids){</div><div line="hf88" data-language="plain" class="ql-code-block">      sysRoleService.removeByIds(Arrays.asList(ids));</div><div line="tX4l" data-language="plain" class="ql-code-block">      // 同步删除</div><div line="9PiE" data-language="plain" class="ql-code-block">      sysRoleMenuService.remove(new QueryWrapper&lt;SysRoleMenu&gt;().in("role_id", ids));</div><div line="HAz9" data-language="plain" class="ql-code-block">      sysUserRoleService.remove(new QueryWrapper&lt;SysUserRole&gt;().in("role_id", ids));</div><div line="fjNi" data-language="plain" class="ql-code-block">      return Result.succ("");</div><div line="YSGw" data-language="plain" class="ql-code-block">   }</div><div line="EpiR" data-language="plain" class="ql-code-block">   </div><div line="tPKe" data-language="plain" class="ql-code-block">   @Transactional</div><div line="ffq4" data-language="plain" class="ql-code-block">   @PostMapping("/perm/{roleId}")</div><div line="yQUz" data-language="plain" class="ql-code-block">   @PreAuthorize("hasAuthority('sys:role:perm')")</div><div line="6FTg" data-language="plain" class="ql-code-block">   public Result perm(@PathVariable Long roleId, @RequestBody Long[] menuIds) {</div><div line="NcQr" data-language="plain" class="ql-code-block">      List&lt;SysRoleMenu&gt; sysRoleMenus = new ArrayList&lt;&gt;();</div><div line="bKiw" data-language="plain" class="ql-code-block">      Arrays.stream(menuIds).forEach(menuId -&gt; {</div><div line="Pf5y" data-language="plain" class="ql-code-block">         SysRoleMenu roleMenu = new SysRoleMenu();</div><div line="nBHm" data-language="plain" class="ql-code-block">         roleMenu.setMenuId(menuId);</div><div line="4YSQ" data-language="plain" class="ql-code-block">         roleMenu.setRoleId(roleId);</div><div line="gBJP" data-language="plain" class="ql-code-block">         sysRoleMenus.add(roleMenu);</div><div line="j027" data-language="plain" class="ql-code-block">      });</div><div line="SRqo" data-language="plain" class="ql-code-block">      </div><div line="ZwvT" data-language="plain" class="ql-code-block">      sysRoleMenuService.remove(new QueryWrapper&lt;SysRoleMenu&gt;().eq("role_id", roleId));</div><div line="dFb3" data-language="plain" class="ql-code-block">      </div><div line="1hpv" data-language="plain" class="ql-code-block">      sysRoleMenuService.saveBatch(sysRoleMenus);</div><div line="ZeGL" data-language="plain" class="ql-code-block">      </div><div line="wnoU" data-language="plain" class="ql-code-block">      // 清除所有用户的权限缓存信息</div><div line="kI3U" data-language="plain" class="ql-code-block">      sysUserService.clearUserAuthorityInfoByRoleId(roleId);</div><div line="7ZQM" data-language="plain" class="ql-code-block">      return Result.succ(menuIds);</div><div line="UZ8g" data-language="plain" class="ql-code-block">   }</div><div line="0KSk" data-language="plain" class="ql-code-block">}</div></div><p line="zlDf">上面方法中：</p><ul data-list-style="circle"><li line="7LOu" class="bullet-item">info方法</li></ul><p line="qgdd">获取角色信息的方法，因为我们不仅仅在编辑角色时候会用到这个方法，在回显角色关联菜单的时候也需要被调用，因此我们需要把角色关联的所有的菜单的id也一并查询出来，也就是分配权限的操作。对应到前端就是这样的，点击分配权限，会弹出出所有的菜单列表，然后根据角色已经关联的菜单的id回显勾选上已经关联过的。效果如下：</p><p line="o2hm"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="1040" height="auto" ori-width="1040" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(22).png" style="" ori-height="750" data-src="https://uploader.shimo.im/f/kpR7rSy1ote74oLJ.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="qTzK"><br></p><p line="GiZ4">然后点击保存分配权限的时候，我们需要把角色的id和所有勾选上的菜单id的数组一起传过来，所以才有了controller中的这样的写法：</p><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="7FH7" data-language="plain" class="ql-code-block">@PreAuthorize("hasAuthority('sys:role:perm')")</div><div line="EOgU" data-language="plain" class="ql-code-block">public Result perm(@PathVariable Long roleId, @RequestBody Long[] menuIds) {</div><div line="zWNJ" data-language="plain" class="ql-code-block"><br></div><div line="ZNqP" data-language="plain" class="ql-code-block">    ...代码上面贴出来</div><div line="FZo2" data-language="plain" class="ql-code-block">}</div></div><p line="69ED">可以看到，因为@RequestBody，我们知道menuIds是否安装body里面的，这个需要注意，对应到的前端写法就是这样：</p><p line="QA8W"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="800" height="auto" ori-width="800" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(23).png" style="" ori-height="513" data-src="https://uploader.shimo.im/f/IADvhhZy7jBipz1w.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="enxu"><br></p><p line="PBIz">ok，角色管理就讲到这里了，其他增删改查自己看下代码，不难哈。</p><p line="m3ag"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="1172" height="auto" ori-width="1172" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(24).png" style="" ori-height="404" data-src="https://uploader.shimo.im/f/nVZAkhz963eRHu1B.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="DEOT"><br></p><p line="uhYD"><br></p><p line="kOPd"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="904" height="auto" ori-width="904" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(25).png" style="" ori-height="535" data-src="https://uploader.shimo.im/f/B2uQBH4q8kddcHg7.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="UDvb"><br></p><p line="3xQC"><br></p><p line="C8oX"><br></p><ol data-list-style="decimal"><li class="ordered-item ql-heading-3" line="OcuE" data-list-number="11" data-list-content="11." data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>用户接口开发</li></ol><p line="rnEE"><br></p><p line="ghQA">用户管理里面有个用户关联角色的分配角色操作，和角色关联菜单的写法差不多的，其他增删改查也复制黏贴改改就好，哈哈。</p><ul data-list-style="circle"><li line="dd6K" class="bullet-item">com.markerhub.controller.SysUserController</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="6hzy" data-language="plain" class="ql-code-block">/**</div><div line="Lqh6" data-language="plain" class="ql-code-block"> * 公众号：MarkerHub</div><div line="uiu0" data-language="plain" class="ql-code-block"> */</div><div line="7Sef" data-language="plain" class="ql-code-block">@RestController</div><div line="F4LD" data-language="plain" class="ql-code-block">@RequestMapping("/sys/user")</div><div line="Mnol" data-language="plain" class="ql-code-block">public class SysUserController extends BaseController {</div><div line="xtCh" data-language="plain" class="ql-code-block"><br></div><div line="rp3L" data-language="plain" class="ql-code-block">   @Autowired</div><div line="HmUd" data-language="plain" class="ql-code-block">   PasswordEncoder passwordEncoder;</div><div line="UiZy" data-language="plain" class="ql-code-block">   </div><div line="Mjgn" data-language="plain" class="ql-code-block">   @GetMapping("/info/{id}")</div><div line="E6yF" data-language="plain" class="ql-code-block">   @PreAuthorize("hasAuthority('sys:user:list')")</div><div line="0eDW" data-language="plain" class="ql-code-block">   public Result info(@PathVariable Long id) {</div><div line="RBFH" data-language="plain" class="ql-code-block">      SysUser user = sysUserService.getById(id);</div><div line="sfYS" data-language="plain" class="ql-code-block">      Assert.notNull(user, "找不到该管理员！");</div><div line="N9G6" data-language="plain" class="ql-code-block">      List&lt;SysRole&gt; roles = sysRoleService.listRolesByUserId(user.getId());</div><div line="8FUz" data-language="plain" class="ql-code-block">      user.setRoles(roles);</div><div line="GaqE" data-language="plain" class="ql-code-block">      return Result.succ(user);</div><div line="vSL8" data-language="plain" class="ql-code-block">   }</div><div line="6DkM" data-language="plain" class="ql-code-block">   </div><div line="Oyqb" data-language="plain" class="ql-code-block">   /**</div><div line="pdES" data-language="plain" class="ql-code-block">    * 用户自己修改密码</div><div line="vrbK" data-language="plain" class="ql-code-block">    *</div><div line="Gnm8" data-language="plain" class="ql-code-block">    */</div><div line="ucRz" data-language="plain" class="ql-code-block">   @PostMapping("/updataPass")</div><div line="JU42" data-language="plain" class="ql-code-block">   public Result updataPass(@Validated @RequestBody PassDto passDto, Principal principal) {</div><div line="qpoR" data-language="plain" class="ql-code-block">      SysUser sysUser = sysUserService.getByUsername(principal.getName());</div><div line="Poeh" data-language="plain" class="ql-code-block">      boolean matches = passwordEncoder.matches(passDto.getCurrentPass(), sysUser.getPassword());</div><div line="syN6" data-language="plain" class="ql-code-block">      if (!matches) {</div><div line="LFAK" data-language="plain" class="ql-code-block">         return Result.fail("旧密码不正确！");</div><div line="rSit" data-language="plain" class="ql-code-block">      }</div><div line="rpp4" data-language="plain" class="ql-code-block">      sysUser.setPassword(passwordEncoder.encode(passDto.getPassword()));</div><div line="YQNl" data-language="plain" class="ql-code-block">      sysUser.setUpdated(LocalDateTime.now());</div><div line="w6Mw" data-language="plain" class="ql-code-block">      sysUserService.updateById(sysUser);</div><div line="aPmc" data-language="plain" class="ql-code-block">      return Result.succ(null);</div><div line="8nVo" data-language="plain" class="ql-code-block">   }</div><div line="9bR1" data-language="plain" class="ql-code-block">   </div><div line="rtua" data-language="plain" class="ql-code-block">   /**</div><div line="stIA" data-language="plain" class="ql-code-block">    * 超级管理员重置密码</div><div line="Z3IR" data-language="plain" class="ql-code-block">    */</div><div line="Piyo" data-language="plain" class="ql-code-block">   @PostMapping("/repass")</div><div line="E0dC" data-language="plain" class="ql-code-block">   @PreAuthorize("hasAuthority('sys:user:repass')")</div><div line="PyNC" data-language="plain" class="ql-code-block">   public Result repass(@RequestBody Long userId) {</div><div line="BBut" data-language="plain" class="ql-code-block">      SysUser sysUser = sysUserService.getById(userId);</div><div line="6PBt" data-language="plain" class="ql-code-block">      sysUser.setPassword(passwordEncoder.encode(Const.DEFAULT_PASSWORD));</div><div line="PsOC" data-language="plain" class="ql-code-block">      sysUser.setUpdated(LocalDateTime.now());</div><div line="7HHB" data-language="plain" class="ql-code-block">      sysUserService.updateById(sysUser);</div><div line="oMp5" data-language="plain" class="ql-code-block">      return Result.succ(null);</div><div line="I0Rr" data-language="plain" class="ql-code-block">   }</div><div line="mYTi" data-language="plain" class="ql-code-block">   </div><div line="kYjx" data-language="plain" class="ql-code-block">   @GetMapping("/list")</div><div line="Oq6W" data-language="plain" class="ql-code-block">   @PreAuthorize("hasAuthority('sys:user:list')")</div><div line="99zt" data-language="plain" class="ql-code-block">   public Result page(String username) {</div><div line="egDM" data-language="plain" class="ql-code-block">      Page&lt;SysUser&gt; users = sysUserService.page(getPage(),</div><div line="e60G" data-language="plain" class="ql-code-block">            new QueryWrapper&lt;SysUser&gt;()</div><div line="Vt3o" data-language="plain" class="ql-code-block">                  .like(StrUtil.isNotBlank(username), "username", username)</div><div line="42Kp" data-language="plain" class="ql-code-block">      );</div><div line="c6Nh" data-language="plain" class="ql-code-block">      users.getRecords().forEach(u -&gt; {</div><div line="B6XT" data-language="plain" class="ql-code-block">         u.setRoles(sysRoleService.listRolesByUserId(u.getId()));</div><div line="QYZ7" data-language="plain" class="ql-code-block">      });</div><div line="A6RQ" data-language="plain" class="ql-code-block">      return Result.succ(users);</div><div line="ThYj" data-language="plain" class="ql-code-block">   }</div><div line="0P04" data-language="plain" class="ql-code-block">   </div><div line="OWYR" data-language="plain" class="ql-code-block">   @PostMapping("/save")</div><div line="s0zG" data-language="plain" class="ql-code-block">   @PreAuthorize("hasAuthority('sys:user:save')")</div><div line="51Jn" data-language="plain" class="ql-code-block">   public Result save(@Validated @RequestBody SysUser sysUser) {</div><div line="vtqt" data-language="plain" class="ql-code-block">      sysUser.setCreated(LocalDateTime.now());</div><div line="bBVI" data-language="plain" class="ql-code-block">      sysUser.setStatu(Const.STATUS_ON);</div><div line="2BLe" data-language="plain" class="ql-code-block">      // 初始默认密码</div><div line="gA1O" data-language="plain" class="ql-code-block">      sysUser.setPassword(Const.DEFAULT_PASSWORD);</div><div line="x8zK" data-language="plain" class="ql-code-block">      if (StrUtil.isBlank(sysUser.getPassword())) {</div><div line="3eED" data-language="plain" class="ql-code-block">         return Result.fail("密码不能为空");</div><div line="jZUh" data-language="plain" class="ql-code-block">      }</div><div line="amzf" data-language="plain" class="ql-code-block">      String password = passwordEncoder.encode(sysUser.getPassword());</div><div line="pO8s" data-language="plain" class="ql-code-block">      sysUser.setPassword(password);</div><div line="ExOU" data-language="plain" class="ql-code-block">      // 默认头像</div><div line="0UNM" data-language="plain" class="ql-code-block">      sysUser.setAvatar(Const.DEFAULT_AVATAR);</div><div line="V94H" data-language="plain" class="ql-code-block">      sysUserService.save(sysUser);</div><div line="CZIK" data-language="plain" class="ql-code-block">      return Result.succ(sysUser);</div><div line="WR75" data-language="plain" class="ql-code-block">   }</div><div line="VbP2" data-language="plain" class="ql-code-block">   </div><div line="9c7C" data-language="plain" class="ql-code-block">   @PostMapping("/update")</div><div line="7TU8" data-language="plain" class="ql-code-block">   @PreAuthorize("hasAuthority('sys:user:update')")</div><div line="usUf" data-language="plain" class="ql-code-block">   public Result update(@Validated @RequestBody SysUser sysUser) {</div><div line="AcJo" data-language="plain" class="ql-code-block">      sysUser.setUpdated(LocalDateTime.now());</div><div line="wg9W" data-language="plain" class="ql-code-block">      if (StrUtil.isNotBlank(sysUser.getPassword())) {</div><div line="FGsu" data-language="plain" class="ql-code-block">         String password = passwordEncoder.encode(sysUser.getPassword());</div><div line="iOAd" data-language="plain" class="ql-code-block">         sysUser.setPassword(password);</div><div line="7oPB" data-language="plain" class="ql-code-block">      }</div><div line="r5jx" data-language="plain" class="ql-code-block">      sysUserService.updateById(sysUser);</div><div line="yEN4" data-language="plain" class="ql-code-block">      return Result.succ(sysUser);</div><div line="g0km" data-language="plain" class="ql-code-block">   }</div><div line="j38b" data-language="plain" class="ql-code-block">   </div><div line="84Xg" data-language="plain" class="ql-code-block">   @PostMapping("/delete")</div><div line="5iFP" data-language="plain" class="ql-code-block">   @PreAuthorize("hasAuthority('sys:user:delete')")</div><div line="dYFj" data-language="plain" class="ql-code-block">   public Result delete(@RequestBody Long[] ids){</div><div line="5f8r" data-language="plain" class="ql-code-block">      sysUserService.removeByIds(Arrays.asList(ids));</div><div line="FAjq" data-language="plain" class="ql-code-block">      sysUserRoleService.remove(new QueryWrapper&lt;SysUserRole&gt;().in("user_id", ids));</div><div line="OSoH" data-language="plain" class="ql-code-block">      return Result.succ("");</div><div line="NBLd" data-language="plain" class="ql-code-block">   }</div><div line="aVyc" data-language="plain" class="ql-code-block">   </div><div line="2ekR" data-language="plain" class="ql-code-block">   /**</div><div line="wxmG" data-language="plain" class="ql-code-block">    * 分配角色</div><div line="i6br" data-language="plain" class="ql-code-block">    * @return</div><div line="Nw0x" data-language="plain" class="ql-code-block">    */</div><div line="idk8" data-language="plain" class="ql-code-block">   @Transactional</div><div line="FUMB" data-language="plain" class="ql-code-block">   @PostMapping("/role/{userId}")</div><div line="oUpx" data-language="plain" class="ql-code-block">   @PreAuthorize("hasAuthority('sys:user:role')")</div><div line="Tyrp" data-language="plain" class="ql-code-block">   public Result perm(@PathVariable Long userId, @RequestBody Long[] roleIds) {</div><div line="G8np" data-language="plain" class="ql-code-block">      System.out.println(roleIds);</div><div line="Gr6a" data-language="plain" class="ql-code-block">      List&lt;SysUserRole&gt; userRoles = new ArrayList&lt;&gt;();</div><div line="EOBw" data-language="plain" class="ql-code-block">      Arrays.stream(roleIds).forEach(roleId -&gt; {</div><div line="Gf54" data-language="plain" class="ql-code-block">         SysUserRole userRole = new SysUserRole();</div><div line="Mp5b" data-language="plain" class="ql-code-block">         userRole.setRoleId(roleId);</div><div line="1ofE" data-language="plain" class="ql-code-block">         userRole.setUserId(userId);</div><div line="Iz6F" data-language="plain" class="ql-code-block">         userRoles.add(userRole);</div><div line="OGqN" data-language="plain" class="ql-code-block">      });</div><div line="nYKv" data-language="plain" class="ql-code-block">      sysUserRoleService.remove(new QueryWrapper&lt;SysUserRole&gt;().eq("user_id", userId));</div><div line="cnnv" data-language="plain" class="ql-code-block">      sysUserRoleService.saveBatch(userRoles);</div><div line="nWEA" data-language="plain" class="ql-code-block">      // 清除权限信息</div><div line="UkX5" data-language="plain" class="ql-code-block">      SysUser sysUser = sysUserService.getById(userId);</div><div line="xlVf" data-language="plain" class="ql-code-block">      sysUserService.clearUserAuthorityInfo(sysUser.getUsername());</div><div line="ixKv" data-language="plain" class="ql-code-block">      return Result.succ(roleIds);</div><div line="Kzay" data-language="plain" class="ql-code-block">   }</div><div line="6tgv" data-language="plain" class="ql-code-block">}</div></div><p line="ijgN">上面用到一个sysRoleService.listRolesByUserId，通过用户id获取所有关联的角色，用到了中间表，可以写sql，这里我这样写的：</p><ul data-list-style="circle"><li line="1qkr" class="bullet-item">com.markerhub.service.impl.SysRoleServiceImpl#listRolesByUserId</li></ul><div class="ql-code-block-container" data-language="plain" spellcheck="false"><span class="sm-docs-syntax-language">Plain  Text</span><div line="aw4x" data-language="plain" class="ql-code-block">@Override</div><div line="k52o" data-language="plain" class="ql-code-block">public List&lt;SysRole&gt; listRolesByUserId(Long userId) {</div><div line="ZjiP" data-language="plain" class="ql-code-block">   return this.list(</div><div line="41rq" data-language="plain" class="ql-code-block">         new QueryWrapper&lt;SysRole&gt;()</div><div line="NFIW" data-language="plain" class="ql-code-block">               .inSql("id", "select role_id from sys_user_role where user_id = " + userId));</div><div line="Z06r" data-language="plain" class="ql-code-block">}</div></div><p line="NwFV">userId一定要是自己数据库查出来的，千万别让前端传过来啥就直接调用这个方法，不然会可能会被攻击，嘿嘿嘿~最委托就是写完整的sql，而不是这样半个sql的写法。</p><p line="ZEXt"><br></p><p line="Zhcn">最后效果如下：</p><p line="uYo8"><br></p><p line="UIWL"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="1416" height="auto" ori-width="1416" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(26).png" style="" ori-height="349" data-src="https://uploader.shimo.im/f/sg2nzjei1441YY50.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="i9pg"><br></p><p line="sPl7"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="862" height="auto" ori-width="862" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(27).png" style="" ori-height="338" data-src="https://uploader.shimo.im/f/asz0Yyv9ppmkf4Zh.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="BFYs"><br></p><p line="UBIY"><span class="ql-blot-gallery-embed ql-blot-gallery ql-gallery-margin-none ql-gallery-frame-none"><span class="ql-gallery-editableimage"><span class="img-wrapper cropped"><img class="gallery-image" width="1079" height="auto" ori-width="1079" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/image(28).png" style="" ori-height="319" data-src="https://uploader.shimo.im/f/W6JZHEQFX1caJ1TW.png!thumbnail" crossorigin="anonymous"></span></span></span></p><p line="o1er"><br></p><p line="KPbJ"><br></p><ol data-list-style="decimal"><li class="ordered-item ql-heading-3" line="6pGm" data-list-number="12" data-list-content="12." data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>项目部署</li></ol><p line="uAdm"><br></p><p line="37Se">部署项目其实和vueblog的部署是一样的，自己调整一下吧少年，我有写了视频和文档的：</p><p line="xt0m"><a class="ql-link" href="https://www.bilibili.com/video/BV17A411E7aE/?accessToken=eyJhbGciOiJIUzI1NiIsImtpZCI6ImRlZmF1bHQiLCJ0eXAiOiJKV1QifQ.eyJleHAiOjE2NjUxNTkwMDcsImZpbGVHVUlEIjoiT25aRHdveEZGTDhiblAxYyIsImlhdCI6MTY2NTE1ODcwNywiaXNzIjoidXBsb2FkZXJfYWNjZXNzX3Jlc291cmNlIiwidXNlcklkIjotNzIyOTE4Nzc3MX0.AhLZ3583HEK7kJAwvXusonzSRo0h-zE4btlUTrVMoBw" target="_blank" rel="noopener noreferrer nofollow">https://www.bilibili.com/video/BV17A411E7aE/</a></p><p line="tpNi"><br></p><ol data-list-style="decimal"><li class="ordered-item ql-heading-3" line="iIJZ" data-list-number="13" data-list-content="13." data-foldable=""><span class="ql-folder"><button type="button" class="ql-folder-trigger"></button></span>项目总结</li></ol><p line="FGF4"><br></p><p line="Igq2">好了，我们终于又写完了一个项目，希望能让你们学到点东西，这次写的文档有点乱，多多担待，太长了，写着写着就不知道写哪了，哈哈。</p><p line="GuLl"><br></p><p line="ppAu">原创作者：吕一明</p><p line="fOjC">首发公众号：MakerHub</p><p line="J0SJ">首发B站：MarkerHub</p><p line="rw2B">转载请保留此声明，感谢！</p><p line="init"><br></p><p line="BeaZ"><br></p></div><script>
function setTransform(el, scale) {
  var prefix = ["ms", "webkit", ""];

  prefix.forEach(function (str) {
    var name = str ? str + "Transform" : "transform";
    el.style[name] = "scale(" + scale + ")";
    el.style[name + "Origin"] = "left center";
  });
}
document.querySelectorAll(".auto-scale").forEach(function (el) {
  var scale = Math.min(el.clientWidth / el.scrollWidth, 1);

  if (scale < 1) {
    setTransform(el, scale);
    el.style.overflow = 'visible';
    el.style.textOverflow = 'inherit';
  }
});
</script><script>
function fixVerticalAlign(el) {
  if (el && el.classList && el.classList.contains('ql-formula-embed')) {
    var contentNode = el.querySelector('.ql-formula-content')
    el.style.marginBottom = '-3px'
    el.style.verticalAlign = 'text-bottom'
    if (contentNode) {
      contentNode.style.verticalAlign = 'bottom'
    }
  }
}
document.querySelectorAll('.ql-blot-gallery-embed').forEach(function (el) {
  while (el && el.tagName !== 'P') {
    fixVerticalAlign(el.nextSibling)
    fixVerticalAlign(el.previousSibling)
    el = el.parentNode
  }
})

// 修复 dataset
document.querySelectorAll('.ql-formula-embed').forEach(function (el) {
  var input = el.querySelector('input');
  el.dataset.value = decodeURIComponent(input && input.value || '');
})
</script>
                <ul class="ql-gallery-contextmenu"><li class="ql-gallery-menu-item">复制图片</li><li class="ql-gallery-menu-item">下载图片</li></ul><div class="ql-link-toolbar ql-popup">
      <span class="ql-link-toolbar-button" data-name="open-link"></span>
      <span class="ql-link-toolbar-button" data-name="preview"></span>
      <span class="ql-link-toolbar-button" data-name="download"></span>
    </div><div class="toolbar-tip hidden"><div class="toolbar-format-tip"></div></div><div class="ql-table-of-content" style="top: 51px; height: calc(100% - 51px); width: 315px; margin-left: -315px;"><div id="new-directory" class="table-of-content"><div class="doc-directory-menu"><div class="doc-directory-menu-line"></div><div class="doc-directory-menu-line"></div><div class="doc-directory-menu-line"></div></div><div class="new-doc-directory"><div class="doc-directory-title"><span>目录</span><span class="doc-directory-close"><!--?xml version="1.0" encoding="utf-8"?--> <svg data-name="Layer 1" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 15.6 15.6"> <path d="M9.2 7.8l6.4-6.4L14.2 0 7.8 6.4 1.4 0 0 1.4l6.4 6.4L0 14.2l1.4 1.4 6.4-6.4 6.4 6.4 1.4-1.4z" fill="#a5a5a5"> </path> </svg> </span></div><div class="doc-directory-content ps ps--active-y"><ul class="doc-directory-list has-heading-1 has-heading-0 has-only-title"><li class="toc-entry heading-1 header-indent-undefined" data-index="0" data-offset="311"><div class="dic-text">1.前言</div></li><li class="toc-entry heading-1 header-indent-undefined" data-index="1" data-offset="1090"><div class="dic-text">2.新建springboot项目，注意版本</div></li><li class="toc-entry heading-1 header-indent-undefined hasChildren" data-index="2" data-offset="3018"><span class="icon-collapsed"><!--?xml version="1.0" encoding="utf-8"?--> <svg version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 10 10" style="enable-background:new 0 0 10 10" xml:space="preserve"> <g id="Artboard"> <polygon id="Triangle-3-Copy-13" style="fill:#a5a5a5" points="8,5.5 3,9 3,2 	"></polygon> </g> </svg> </span><div class="dic-text">3.整合mybatis plus，生成代码</div></li><li class="toc-entry heading-0 header-indent-undefined" data-index="3" data-offset="3154"><div class="dic-text">第一步：导入jar包</div></li><li class="toc-entry heading-0 header-indent-undefined" data-index="4" data-offset="3828"><div class="dic-text">第二步：然后去写配置文件</div></li><li class="toc-entry heading-0 header-indent-undefined" data-index="5" data-offset="4262"><div class="dic-text">第三步：开启mapper接口扫描，添加分页、防全表更新插件</div></li><li class="toc-entry heading-0 header-indent-undefined" data-index="6" data-offset="5014"><div class="dic-text">第四步：创建数据库和表</div></li><li class="toc-entry heading-0 header-indent-undefined" data-index="7" data-offset="7614"><div class="dic-text">第五步：代码生成</div></li><li class="toc-entry heading-1 header-indent-undefined" data-index="8" data-offset="11608"><div class="dic-text">4.结果封装</div></li><li class="toc-entry heading-1 header-indent-undefined" data-index="9" data-offset="12758"><div class="dic-text">5.全局异常处理</div></li><li class="toc-entry heading-1 header-indent-undefined hasChildren" data-index="10" data-offset="14177"><span class="icon-collapsed"><!--?xml version="1.0" encoding="utf-8"?--> <svg version="1.1" id="图层_1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 10 10" style="enable-background:new 0 0 10 10" xml:space="preserve"> <g id="Artboard"> <polygon id="Triangle-3-Copy-13" style="fill:#a5a5a5" points="8,5.5 3,9 3,2 	"></polygon> </g> </svg> </span><div class="dic-text">6.整合Spring Security</div></li><li class="toc-entry heading-0 header-indent-undefined" data-index="11" data-offset="17385"><div class="dic-text">引入Security与jwt</div></li><li class="toc-entry heading-0 header-indent-undefined" data-index="12" data-offset="18646"><div class="dic-text">用户认证</div></li><li class="toc-entry heading-0 header-indent-undefined" data-index="13" data-offset="19163"><div class="dic-text">生成验证码</div></li><li class="toc-entry heading-0 header-indent-undefined" data-index="14" data-offset="20861"><div class="dic-text">验证码认证过滤器</div></li><li class="toc-entry heading-0 header-indent-undefined" data-index="15" data-offset="26951"><div class="dic-text">身份认证 - 1</div></li><li class="toc-entry heading-0 header-indent-undefined" data-index="16" data-offset="29483"><div class="dic-text">身份认证 - 2</div></li><li class="toc-entry heading-0 header-indent-undefined" data-index="17" data-offset="34743"><div class="dic-text">解决授权</div></li><li class="toc-entry heading-0 header-indent-undefined" data-index="18" data-offset="37682"><div class="dic-text">权限缓存</div></li><li class="toc-entry heading-0 header-indent-undefined" data-index="19" data-offset="38894"><div class="dic-text">退出数据返回</div></li><li class="toc-entry heading-0 header-indent-undefined" data-index="20" data-offset="39546"><div class="dic-text">无权限数据返回</div></li><li class="toc-entry heading-1 header-indent-undefined" data-index="21" data-offset="40136"><div class="dic-text">7.解决跨域问题</div></li><li class="toc-entry heading-1 header-indent-undefined" data-index="22" data-offset="40963"><div class="dic-text">8.前后端对接的问题</div></li><li class="toc-entry heading-1 header-indent-undefined" data-index="23" data-offset="41215"><div class="dic-text">9.菜单接口开发</div></li><li class="toc-entry heading-1 header-indent-undefined" data-index="24" data-offset="47434"><div class="dic-text">10.角色接口开发</div></li><li class="toc-entry heading-1 header-indent-undefined" data-index="25" data-offset="51330"><div class="dic-text">11.用户接口开发</div></li><li class="toc-entry heading-1 header-indent-undefined" data-index="26" data-offset="55536"><div class="dic-text">12.项目部署</div></li><li class="toc-entry heading-1 header-indent-undefined" data-index="27" data-offset="55664"><div class="dic-text">13.项目总结</div></li></ul><div class="ps__rail-x" style="left: 0px; bottom: 0px;"><div class="ps__thumb-x" tabindex="0" style="left: 0px; width: 0px;"></div></div><div class="ps__rail-y" style="top: 0px; right: 0px; height: 575px;"><div class="ps__thumb-y" tabindex="0" style="top: 0px; height: 381px;"></div></div></div></div></div></div></div>
                <div id="file-page-footer"><div class="sc-chPdSV gLVbAR"><span class="sc-kgoBCf kqIoIJ">三万四千七百七十九<!-- --> &nbsp;阅<a class="sc-kGXeez liDUmU" href="https://shimo.im/docs/OnZDwoxFFL8bnP1c/read#">举报</a></span></div><div class="sm-ad-wrapper pos-pc-readonly-doc-bottom" style="max-width: 816px; margin: 15px auto; display: block;" data-sm-ad="1">
        <div class="sm-ad-container pos-pc-readonly-doc-bottom" style="padding-top: 21.4461%;">
          <a href="javascript:" class="sm-ad-item pos-pc-readonly-doc-bottom ad-2022061500011">
            <img class="sm-ad-img" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/SSENxVINqb7SF7yx.jpg">
            
          </a>
          <div class="sm-ad-mask">
            <button class="sm-ad-ever-close">永久去广告</button>
            <button class="sm-ad-temporal-close">暂时关闭</button>
          </div>
        </div>
      </div><div class="sm-ad-wrapper pos-pc-readonly-doc-bottom-2" data-sm-ad="1" style="max-width: 816px; margin: 15px auto; display: block;">
        <div class="sm-ad-container pos-pc-readonly-doc-bottom-2" style="padding-top: 21.4461%;">
          <a href="javascript:" class="sm-ad-item pos-pc-readonly-doc-bottom-2 ad-2022061500012">
            <img class="sm-ad-img" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/hRbx0yHFscnAXYUA.png">
            
          </a>
          <div class="sm-ad-mask">
            <button class="sm-ad-ever-close">永久去广告</button>
            <button class="sm-ad-temporal-close">暂时关闭</button>
          </div>
        </div>
      </div></div>
            <div class="ql-demo-screen-back-to-top"></div></div>
        </div>
        <script>
          window.__SHIMO__ = {
            file: {"permissions":{"readable":true,"editable":false,"commentable":false,"manageable":false,"exitable":false,"exportable":true,"collaboratorManageable":false,"adminManageable":false,"outsiderAddable":false,"childFileCreatable":false,"shareModeManageable":false,"teamShareModeManageable":false,"copyable":true,"lockable":false,"unlockable":false,"removable":false,"downloadable":false,"canDuplicate":true,"canUncompress":false,"canPrint":true,"canSaveAsTemplate":true,"canApplyPermission":true,"canRename":false,"canModifyAdvancedPermission":false,"canCustomizeAdvancedPermission":false,"moveable":false,"sheetLockable":false,"passwordShareable":false,"fileAuthSetable":false},"url":"/docs/OnZDwoxFFL8bnP1c","isDelete":0,"namePinyin":"kfsodqhdflhtglxtv-hdbj|'kai'fa'springbo'ot+jwt+vue'de'qian'hou'duan'fen'li'hou'tai'guan'li'xi'tong'vueadmin'-'hou'duan'bi'ji","parentId":258007263,"passwordProtected":false,"shareCount":0,"shareMode":"readonly","teamId":null,"userId":2747389,"deletedBy":null,"updatedAt":"2021-04-29T18:03:23.000Z","updatedBy":2747389,"createdAt":"2021-04-23T13:04:37.000Z","id":384480222,"guid":"OnZDwoxFFL8bnP1c","name":"开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记","name_pinyin":"kfsodqhdflhtglxtv-hdbj|'kai'fa'springbo'ot+jwt+vue'de'qian'hou'duan'fen'li'hou'tai'guan'li'xi'tong'vueadmin'-'hou'duan'bi'ji","password_protected":false,"share_mode":"readonly","type":"newdoc","is_delete":0,"user_id":2747389,"deleted_by":null,"updated_by":2747389,"team_id":null,"parent_id":258007263,"created_at":"2021-04-23T13:04:37.000Z","updated_at":"2021-04-29T18:03:23.000Z","isFromSVC":false,"is_folder":0,"isFolder":false,"collaboratorCount":0,"departmentCollaboratorCount":0,"isSpace":false,"isLocked":false,"parentRole":"inherited","isShortcut":false,"isLegacy":true,"hasChildren":false,"isFileAdmin":false,"isCloudFile":false,"fileSize":0,"user":{"id":2747389,"name":"吕一明","avatar":"https://oavatar.shimonote.com/pN6zY16IzbYKtCLC/image.jpg!avatar","email":"","accountMetadata":{"isExpired":false,"isDingtalk":false,"isWework":false,"isEnterprise":false,"isFreeEnterprise":false,"expiredAt":{"seconds":1980777905,"nanos":409844039},"isTrial":false,"isPersonalPremium":false,"isEnterprisePremium":false,"isEnterpriseLight":false}},"updatedUser":{"id":2747389,"name":"吕一明","avatar":"https://oavatar.shimonote.com/pN6zY16IzbYKtCLC/image.jpg!avatar","email":""},"lockedUser":{},"Permissions":[{"id":null,"owner":false}],"permissionsAndReasons":{"canAddOutsider":{"value":false,"reason":"NOT_A_TEAM_FILE"},"canChangeShareMode":{"value":false,"reason":"UNKNOWN"},"canChangeTeamShareMode":{"value":false,"reason":"NOT_A_EDITOR"},"canComment":{"value":false,"reason":"UNKNOWN"},"canCopy":{"value":true,"reason":"UNKNOWN"},"canCreateChildFile":{"value":false,"reason":"UNKNOWN"},"canDownload":{"value":false,"reason":"NOT_A_DRIVE_FILE"},"canEdit":{"value":false,"reason":"UNKNOWN"},"canExit":{"value":false,"reason":"NOT_A_PERSONAL_COLLABORATOR"},"canExport":{"value":true,"reason":"UNKNOWN"},"canLock":{"value":false,"reason":"NO_BASIC_PERMISSION"},"canManage":{"value":false,"reason":"NO_BASIC_PERMISSION"},"canManageAdmin":{"value":false,"reason":"UNKNOWN"},"canManageCollaborator":{"value":false,"reason":"UNKNOWN"},"canRead":{"value":true,"reason":"UNKNOWN"},"canRemove":{"value":false,"reason":"CANT_MANAGE_FILE"},"canUnlock":{"value":false,"reason":"NO_BASIC_PERMISSION"},"canUseMoveFeature":{"value":false,"reason":"CURRENT_ACCOUNT_VERSION_NOT_SUPPORT"},"canUsePasswordShareFileFeature":{"value":false,"reason":"CURRENT_ACCOUNT_VERSION_NOT_SUPPORT"},"canUseSheetLockFeature":{"value":false,"reason":"CURRENT_ACCOUNT_VERSION_NOT_SUPPORT"},"canDuplicate":{"value":true,"reason":"UNKNOWN"},"canUncompress":{"value":false,"reason":"NOT_A_COMPRESSED_FILE"},"canPrint":{"value":true,"reason":"UNKNOWN"},"canSaveAsTemplate":{"value":true,"reason":"UNKNOWN"},"canApplyPermission":{"value":true,"reason":"UNKNOWN"},"canRename":{"value":false,"reason":"UNKNOWN"},"canModifyAdvancedPermission":{"value":false,"reason":"NO_BASIC_PERMISSION"},"canCustomizeAdvancedPermission":{"value":false,"reason":"NO_BASIC_PERMISSION"}},"sortName":["kāi","fā","SpringBoot+Jwt+Vue","de","qián","hòu","duān","fēn","lí","hòu","tái","guǎn","lǐ","xì","tǒng","VueAdmin - ","hòu","duān","bǐ","jì"],"starred":false,"tags":[],"marked":false,"share_count":0,"isImportPending":false,"views":34779},
            user: {},
            watermarkStatus: false
          }
        </script>
        <script>window.__INITIAL_STATE__={"users":{"mirror":{},"diff":{},"data":{},"persist":[]},"files":{"mirror":{},"diff":{},"data":{"OnZDwoxFFL8bnP1c":{"id":384480222,"guid":"OnZDwoxFFL8bnP1c","name":"开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记","type":"newdoc","fileSize":0,"user":{"id":2747389,"name":"吕一明","avatar":"https://oavatar.shimonote.com/pN6zY16IzbYKtCLC/image.jpg!avatar","email":"","accountMetadata":{"isWework":false,"isEnterprise":false,"isEnterpriseLight":false,"isTrial":false,"isEnterprisePremium":false,"isPersonalPremium":false,"isDingtalk":false,"isFreeEnterprise":false,"expiredAt":{"seconds":1980777905,"nanos":409844039},"isExpired":false}},"updatedUser":{"id":2747389,"name":"吕一明","avatar":"https://oavatar.shimonote.com/pN6zY16IzbYKtCLC/image.jpg!avatar","email":""},"teamId":null,"parentId":258007263,"shareMode":"readonly","createdAt":"2021-04-23T13:04:37.000Z","updatedAt":"2021-04-29T18:03:23.000Z","passwordProtected":false,"sortName":["kāi","fā","SpringBoot+Jwt+Vue","de","qián","hòu","duān","fēn","lí","hòu","tái","guǎn","lǐ","xì","tǒng","VueAdmin - ","hòu","duān","bǐ","jì"],"isSpace":false,"isFromSVC":false,"isNew":false,"starred":false,"watched":false,"mute":false,"requirePassword":false,"collaboratorCount":0,"views":34779,"marked":false,"hasDesktopShortcut":false,"permissions":{"readable":true,"editable":false,"commentable":false,"manageable":false,"exitable":false,"collaboratorManageable":false,"outsiderAddable":false,"childFileCreatable":false,"shareModeManageable":false,"moveable":false},"contentUrl":"","creator":{}}},"persist":["OnZDwoxFFL8bnP1c"]},"tree":{"mirror":{},"data":{}},"me":{"id":0,"stale":false},"recent":null,"starred":null,"deleted":null,"status":{"online":true,"physicalOnline":true,"pendingRequests":0,"dataLoaded":true,"pushClientId":"ceaee1f8-4912-4236-8d7f-4cb27365f678"},"notifications":{"all":null,"unread":null,"allHasMore":true,"unreadHasMore":true,"unpeekedCount":0,"unreadCount":0},"collaborators":{"mirror":{},"data":{}},"teams":{"mirror":{},"diff":{},"data":{},"persist":[]},"teamMembers":null,"recentContacts":null,"updated":{"list":[]},"shared":{"list":[]},"unreadShared":null,"created":{"list":[]},"used":{"list":[]},"shortcuts":[],"userGuide":{},"wechat":{},"maintenance":{},"flashMessages":{},"alphaFeatures":{},"subscriptions":{"app_push_comment":true,"app_push_invitation":true,"app_push_team":true,"app_push_mention":true,"not_send_apn_when_web_online":true,"comment":true,"app_push_system":true,"desktop":true},"syncedFiles":{},"discussions":{},"templates":{},"settings":{},"blueTips":{},"bulletin":{},"spaces":{"size":null},"page":{"guid":"OnZDwoxFFL8bnP1c"},"ui":{"templateModal":{"visible":false}}}</script>
<script async="" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/component-f6c3bf260a.js"></script>
<script async="" src="./开发SpringBoot+Jwt+Vue的前后端分离后台管理系统VueAdmin - 后端笔记_files/doc-406eba5b50.js"></script>
    

<div><div id="ToastsContainer_ShimoUI"><div class="Toastify"></div></div></div><div class="ql-bookmarker-container"><button type="button" class="ql-bookmarker"></button></div><div style="position: absolute; top: 0px; left: 0px; width: 100%;"><div><div class="sm-tooltip  randomClass-mvIob  sm-tooltip-theme-blue sm-tooltip-placement-bottom  sm-tooltip-hidden" style="left: 1216.9px; top: 39px;"><div class="sm-tooltip-content"><div class="sm-tooltip-arrow"></div><div class="sm-tooltip-inner"><div>登录开启更多功能</div></div></div></div></div></div></body></html>